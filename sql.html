<!DOCTYPE html>
<html>
<head>
    <title>Moja Strona</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Comfortaa">
    <link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>


    <header>
    
        <nav class="menu">

            <ul>
                <li><a href="index.html">Start</a></li>
                <li><a href="projekty.html">Projekty</a></li>
                <li><a href="blog.html">Blog</a></li>
                <li><a href="kontakt.html">Kontakt</a></li>
            </ul>
        </nav>
        
    </header>


    <div class="container">
        <section>
            <article class="art1">
                <header>
                    <h1>Projekt nr 1. </h1>
                </header>
                <h3>Baza danych SQL</h3>
                    <p> Autorski projekt bazy danych wraz z kodem SQL tworzącym bazy danych,
                        wstawiającym fikcyjne dane testowe oraz skrypty analityczne pozwalające na przeprowadzanie pogłębionych analiz
                        informacji zawartych w bazie danych. Projekt zawiera opisy projektów oraz skrypty.</p>
                    <p>
                        Celem projektu jest stworzenie bazy danych dla sklepu, który prowadzi działalność w zakresie sprzedaży towarów dla mężczyzn tj. odzież, obuwie, bielizna, galanteria skórzana, które nabywa od różnych dostawców tj. hurtowników i producentów. Klientami Firmy są osoby i inne firmy. 
                    </p>Zaprojektowana baza danych obejmuje procesy: </p>
                    <ul>
                        <li>zbieranie zamówień od klientów (w formie on-line);</li>
                        <li>sprzedaż towarów dla klientów na podstawie złożonych zamówień i ich wysyłkę do klienta;</li>
                        <li>gromadzenie danych o klientach;</li>
                        <li>gromadzenie danych o zakupach.</li>
                    </ul>
      
                    <p>Baza będzie przechowywać dane dotyczące:</p>
                    <ul>
                        <li>klienci (min. data rejestracji, imię, nazwisko, e-mail, telefon, typ klienta);</li>
                        <li>składane zamówienia (min. ilość produkt, daty zamówienia, daty realizacji zamówienia, daty wysyłki towarów, formę płatności, datę płatności, formę dostawy, adres dostawy);</li>
                        <li>sprzedaż towarów (min. ilość);</li>
                        <li>zakupy towarów (min. ilość, cena zakupu);</li>
                        <li>produkty (min. nazwa, kolor, rozmiar, cena sprzedaży);</li>
                        <li>kategorie produktów, podkategorie produktów.</li>
                    </ul>
                        <p> Baza danych będzie posiadać relacyjną strukturę tabel i ma ułatwiać selektywne pobieranie przechowywanych w niej informacji.</p>
                        <p>Baza ma umożliwić dodawanie, usuwanie i modyfikacje poszczególnych rekordów bazy.
    
                        <p>Do implementacji zostanie wykorzystany system zarządzania bazą MySQL</p>
                        <p>Przedmiotowa baza nie tylko będzie przechowywać dane, ułatwiać selektywne pobieranie przechowywanych w niej informacji, ale również umożliwić prowadzenie zaawansowanych czynności analitycznych ( zestawienia, miary, wskaźniki etc.) w oparciu o zgromadzone dane w zakresie:
                            <ul>
                                <li>Analizy zakupów</li>
                                <li>Analizy sprzedaży</li>
                                <li>Analizy zamówień</li>
                                <li>Analizy klientów</li>
                              </ul>
        
                            </p>
                        <p>Struktura bazy po przekształceniu projektu koncepcyjnego na relacyjny projekt bazy danych: </p>
    
                    
                    <figure>
                        <img class="schemat" src="schemat.jpg" width="900" height="750" alt="Bazy danych SQL">
                        <figcaption>schemat bazy</figcaption>   
                      </figure>
                      
                    <div class = linki> 
                    <p>kod SQL do pobrania:</p>
                        <li><a href="https://github.com/PiotrDlubak/projekt_bazodanowy/blob/main/utworzenie%20bazy%20z%20tabelami.sql" target="_blank">utworzenie bazy z tabelami.sql</a></li>
                        <li><a href="https://github.com/PiotrDlubak/projekt_bazodanowy/blob/main/dodanie%20danych%20testowych.sql" target="_blank">dodanie danych testowych.sql</a></li>
                        <li><a href="https://github.com/PiotrDlubak/projekt_bazodanowy/blob/main/dodanie%20kluczy%20obcych.sql" target="_blank">dodadnie kluczy obcych.sql</a></li>
                        <li><a href="https://github.com/PiotrDlubak/projekt_bazodanowy/blob/main/widoki%20mysql.sql" target="_blank">widoki mysql.sql</a></li>
                        <li><a href="https://github.com/PiotrDlubak/projekt_bazodanowy/blob/main/analizy%20sprzedaz.sql" target="_blank">analizy sprzedaz.sql</a></li>
                        <li><a href="https://github.com/PiotrDlubak/projekt_bazodanowy/blob/main/analizy%20zakupy.sql" target="_blank">analizy zakupy.sql</a></li>
                        <li><a href="https://github.com/PiotrDlubak/projekt_bazodanowy/blob/main/analizy%20zamowienia.sql" target="_blank">analizy zamowienia.sql</a></li>
                    </div>
            </article>  

            <article class="art1">
              <br>  
                <h3>Przykładowe skrypty SQL</h3>
                <h3>
                    Utworzenie bazy i dodanie tabel:
                </h3>
                    <pre class = "kod">
                        CREATE DATABASE sklep;
                        USE sklep;

                        -- Tabela adresy_dostawy

                        CREATE TABLE adresy_dostawy
                        (
                            id_adres_dostawy INTEGER NOT NULL AUTO_INCREMENT,
                            miasto VARCHAR(25),
                            ulica VARCHAR(25),
                            nr INTEGER NOT NULL,
                            uwagi VARCHAR(25),
                            CONSTRAINT pk_adresy_dostawy PRIMARY KEY (id_adres_dostawy)
                        );

                        -- Tabela formy_dostawy

                        CREATE TABLE formy_dostawy
                        (
                            id_forma_dostawy INTEGER NOT NULL AUTO_INCREMENT,
                            forma_dostawy VARCHAR(25),
                            CONSTRAINT pk_formy_dostawy PRIMARY KEY (id_forma_dostawy)
                        );

                        -- Tabela formy_płatności

                        CREATE TABLE formy_płatności
                        (
                            id_forma_płatności INTEGER NOT NULL AUTO_INCREMENT,
                            forma_płatności VARCHAR(12),
                            CONSTRAINT pk_formy_płatności PRIMARY KEY (id_forma_płatności)
                        );

                        -- Tabela kanały_sprzedaży

                        CREATE TABLE kanały_sprzedaży
                        (
                            id_kanał INTEGER NOT NULL AUTO_INCREMENT,
                            kanał_sprzedaż VARCHAR(25),
                            CONSTRAINT pk_kanały_sprzedaży PRIMARY KEY (id_kanał)
                        );

                        -- Tabela kategorie

                        CREATE TABLE kategorie
                        (
                            id_kategoria INTEGER NOT NULL AUTO_INCREMENT,
                            kategoria VARCHAR(25),
                            CONSTRAINT pk_kategoria PRIMARY KEY (id_kategoria)
                        );

                        -- Tabela klienci

                        CREATE TABLE klienci
                        (
                            id_klient INTEGER NOT NULL AUTO_INCREMENT,
                            data_rejestracji DATE,
                            imie VARCHAR(12),
                            nazwisko VARCHAR(12),
                            nazwa VARCHAR(255),
                            e_mail VARCHAR(45),
                            telefon INTEGER NOT NULL,
                            id_typ_klienta INTEGER NOT NULL,
                            CONSTRAINT pk_klienci PRIMARY KEY (id_klient)
                        );

                        -- Tabela podkategorie

                        CREATE TABLE podkategorie
                        (
                            id_podkategoria INTEGER NOT NULL AUTO_INCREMENT,
                            podkategoria VARCHAR(25),
                            id_kategoria INTEGER NOT NULL,
                            CONSTRAINT pk_podkategoria PRIMARY KEY (id_podkategoria)
                        );

                        -- Tabela produkty

                        CREATE TABLE produkty
                        (
                            id_produkt INTEGER NOT NULL AUTO_INCREMENT,
                            kod_produkt VARCHAR(12),
                            produkt VARCHAR(45),
                            kolor VARCHAR(12),
                            rozmiar VARCHAR(5),
                            cena_sprzedaży DECIMAL(10,2),
                            id_podkategoria INTEGER NOT NULL,
                            CONSTRAINT pk_produkty PRIMARY KEY (id_produkt)
                        );

                        -- Tabela sprzedaż

                        CREATE TABLE sprzedaż
                        (
                            id_sprzedaż INTEGER NOT NULL AUTO_INCREMENT,
                            id_zamówienie INTEGER NOT NULL,
                            id_produkt INTEGER NOT NULL,
                            ilość INTEGER NOT NULL,
                            CONSTRAINT pk_sprzedaż PRIMARY KEY (id_sprzedaż)
                        );

                        -- Tabela typy_klientów

                        CREATE TABLE typy_klientów
                        (
                            id_typ_klienta INTEGER NOT NULL AUTO_INCREMENT,
                            typ_klienta VARCHAR(15),
                            CONSTRAINT pk_typy_klientów PRIMARY KEY (id_typ_klienta)
                        );

                        -- Tabela zakupy

                        CREATE TABLE zakupy
                        (
                            id_zakup INTEGER NOT NULL AUTO_INCREMENT,
                            id_produkt INTEGER NOT NULL,
                            ilość INTEGER NOT NULL,
                            cena_zakupu NUMERIC(10,2),
                            CONSTRAINT pk_zakupy PRIMARY KEY (id_zakup)
                        );

                        -- Tabela zamówienia

                        CREATE TABLE zamówienia
                        (
                            id_zamówienie INTEGER NOT NULL AUTO_INCREMENT,
                            id_klient INTEGER NOT NULL,
                            data_zamówienia DATE,
                            data_wysyłki DATE,
                            data_odbioru DATE,
                            id_forma_płatności INTEGER NOT NULL,
                            id_kanał INTEGER NOT NULL,
                            id_forma_dostawy INTEGER NOT NULL,
                            data_zapłaty DATE,
                            id_adres_dostawy INTEGER NOT NULL,
                            CONSTRAINT pk_zamówienia PRIMARY KEY (id_zamówienie)
                        );
                    </pre>  
                      
                    <h3>
                        Dodanie kluczy obcych
                    </h3>
                  
                    <pre class = "kod">
                    ALTER TABLE klienci
                      ADD CONSTRAINT fk_klient_typ FOREIGN KEY (id_typ_klienta) REFERENCES typy_klientów (id_typ_klienta);
                    
                    ALTER TABLE podkategorie
                      ADD CONSTRAINT fk_podkategoria_kategoria FOREIGN KEY (id_kategoria) REFERENCES kategorie (id_kategoria);
                    
                    ALTER TABLE produkty
                      ADD CONSTRAINT fk_produkt_podkategoria FOREIGN KEY (id_podkategoria) REFERENCES podkategorie (id_podkategoria);
                    
                    ALTER TABLE sprzedaż
                      ADD CONSTRAINT fk_sprzedaz_produkt FOREIGN KEY (id_produkt) REFERENCES produkty (id_produkt),
                      ADD CONSTRAINT fk_sprzedaz_zam FOREIGN KEY (id_zamówienie) REFERENCES zamówienia (id_zamówienie);
                     
                    ALTER TABLE zakupy
                      ADD CONSTRAINT fk_zakupy_prod FOREIGN KEY (id_produkt) REFERENCES produkty (id_produkt);
                     
                    ALTER TABLE zamówienia
                      ADD CONSTRAINT fk_zamowienia_adres FOREIGN KEY (id_adres_dostawy) REFERENCES adresy_dostawy (id_adres_dostawy),
                      ADD CONSTRAINT fk_zamowienia_dostawy FOREIGN KEY (id_forma_dostawy) REFERENCES formy_dostawy (id_forma_dostawy),
                      ADD CONSTRAINT fk_zamowienia_kanal FOREIGN KEY (id_kanał) REFERENCES kanały_sprzedaży (id_kanał),
                      ADD CONSTRAINT fk_zamowienia_klient FOREIGN KEY (id_klient) REFERENCES klienci (id_klient),
                      ADD CONSTRAINT fk_zamowienia_płatnosc FOREIGN KEY (id_forma_płatności) REFERENCES formy_płatności (id_forma_płatności);
                    </pre> 
                    <h3>
                        Tworzenie indeksów
                    </h3>

                <pre class = "kod">
                    CREATE INDEX idx_adresy_dostawy ON adresy_dostawy (id_adres_dostawy);
                    CREATE INDEX idx_formy_dostawy ON formy_dostawy(id_forma_dostawy);
                    CREATE INDEX idx_formy_płatności ON formy_płatności(id_forma_płatności);
                    CREATE INDEX idx_kanały_sprzedaży ON kanały_sprzedaży(id_kanał);
                    CREATE INDEX idx_kategorie ON kategorie(id_kategoria);
                    CREATE INDEX idx_klienci ON klienci (id_klient);
                    CREATE INDEX idx_podkategorie ON podkategorie(id_podkategoria);
                    CREATE INDEX idx_produkty ON produkty(id_produkt);
                    CREATE INDEX idx_sprzedaż ON sprzedaż(id_sprzedaż);
                    CREATE INDEX idx_typy_klientów ON typy_klientów(id_typ_klienta);
                    CREATE INDEX idx_zakupy ON zakupy (id_zakup);
                    CREATE INDEX idx_zamówienia ON zamówienia(id_zamówienie);
                    
                </pre>

                <h3>
                    Dodanie danych testowych
                </h3>

                <pre class = "kod">
                    
               
                    INSERT INTO typy_klientów VALUES 
                        (1,'osoba'),
                        (2,'firma');
                    
                    
                    INSERT INTO klienci VALUES 
                        (1,'2016-06-14','Dawson','Torry',NULL,'screechingfairy@outlook.com',181457877,1),
                        (2,'2017-02-27','Eric','Allendorf',NULL,'tacky.giant@porter.com',688585219,1),
                        (3,'2017-06-16','Anne','Morin',NULL,'utopianadvice@outlook.com',824536464,1),
                        (4,'2018-05-18','Sullivan','Kingston',NULL,'petitebaby@dad.biz',180781829,1),
                        (5,'2015-08-26','Kaiya','Ackerman',NULL,'spectacular.sofa@outlook.com',410718475,1),
                        (6,'2016-03-09','Mikel','Campos',NULL,'haplessdrop40@aol.com',676113839,1),
                        (7,'2019-07-19','Mckenna','Annan',NULL,'shame77@aol.com',348132490,1),
                    .........
                    
                    
                    
                    INSERT INTO adresy_dostawy VALUES 
                        (1,'Kraków','Statement Ave',25,'paczkomat01'),
                        (2,'Poznań','Direction Boulevard W',51,'paczkomat02'),
                        (3,'Warszawa','Iron Ave',11,'paczkomat03'),
                        (4,'Warszawa','Knowledge Blvd',54,'paczkomat04'),
                        (5,'Poznań','Basin Avenue S',17,'paczkomat05'),
                        (6,'Gdańsk','Steam St W',24,'paczkomat06'),
                        (7,'Kraków','Tooth Street',43,'paczkomat07'),
                        (8,'Poznań','Decision Boulevard NW',70,'paczkomat08'),
                    ......
                    
                    
                    INSERT INTO formy_dostawy VALUES
                        (1,'kurier'),
                        (2,'odbiór osobisty'),
                        (3,'paczkomat'),
                        (4,'poczta'),
                        (5,'transport własny');
                    
                    INSERT INTO formy_płatności VALUES 
                        (1,'gotówka'),
                        (2,'karta'),
                        (3,'e-przelew'),
                        (4,'przelew');
                    
                    
                    
                    INSERT INTO kanały_sprzedaży VALUES 
                        (1,'portal aukcyjny'),
                        (2,'sklep on-line'),
                        (3,'sklep firmowy');
                    
                    
                    INSERT INTO kategorie VALUES 
                        (1,'odzież męska'),
                        (2,'buty'),
                        (3,'bielizna'),
                        (4,'galanteria skórzana'),
                        (5,'spodnie');
                    
                    
                    
                    INSERT INTO podkategorie VALUES 
                        (1,'koszula',1),
                        (2,'T-shirt',1),
                        (3,'spodnie jeans',5),
                        (4,'spodnie klasyczne',5),
                        (5,'buty wizytowe',2),
                        (6,'półbuty',2),
                        (7,'trzewiki',2),
                        (8,'botki',2),
                        (9,'buty sportowe',2),
                        (10,'slipy',3),
                        (11,'bokserki',3),
                        (12,'kąpielówki',3),
                        (13,'podkoszulki',3),
                        (14,'skarpetki',3),
                        (15,'torby',4),
                        (16,'paski',4);
                    
                    
                    INSERT INTO produkty VALUES 
                        (1,'KDR/1','koszula długi rękaw gładka S biała','biały','S',75,1),
                        (2,'KDR/2','koszula długi rękaw gładka S czarna','czarny','S',75,1),
                        (3,'KDR/3','koszula długi rękaw gładka S granatowa','granatowy','S',75,1),
                        (4,'KDR/4','koszula długi rękaw gładka S zielona','zielony','S',75,1),
                        (5,'KDR/5','koszula długi rękaw gładka S bordowa','bordowy','S',75,1),
                        (6,'KDR/6','koszula długi rękaw gładka M biała','biały','M',75,1),(
                        7,'KDR/7','koszula długi rękaw gładka M czarna','czarny','M',75,1),
                        (8,'KDR/8','koszula długi rękaw gładka M granatowa','granatowy','M',75,1),
                        ................
                    
                    
                    
                    
                    
                    
                    INSERT INTO zakupy VALUES 
                        (1,1,46,60.18),
                        (2,2,144,60.18),
                        (3,3,46,60.18),
                        (4,4,59,60.18),
                        (5,5,135,60.18),
                        (6,6,86,60.18),
                        (7,7,71,60.18),
                        (8,8,100,60.18),
                        (9,9,60,60.18),
                        .......................
                    
                    
                    INSERT INTO zamówienia VALUES 
                        (1,769,'2019-08-19','2019-08-31','2019-09-02',2,1,4,'2019-08-19',739),
                        (2,727,'2019-08-28','2019-09-09','2019-09-14',3,1,3,'2019-08-28',28),
                        (3,815,'2019-01-07','2019-01-11','2019-01-13',2,1,3,'2019-01-07',65),
                        (4,257,'2019-01-05','2019-01-07','2019-01-09',1,2,3,'2019-01-05',49),
                        (5,88,'2019-07-18','2019-07-29','2019-08-02',4,2,3,'2019-07-19',13),
                        (6,617,'2019-08-26','2019-09-09','2019-09-14',4,1,3,'2019-08-27',78),
                        (7,801,'2019-06-03','2019-06-05','2019-06-09',3,2,3,'2019-06-03',25),
                        .......................
                    
                    
                    
                    INSERT INTO sprzedaż VALUES 
                        (1,1,48,1),
                        (2,1,235,2),
                        (3,2,295,3),
                        (4,2,276,3),
                        (5,2,270,2),
                        (6,2,7,2),
                        (7,3,230,1),
                        ..............
                    
                    
                
                </pre>

                <h3>
                    Tworzenie widoków
                </h3>

                <pre class = "kod">
                    create view v_produkty as (
                        select
                          p.id_produkt,
                          p.produkt,
                          p.kolor,
                          p.rozmiar,
                          p.cena_sprzedaży,
                          pod.podkategoria,
                          k.kategoria
                        from
                          produkty p
                          left join podkategorie pod on p.id_podkategoria = pod.id_podkategoria
                          left join kategorie k on pod.id_kategoria = k.id_kategoria
                      );
                      
                      create view v_zakupy as (
                        select
                          p.id_produkt,
                          p.produkt,
                          p.kolor,
                          p.rozmiar,
                          p.cena_sprzedaży,
                          p.podkategoria,
                          p.kategoria,
                          z.ilość,
                          z.cena_zakupu
                        from
                          v_produkty p
                          left join zakupy z on p.id_produkt = z.id_produkt
                      );
                      
                      create view v_zamówienia as (
                        select
                          z.id_zamówienie,
                          z.id_klient,
                          z.data_zamówienia,
                          z.data_wysyłki,
                          z.data_odbioru,
                          d.forma_dostawy,
                          k.kanał_sprzedaz,
                          p.forma_płatności,
                          a.miasto as miasto_dostawy
                        from
                          zamówienia z
                          left join formy_dostawy d on z.id_forma_dostawy = d.id_forma_dostawy
                          left join kanały_sprzedaży k on z.id_kanał = k.id_kanał
                          left join formy_płatności p on z.id_forma_płatności = p.id_forma_płatności
                          left join adresy_dostawy a on z.id_adres_dostawy = a.id_adres_dostawy
                      );
                      
                      create view v_klienci as (
                        select
                          k.id_klient,
                          k.data_rejestracji,
                          k.imie,
                          k.nazwisko,
                          k.nazwa,
                          k.e_mail,
                          k.telefon,
                          t.typ_klienta
                        from
                          klienci k
                          left join typy_klientów t on k.id_typ_klienta = t.id_typ_klienta
                      );
                      
                      
                      create view v_sprzedaż as (
                         select
                          z.id_zamówienie,
                          p.produkt,
                          p.kolor,
                          p.rozmiar,
                          p.cena_sprzedaży,
                          s.ilość,
                          s.id_produkt
                      from sprzedaż s
                      left join v_zamówienia z on s.id_zamówienie=z.id_zamówienie
                      left join v_produkty p on s.id_produkt=p.id_produkt
                      
                      );
                      
                      create view v_sprzedaż2 as (
                         select
                         s.id_sprzedaż,
                          z.id_zamówienie,
                          p.produkt,
                          p.kolor,
                          p.rozmiar,
                          p.cena_sprzedaży,
                          s.ilość,
                          p.podkategoria,
                          p.kategoria
                      from sprzedaż s
                      left join v_zamówienia z on s.id_zamówienie=z.id_zamówienie
                      left join v_produkty p on s.id_produkt=p.id_produkt
                        );
                      
                        
                        create view v_statystyki_zakupy as(
                       SELECT distinct
                          produkt, podkategoria, kategoria,
                          SUM(ilość) OVER(PARTITION BY produkt,kategoria, podkategoria) AS liczba_produktów,
                          SUM(ilość*cena_zakupu) OVER(PARTITION BY produkt,kategoria,podkategoria) AS wartosć_produktów,
                          SUM(ilość) OVER() AS liczba_produktów_razem,
                          SUM(ilość*cena_zakupu) OVER() AS wartosć_produktów_ogółem,
                          SUM(ilość) OVER(PARTITION BY kategoria, podkategoria) AS liczba_produktów_podkategorii,
                          SUM(ilość*cena_zakupu) OVER(PARTITION BY kategoria,podkategoria) AS wartosć_produktów_podkategorii,
                          SUM(ilość) OVER(PARTITION BY kategoria) AS liczba_produktów_kategorii,
                          SUM(ilość*cena_zakupu) OVER(PARTITION BY kategoria) AS wartosć_produktów_kategorii
                      FROM v_zakupy v
                      ORDER BY kategoria);
                        
                        
                            
                      create view v_sprzedaż_zamówienia as(
                       SELECT distinct 
                          s.id_sprzedaż,
                          z.id_zamówienie,
                          s.produkt,
                          s.kolor,
                          s.rozmiar,
                          s.cena_sprzedaży,
                          s.ilość,
                          s.podkategoria,
                          s.kategoria,
                          z.id_klient,
                          z.data_zamówienia,
                          z.data_wysyłki,
                          z.data_odbioru,
                          z.forma_dostawy,
                          z.kanał_sprzedaz,
                          z.forma_płatności,
                          z.miasto_dostawy,
                          k.typ_klienta
                       FROM v_sprzedaż2 
                          left join v_zamówienia z on s.id_zamówienie=z.id_zamówienie
                          left join v_klienci k on z.id_klient=k.id_klient
                      
                      ORDER BY id_sprzedaż);
                      
                        
                      create view v_statystyki_sprzedaż as(
                      select distinct produkt, podkategoria, kategoria,
                         SUM(ilość) OVER(PARTITION BY produkt,kategoria, podkategoria) AS liczba_produktów,
                          SUM(ilość*cena_sprzedaży) OVER(PARTITION BY produkt,kategoria,podkategoria) AS wartosć_produktów,
                          SUM(ilość) OVER() AS liczba_produktów_razem,
                          SUM(ilość*cena_sprzedaży) OVER() AS wartosć_produktów_ogółem,
                          SUM(ilość) OVER(PARTITION BY kategoria, podkategoria) AS liczba_produktów_podkategorii,
                          SUM(ilość*cena_sprzedaży) OVER(PARTITION BY kategoria,podkategoria) AS wartosć_produktów_podkategorii,
                          SUM(ilość) OVER(PARTITION BY kategoria) AS liczba_produktów_kategorii,
                          SUM(ilość*cena_sprzedaży) OVER(PARTITION BY kategoria) AS wartosć_produktów_kategorii
                          from
                      v_sprzedaż_zamówienia);
                
                </pre>

                <h3>
                    Analiza sprzedaży
                </h3>

                <pre class = "kod">
                
            <p class = "ng">
            -------------------------------------------------------
            Lista tabel w bazie danych:
            -------------------------------------------------------
            </p>


                SHOW FULL TABLES IN sklep 
                WHERE TABLE_TYPE = &#39;BASE TABLE&#39;;
                


                <table class="dataframe styled-table">
                    <thead>
                        <tr>
                <th></th>
                <th>Tables_in_sklep</th>
                <th>Table_type</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                <th>0</th>
                <td>adresy_dostawy</td>
                <td>BASE TABLE</td>
                </tr>
                <tr>
                <th>1</th>
                <td>formy_dostawy</td>
                <td>BASE TABLE</td>
                </tr>
                <tr>
                <th>2</th>
                <td>formy_płatności</td>
                <td>BASE TABLE</td>
                </tr>
                <tr>
                <th>3</th>
                <td>kanały_sprzedaży</td>
                <td>BASE TABLE</td>
                </tr>
                <tr>
                <th>4</th>
                <td>kategorie</td>
                <td>BASE TABLE</td>
                </tr>
                <tr>
                <th>5</th>
                <td>klienci</td>
                <td>BASE TABLE</td>
                </tr>
                <tr>
                <th>6</th>
                <td>podkategorie</td>
                <td>BASE TABLE</td>
                </tr>
                <tr>
                <th>7</th>
                <td>produkty</td>
                <td>BASE TABLE</td>
                </tr>
                <tr>
                <th>8</th>
                <td>sprzedaż</td>
                <td>BASE TABLE</td>
                </tr>
                <tr>
                <th>9</th>
                <td>typy_klientów</td>
                <td>BASE TABLE</td>
                </tr>
                <tr>
                <th>10</th>
                <td>zakupy</td>
                <td>BASE TABLE</td>
                </tr>
                <tr>
                <th>11</th>
                <td>zamówienia</td>
                <td>BASE TABLE</td>
                </tr>
            </tbody>
            </table>




            -------------------------------------------------------
            Lista widoków w bazie danych:
            -------------------------------------------------------

                SHOW FULL TABLES IN sklep 
                WHERE TABLE_TYPE = &#39;VIEW&#39;;
                


              <table class="dataframe styled-table">
                <thead>
                  <tr>
                    <th></th>
                    <th>Tables_in_sklep</th>
                    <th>Table_type</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <th>0</th>
                    <td>v_klienci</td>
                    <td>VIEW</td>
                  </tr>
                  <tr>
                    <th>1</th>
                    <td>v_produkty</td>
                    <td>VIEW</td>
                  </tr>
                  <tr>
                    <th>2</th>
                    <td>v_sprzedaż</td>
                    <td>VIEW</td>
                  </tr>
                  <tr>
                    <th>3</th>
                    <td>v_sprzedaż2</td>
                    <td>VIEW</td>
                  </tr>
                  <tr>
                    <th>4</th>
                    <td>v_sprzedaż_zamówienia</td>
                    <td>VIEW</td>
                  </tr>
                  <tr>
                    <th>5</th>
                    <td>v_statystyki_sprzedaż</td>
                    <td>VIEW</td>
                  </tr>
                  <tr>
                    <th>6</th>
                    <td>v_statystyki_zakupy</td>
                    <td>VIEW</td>
                  </tr>
                  <tr>
                    <th>7</th>
                    <td>v_zakupy</td>
                    <td>VIEW</td>
                  </tr>
                  <tr>
                    <th>8</th>
                    <td>v_zamówienia</td>
                    <td>VIEW</td>
                  </tr>
                </tbody>
              </table>




              -------------------------------------------------------
              Sprzedaż produktów wg koloru i rozmiaru:
              -------------------------------------------------------

                  SELECT
                      s.id_sprzedaż AS id_sprzedaż,
                      z.id_zamówienie AS id_zamówienie,
                      p.produkt AS produkt,
                      p.kolor AS kolor,
                      p.rozmiar AS rozmiar,
                      p.cena_sprzedaży AS cena_sprzedaży,
                      s.ilość AS ilość,
                      p.podkategoria AS podkategoria,
                      p.kategoria AS kategoria
                  FROM
                      sklep.sprzedaż s
                  LEFT JOIN sklep.v_zamówienia z ON s.id_zamówienie = z.id_zamówienie
                  LEFT JOIN sklep.v_produkty p ON s.id_produkt = p.id_produkt
                  WHERE p.kolor = &#39;biały&#39; AND p.rozmiar = &#39;xl&#39;;
                  


              <table class="dataframe styled-table">
                <thead>
                  <tr>
                    <th></th>
                    <th>id_sprzedaż</th>
                    <th>id_zamówienie</th>
                    <th>produkt</th>
                    <th>kolor</th>
                    <th>rozmiar</th>
                    <th>cena_sprzedaży</th>
                    <th>ilość</th>
                    <th>podkategoria</th>
                    <th>kategoria</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <th>0</th>
                    <td>482</td>
                    <td>160</td>
                    <td>koszula długi rękaw gładka XL biała</td>
                    <td>biały</td>
                    <td>XL</td>
                    <td>75.0</td>
                    <td>3</td>
                    <td>koszula</td>
                    <td>odzież męska</td>
                  </tr>
                  <tr>
                    <th>1</th>
                    <td>657</td>
                    <td>216</td>
                    <td>koszula długi rękaw gładka XL biała</td>
                    <td>biały</td>
                    <td>XL</td>
                    <td>75.0</td>
                    <td>3</td>
                    <td>koszula</td>
                    <td>odzież męska</td>
                  </tr>
                  <tr>
                    <th>2</th>
                    <td>1521</td>
                    <td>490</td>
                    <td>koszula długi rękaw gładka XL biała</td>
                    <td>biały</td>
                    <td>XL</td>
                    <td>75.0</td>
                    <td>1</td>
                    <td>koszula</td>
                    <td>odzież męska</td>
                  </tr>
                  <tr>
                    <th>3</th>
                    <td>2239</td>
                    <td>726</td>
                    <td>koszula długi rękaw gładka XL biała</td>
                    <td>biały</td>
                    <td>XL</td>
                    <td>75.0</td>
                    <td>1</td>
                    <td>koszula</td>
                    <td>odzież męska</td>
                  </tr>
                  <tr>
                    <th>4</th>
                    <td>279</td>
                    <td>93</td>
                    <td>koszula długi rękaw w paski XL biała</td>
                    <td>biały</td>
                    <td>XL</td>
                    <td>75.0</td>
                    <td>3</td>
                    <td>koszula</td>
                    <td>odzież męska</td>
                  </tr>
                  <tr>
                    <th>...</th>
                    <td>...</td>
                    <td>...</td>
                    <td>...</td>
                    <td>...</td>
                    <td>...</td>
                    <td>...</td>
                    <td>...</td>
                    <td>...</td>
                    <td>...</td>
                  </tr>
                  <tr>
                    <th>56</th>
                    <td>1907</td>
                    <td>609</td>
                    <td>kąpielówki XL biały</td>
                    <td>biały</td>
                    <td>XL</td>
                    <td>29.0</td>
                    <td>2</td>
                    <td>kąpielówki</td>
                    <td>bielizna</td>
                  </tr>
                  <tr>
                    <th>57</th>
                    <td>2361</td>
                    <td>767</td>
                    <td>kąpielówki XL biały</td>
                    <td>biały</td>
                    <td>XL</td>
                    <td>29.0</td>
                    <td>1</td>
                    <td>kąpielówki</td>
                    <td>bielizna</td>
                  </tr>
                  <tr>
                    <th>58</th>
                    <td>259</td>
                    <td>86</td>
                    <td>podkoszulki XL biały</td>
                    <td>biały</td>
                    <td>XL</td>
                    <td>36.0</td>
                    <td>3</td>
                    <td>podkoszulki</td>
                    <td>bielizna</td>
                  </tr>
                  <tr>
                    <th>59</th>
                    <td>492</td>
                    <td>163</td>
                    <td>podkoszulki XL biały</td>
                    <td>biały</td>
                    <td>XL</td>
                    <td>36.0</td>
                    <td>1</td>
                    <td>podkoszulki</td>
                    <td>bielizna</td>
                  </tr>
                  <tr>
                    <th>60</th>
                    <td>1954</td>
                    <td>632</td>
                    <td>podkoszulki XL biały</td>
                    <td>biały</td>
                    <td>XL</td>
                    <td>36.0</td>
                    <td>1</td>
                    <td>podkoszulki</td>
                    <td>bielizna</td>
                  </tr>
                </tbody>
              </table>



              -------------------------------------------------------
              Sprzedaż produktów ogółem - liczba:
              -------------------------------------------------------

                  SELECT SUM(ilość) AS iloscTotal FROM v_sprzedaż;
                  


              <table class="dataframe styled-table">
                <thead>
                  <tr>
                    <th></th>
                    <th>iloscTotal</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <th>0</th>
                    <td>5046.0</td>
                  </tr>
                </tbody>
              </table>



              -------------------------------------------------------
              Sprzedaż produktów ogółem - wartość:
              -------------------------------------------------------

                  SELECT SUM(ilość * cena_sprzedaży) AS wartoscTotal 
                  FROM v_sprzedaż;
                  


              <table class="dataframe styled-table">
                <thead>
                  <tr>
                    <th></th>
                    <th>wartoscTotal</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <th></th>
                    <td>494881.0</td>
                  </tr>
                </tbody>
              </table>



              -------------------------------------------------------
              Liczba produktów:
              -------------------------------------------------------

                  SELECT SUM(ilość) as liczba_towarów
                  FROM v_sprzedaż;
                  


              <table class="dataframe styled-table">
                <thead>
                  <tr>
                    <th></th>
                    <th>liczba_towarów</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <th></th>
                    <td>5046.0</td>
                  </tr>
                </tbody>
              </table>



              -------------------------------------------------------
              wartość produktów:
              -------------------------------------------------------

                  SELECT SUM(ilość * cena_sprzedaży) as wartość_produktów
                  FROM v_sprzedaż;
                  


              <table class="dataframe styled-table">
                <thead>
                  <tr>
                    <th></th>
                    <th>wartość_produktów</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <th></th>
                    <td>494881.0</td>
                  </tr>
                </tbody>
              </table>



              -------------------------------------------------------
              ilośc i wartość sprzedaży wg kategorii i podkategorii:
              -------------------------------------------------------

              SELECT DISTINCT
                  kategoria,
                  podkategoria,
                  SUM(ilość) OVER (PARTITION BY kategoria, podkategoria) AS liczba_produktów_wg_kategorii,
                  SUM(ilość * cena_sprzedaży) OVER (PARTITION BY kategoria, podkategoria) AS wartość_produktów_wg_kategorii
              FROM v_sprzedaż_zamówienia
              ORDER BY kategoria, podkategoria;



              <table class="dataframe styled-table">
                <thead>
                  <tr>
                    <th></th>
                    <th>kategoria</th>
                    <th>podkategoria</th>
                    <th>liczba_produktów_wg_kategorii</th>
                    <th>wartość_produktów_wg_kategorii</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <th>0</th>
                    <td>bielizna</td>
                    <td>bokserki</td>
                    <td>225.0</td>
                    <td>10575.0</td>
                  </tr>
                  <tr>
                    <th>1</th>
                    <td>bielizna</td>
                    <td>kąpielówki</td>
                    <td>190.0</td>
                    <td>5615.0</td>
                  </tr>
                  <tr>
                    <th>2</th>
                    <td>bielizna</td>
                    <td>podkoszulki</td>
                    <td>210.0</td>
                    <td>7560.0</td>
                  </tr>
                  <tr>
                    <th>3</th>
                    <td>bielizna</td>
                    <td>skarpetki</td>
                    <td>124.0</td>
                    <td>2728.0</td>
                  </tr>
                  <tr>
                    <th>4</th>
                    <td>bielizna</td>
                    <td>slipy</td>
                    <td>209.0</td>
                    <td>7942.0</td>
                  </tr>
                  <tr>
                    <th>5</th>
                    <td>buty</td>
                    <td>botki</td>
                    <td>194.0</td>
                    <td>36860.0</td>
                  </tr>
                  <tr>
                    <th>6</th>
                    <td>buty</td>
                    <td>buty sportowe</td>
                    <td>215.0</td>
                    <td>59390.0</td>
                  </tr>
                  <tr>
                    <th>7</th>
                    <td>buty</td>
                    <td>buty wizytowe</td>
                    <td>194.0</td>
                    <td>46560.0</td>
                  </tr>
                  <tr>
                    <th>8</th>
                    <td>buty</td>
                    <td>półbuty</td>
                    <td>211.0</td>
                    <td>39457.0</td>
                  </tr>
                  <tr>
                    <th>9</th>
                    <td>buty</td>
                    <td>trzewiki</td>
                    <td>213.0</td>
                    <td>54796.0</td>
                  </tr>
                  <tr>
                    <th>10</th>
                    <td>galanteria skórzana</td>
                    <td>paski</td>
                    <td>175.0</td>
                    <td>10795.0</td>
                  </tr>
                  <tr>
                    <th>11</th>
                    <td>galanteria skórzana</td>
                    <td>torby</td>
                    <td>72.0</td>
                    <td>12816.0</td>
                  </tr>
                  <tr>
                    <th>12</th>
                    <td>odzież męska</td>
                    <td>koszula</td>
                    <td>1542.0</td>
                    <td>111162.0</td>
                  </tr>
                  <tr>
                    <th>13</th>
                    <td>odzież męska</td>
                    <td>T-shirt</td>
                    <td>683.0</td>
                    <td>27714.0</td>
                  </tr>
                  <tr>
                    <th>14</th>
                    <td>spodnie</td>
                    <td>spodnie jeans</td>
                    <td>283.0</td>
                    <td>33677.0</td>
                  </tr>
                  <tr>
                    <th>15</th>
                    <td>spodnie</td>
                    <td>spodnie klasyczne</td>
                    <td>306.0</td>
                    <td>27234.0</td>
                  </tr>
                </tbody>
              </table>



              -------------------------------------------------------
              wartość produktów:
              -------------------------------------------------------

              SELECT SUM(ilość * cena_sprzedaży) AS wartość_produktów
              FROM v_sprzedaż;
                  


              <table class="dataframe styled-table">
                <thead>
                  <tr>
                    <th></th>
                    <th>wartość_produktów</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <th></th>
                    <td>494881.0</td>
                  </tr>
                </tbody>
              </table>



              -------------------------------------------------------
              ilość i wartość sprzedaży wg produktu:
              -------------------------------------------------------

              SELECT DISTINCT
                  produkt,
                  SUM(ilość) OVER(PARTITION BY produkt) AS liczba_produktów,
                  SUM(ilość*cena_sprzedaży) OVER(PARTITION BY produkt) AS wartosć_produktów
              FROM
                  v_sprzedaż_zamówienia
              LIMIT 8;



              <table class="dataframe styled-table">
                <thead>
                  <tr>
                    <th></th>
                    <th>produkt</th>
                    <th>liczba_produktów</th>
                    <th>wartosć_produktów</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <th>0</th>
                    <td>bokserki L biały</td>
                    <td>19.0</td>
                    <td>893.0</td>
                  </tr>
                  <tr>
                    <th>1</th>
                    <td>bokserki L brązowy</td>
                    <td>24.0</td>
                    <td>1128.0</td>
                  </tr>
                  <tr>
                    <th>2</th>
                    <td>bokserki L czarny</td>
                    <td>9.0</td>
                    <td>423.0</td>
                  </tr>
                  <tr>
                    <th>3</th>
                    <td>bokserki L granatowy</td>
                    <td>13.0</td>
                    <td>611.0</td>
                  </tr>
                  <tr>
                    <th>4</th>
                    <td>bokserki M biały</td>
                    <td>9.0</td>
                    <td>423.0</td>
                  </tr>
                  <tr>
                    <th>5</th>
                    <td>bokserki M brązowy</td>
                    <td>19.0</td>
                    <td>893.0</td>
                  </tr>
                  <tr>
                    <th>6</th>
                    <td>bokserki M czarny</td>
                    <td>5.0</td>
                    <td>235.0</td>
                  </tr>
                  <tr>
                    <th>7</th>
                    <td>bokserki M granatowy</td>
                    <td>5.0</td>
                    <td>235.0</td>
                  </tr>
                </tbody>
              </table>


              -------------------------------------------------------
              top N produktów w kategorii - ilości:
              -------------------------------------------------------

              WITH cte1 AS (
                  SELECT
                      kategoria,
                      podkategoria,
                      produkt,
                      ilość,
                      DENSE_RANK() OVER (PARTITION BY kategoria ORDER BY ilość DESC) AS ranking
                  FROM
                      v_sprzedaż_zamówienia
                  WHERE
                      kategoria = &#39;odzież męska&#39;
              )

              SELECT
                  kategoria,
                  produkt,
                  ilość,
                  ranking
              FROM
                  cte1
              WHERE
                  ranking &lt;= 2
              LIMIT 8;


              <table class="dataframe styled-table">
                <thead>
                  <tr>
                    <th></th>
                    <th>kategoria</th>
                    <th>produkt</th>
                    <th>ilość</th>
                    <th>ranking</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <th>0</th>
                    <td>odzież męska</td>
                    <td>T-shirt bawełna XXL granatowa</td>
                    <td>3</td>
                    <td>1</td>
                  </tr>
                  <tr>
                    <th>1</th>
                    <td>odzież męska</td>
                    <td>koszula krótki rękaw w paski XL czarna</td>
                    <td>3</td>
                    <td>1</td>
                  </tr>
                  <tr>
                    <th>2</th>
                    <td>odzież męska</td>
                    <td>koszula krótki rękaw w kratkę XL czarna</td>
                    <td>3</td>
                    <td>1</td>
                  </tr>
                  <tr>
                    <th>3</th>
                    <td>odzież męska</td>
                    <td>T-shirt bawełna S czarna</td>
                    <td>3</td>
                    <td>1</td>
                  </tr>
                  <tr>
                    <th>4</th>
                    <td>odzież męska</td>
                    <td>koszula długi rękaw w paski S bordowa</td>
                    <td>3</td>
                    <td>1</td>
                  </tr>
                  <tr>
                    <th>5</th>
                    <td>odzież męska</td>
                    <td>koszula krótki rękaw gładka M biała</td>
                    <td>3</td>
                    <td>1</td>
                  </tr>
                  <tr>
                    <th>6</th>
                    <td>odzież męska</td>
                    <td>koszula krótki rękaw w kratkę XL bordowa</td>
                    <td>3</td>
                    <td>1</td>
                  </tr>
                  <tr>
                    <th>7</th>
                    <td>odzież męska</td>
                    <td>koszula długi rękaw w kratkę S zielona</td>
                    <td>3</td>
                    <td>1</td>
                  </tr>
                </tbody>
              </table>



              -------------------------------------------------------
              top N produków w podkategorii - ilości:
              -------------------------------------------------------

              WITH cte1 AS (
                  SELECT
                      kategoria,
                      podkategoria,
                      produkt,
                      ilość,
                      DENSE_RANK() OVER (PARTITION BY podkategoria ORDER BY ilość DESC) AS ranking
                  FROM
                      v_sprzedaż_zamówienia
                  WHERE
                      podkategoria = &#39;T-shirt&#39;
              )

              SELECT
                  podkategoria,
                  produkt,
                  ilość,
                  ranking
              FROM
                  cte1
              WHERE
                  ranking &lt;= 2
              LIMIT 8;
              


              <table class="dataframe styled-table">
                <thead>
                  <tr>
                    <th></th>
                    <th>podkategoria</th>
                    <th>produkt</th>
                    <th>ilość</th>
                    <th>ranking</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <th>0</th>
                    <td>T-shirt</td>
                    <td>T-shirt bawełna M zielona</td>
                    <td>3</td>
                    <td>1</td>
                  </tr>
                  <tr>
                    <th>1</th>
                    <td>T-shirt</td>
                    <td>T-shirt bawełna XXL</td>
                    <td>3</td>
                    <td>1</td>
                  </tr>
                  <tr>
                    <th>2</th>
                    <td>T-shirt</td>
                    <td>T-shirt bawełna S zielona</td>
                    <td>3</td>
                    <td>1</td>
                  </tr>
                  <tr>
                    <th>3</th>
                    <td>T-shirt</td>
                    <td>T-shirt polo XL biała</td>
                    <td>3</td>
                    <td>1</td>
                  </tr>
                  <tr>
                    <th>4</th>
                    <td>T-shirt</td>
                    <td>T-shirt jeans M granatowa</td>
                    <td>3</td>
                    <td>1</td>
                  </tr>
                  <tr>
                    <th>5</th>
                    <td>T-shirt</td>
                    <td>T-shirt polo S granatowa</td>
                    <td>3</td>
                    <td>1</td>
                  </tr>
                  <tr>
                    <th>6</th>
                    <td>T-shirt</td>
                    <td>T-shirt bawełna XL zielona</td>
                    <td>3</td>
                    <td>1</td>
                  </tr>
                  <tr>
                    <th>7</th>
                    <td>T-shirt</td>
                    <td>T-shirt jeans XL bordowa</td>
                    <td>3</td>
                    <td>1</td>
                  </tr>
                </tbody>
              </table>


              -------------------------------------------------------
              top N produktów w kategorii - wartości:
              -------------------------------------------------------

              WITH cte1 AS (
                  SELECT
                      kategoria,
                      podkategoria,
                      produkt,
                      ilość * cena_sprzedaży AS wartosc,
                      DENSE_RANK() OVER (PARTITION BY kategoria ORDER BY ilość * cena_sprzedaży DESC) AS ranking
                  FROM
                      v_sprzedaż_zamówienia
                  WHERE
                      kategoria = &#39;odzież męska&#39;
              )

              SELECT
                  kategoria,
                  produkt,
                  wartosc,
                  ranking
              FROM
                  cte1
              WHERE
                  ranking &lt;= 3;




              <table class="dataframe styled-table">
                <thead>
                  <tr>
                    <th></th>
                    <th>kategoria</th>
                    <th>produkt</th>
                    <th>wartosc</th>
                    <th>ranking</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <th>0</th>
                    <td>odzież męska</td>
                    <td>koszula długi rękaw w kratkę L zielona</td>
                    <td>225.0</td>
                    <td>1</td>
                  </tr>
                  <tr>
                    <th>1</th>
                    <td>odzież męska</td>
                    <td>koszula długi rękaw w paski XXL czarna</td>
                    <td>225.0</td>
                    <td>1</td>
                  </tr>
                  <tr>
                    <th>2</th>
                    <td>odzież męska</td>
                    <td>koszula długi rękaw w paski S czarna</td>
                    <td>225.0</td>
                    <td>1</td>
                  </tr>
                  <tr>
                    <th>3</th>
                    <td>odzież męska</td>
                    <td>koszula długi rękaw w kratkę L bordowa</td>
                    <td>225.0</td>
                    <td>1</td>
                  </tr>
                  <tr>
                    <th>4</th>
                    <td>odzież męska</td>
                    <td>koszula długi rękaw w kratkę L granatowa</td>
                    <td>225.0</td>
                    <td>1</td>
                  </tr>
                  <tr>
                    <th>...</th>
                    <td>...</td>
                    <td>...</td>
                    <td>...</td>
                    <td>...</td>
                  </tr>
                  <tr>
                    <th>382</th>
                    <td>odzież męska</td>
                    <td>koszula długi rękaw w kratkę XXL granatowa</td>
                    <td>150.0</td>
                    <td>3</td>
                  </tr>
                  <tr>
                    <th>383</th>
                    <td>odzież męska</td>
                    <td>koszula długi rękaw gładka M granatowa</td>
                    <td>150.0</td>
                    <td>3</td>
                  </tr>
                  <tr>
                    <th>384</th>
                    <td>odzież męska</td>
                    <td>koszula długi rękaw w paski L bordowa</td>
                    <td>150.0</td>
                    <td>3</td>
                  </tr>
                  <tr>
                    <th>385</th>
                    <td>odzież męska</td>
                    <td>koszula długi rękaw w paski S bordowa</td>
                    <td>150.0</td>
                    <td>3</td>
                  </tr>
                  <tr>
                    <th>386</th>
                    <td>odzież męska</td>
                    <td>koszula długi rękaw w paski M biała</td>
                    <td>150.0</td>
                    <td>3</td>
                  </tr>
                </tbody>
              </table>
              <p>387 rows × 4 columns</p>



              -------------------------------------------------------
              top N produktów w podkategorii - wartości:
              -------------------------------------------------------

              WITH cte1 AS (
                  SELECT
                      podkategoria,
                      produkt,
                      ilość * cena_sprzedaży AS wartosc,
                      DENSE_RANK() OVER (PARTITION BY podkategoria ORDER BY ilość * cena_sprzedaży DESC) AS ranking
                  FROM
                      v_sprzedaż_zamówienia
                  WHERE
                      podkategoria = &#39;bokserki&#39;
              )

              SELECT
                  podkategoria,
                  produkt,
                  wartosc,
                  ranking
              FROM
                  cte1
              WHERE
                  ranking &lt;= 3;




              <table class="dataframe styled-table">
                <thead>
                  <tr>
                    <th></th>
                    <th>podkategoria</th>
                    <th>produkt</th>
                    <th>wartosc</th>
                    <th>ranking</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <th>0</th>
                    <td>bokserki</td>
                    <td>bokserki L granatowy</td>
                    <td>141.0</td>
                    <td>1</td>
                  </tr>
                  <tr>
                    <th>1</th>
                    <td>bokserki</td>
                    <td>bokserki XXL biały</td>
                    <td>141.0</td>
                    <td>1</td>
                  </tr>
                  <tr>
                    <th>2</th>
                    <td>bokserki</td>
                    <td>bokserki L brązowy</td>
                    <td>141.0</td>
                    <td>1</td>
                  </tr>
                  <tr>
                    <th>3</th>
                    <td>bokserki</td>
                    <td>bokserki L biały</td>
                    <td>141.0</td>
                    <td>1</td>
                  </tr>
                  <tr>
                    <th>4</th>
                    <td>bokserki</td>
                    <td>bokserki L brązowy</td>
                    <td>141.0</td>
                    <td>1</td>
                  </tr>
                  <tr>
                    <th>...</th>
                    <td>...</td>
                    <td>...</td>
                    <td>...</td>
                    <td>...</td>
                  </tr>
                  <tr>
                    <th>108</th>
                    <td>bokserki</td>
                    <td>bokserki S brązowy</td>
                    <td>47.0</td>
                    <td>3</td>
                  </tr>
                  <tr>
                    <th>109</th>
                    <td>bokserki</td>
                    <td>bokserki S brązowy</td>
                    <td>47.0</td>
                    <td>3</td>
                  </tr>
                  <tr>
                    <th>110</th>
                    <td>bokserki</td>
                    <td>bokserki XXL biały</td>
                    <td>47.0</td>
                    <td>3</td>
                  </tr>
                  <tr>
                    <th>111</th>
                    <td>bokserki</td>
                    <td>bokserki XXL biały</td>
                    <td>47.0</td>
                    <td>3</td>
                  </tr>
                  <tr>
                    <th>112</th>
                    <td>bokserki</td>
                    <td>bokserki XL brązowy</td>
                    <td>47.0</td>
                    <td>3</td>
                  </tr>
                </tbody>
              </table>



              -------------------------------------------------------
              top 3 kategorii wg liczby produktów:
              -------------------------------------------------------

              SELECT DISTINCT
                  kategoria,
                  SUM(ilość) OVER(PARTITION BY kategoria) AS liczba_produktów
              FROM
                  v_sprzedaż_zamówienia
              ORDER BY liczba_produktów DESC
              LIMIT 3;



              <table class="dataframe styled-table">
                <thead>
                  <tr>
                    <th></th>
                    <th>kategoria</th>
                    <th>liczba_produktów</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <th>0</th>
                    <td>odzież męska</td>
                    <td>2225.0</td>
                  </tr>
                  <tr>
                    <th>1</th>
                    <td>buty</td>
                    <td>1027.0</td>
                  </tr>
                  <tr>
                    <th>2</th>
                    <td>bielizna</td>
                    <td>958.0</td>
                  </tr>
                </tbody>
              </table>




              -------------------------------------------------------
              top 3 podkategorii wg liczby produktów:
              -------------------------------------------------------

              SELECT DISTINCT
                  podkategoria,
                  SUM(ilość) OVER(PARTITION BY podkategoria) AS liczba_produktów
              FROM
                  v_sprzedaż_zamówienia
              ORDER BY liczba_produktów DESC
              LIMIT 3;



              <table class="dataframe styled-table">
                <thead>
                  <tr>
                    <th></th>
                    <th>podkategoria</th>
                    <th>liczba_produktów</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <th>0</th>
                    <td>koszula</td>
                    <td>1542.0</td>
                  </tr>
                  <tr>
                    <th>1</th>
                    <td>T-shirt</td>
                    <td>683.0</td>
                  </tr>
                  <tr>
                    <th>2</th>
                    <td>spodnie klasyczne</td>
                    <td>306.0</td>
                  </tr>
                </tbody>
              </table>


              -------------------------------------------------------
              top 10 produktów wg liczby produktów:
              -------------------------------------------------------

              SELECT DISTINCT
                  produkt,
                  SUM(ilość) OVER(PARTITION BY produkt) AS liczba_produktów
              FROM
                  v_sprzedaż_zamówienia
              ORDER BY liczba_produktów DESC
              LIMIT 10;



              <table class="dataframe styled-table">
                <thead>
                  <tr>
                    <th></th>
                    <th>produkt</th>
                    <th>liczba_produktów</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <th>0</th>
                    <td>koszula długi rękaw w kratkę XXL czarna</td>
                    <td>27.0</td>
                  </tr>
                  <tr>
                    <th>1</th>
                    <td>koszula długi rękaw w kratkę L biała</td>
                    <td>26.0</td>
                  </tr>
                  <tr>
                    <th>2</th>
                    <td>buty półbuty 41 czarny</td>
                    <td>25.0</td>
                  </tr>
                  <tr>
                    <th>3</th>
                    <td>spodnie jeans XL czarny</td>
                    <td>25.0</td>
                  </tr>
                  <tr>
                    <th>4</th>
                    <td>bokserki L brązowy</td>
                    <td>24.0</td>
                  </tr>
                  <tr>
                    <th>5</th>
                    <td>buty trzewiki 39 czarny</td>
                    <td>24.0</td>
                  </tr>
                  <tr>
                    <th>6</th>
                    <td>koszula długi rękaw w paski XXL czarna</td>
                    <td>24.0</td>
                  </tr>
                  <tr>
                    <th>7</th>
                    <td>slipy XXL czarny</td>
                    <td>24.0</td>
                  </tr>
                  <tr>
                    <th>8</th>
                    <td>spodnie jeans XXL popiel</td>
                    <td>23.0</td>
                  </tr>
                  <tr>
                    <th>9</th>
                    <td>spodnie klasyczne S popiel</td>
                    <td>23.0</td>
                  </tr>
                </tbody>
              </table>


              -------------------------------------------------------
              procentowy udział wartości produktów:
              -------------------------------------------------------

              SELECT DISTINCT
                  produkt,
                  SUM(ilość * cena_sprzedaży) OVER(PARTITION BY produkt) AS wartość_produktów,
                  ROUND(SUM(ilość * cena_sprzedaży) OVER(PARTITION BY produkt) / (SELECT SUM(ilość * cena_sprzedaży) FROM v_sprzedaż) * 100, 2) AS proc_udział_w_całości
              FROM
                  v_sprzedaż
              ORDER BY proc_udział_w_całości DESC;



              <table class="dataframe styled-table">
                <thead>
                  <tr>
                    <th></th>
                    <th>produkt</th>
                    <th>wartość_produktów</th>
                    <th>proc_udział_w_całości</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <th>0</th>
                    <td>buty trzewiki 39 czarny</td>
                    <td>6240.0</td>
                    <td>1.26</td>
                  </tr>
                  <tr>
                    <th>1</th>
                    <td>buty sportowe 42 czarny</td>
                    <td>5600.0</td>
                    <td>1.13</td>
                  </tr>
                  <tr>
                    <th>2</th>
                    <td>buty sportowe 44 granatowy</td>
                    <td>5040.0</td>
                    <td>1.02</td>
                  </tr>
                  <tr>
                    <th>3</th>
                    <td>buty sportowe 45 czarny</td>
                    <td>5040.0</td>
                    <td>1.02</td>
                  </tr>
                  <tr>
                    <th>4</th>
                    <td>buty trzewiki 45 brązowy</td>
                    <td>4940.0</td>
                    <td>1.00</td>
                  </tr>
                  <tr>
                    <th>...</th>
                    <td>...</td>
                    <td>...</td>
                    <td>...</td>
                  </tr>
                  <tr>
                    <th>492</th>
                    <td>skarpetki 41-43 granatowy</td>
                    <td>66.0</td>
                    <td>0.01</td>
                  </tr>
                  <tr>
                    <th>493</th>
                    <td>slipy L biały</td>
                    <td>38.0</td>
                    <td>0.01</td>
                  </tr>
                  <tr>
                    <th>494</th>
                    <td>slipy S czarny</td>
                    <td>38.0</td>
                    <td>0.01</td>
                  </tr>
                  <tr>
                    <th>495</th>
                    <td>T-shirt jeans M bordowa</td>
                    <td>46.0</td>
                    <td>0.01</td>
                  </tr>
                  <tr>
                    <th>496</th>
                    <td>T-shirt polo L biała</td>
                    <td>72.0</td>
                    <td>0.01</td>
                  </tr>
                </tbody>
              </table>



              -------------------------------------------------------
              procentowy udział ................:
              -------------------------------------------------------

              SELECT DISTINCT
                  produkt,
                  SUM(ilość * cena_sprzedaży) OVER(PARTITION BY produkt) AS wartość_produktów,
                  ROUND(SUM(ilość * cena_sprzedaży) OVER(PARTITION BY produkt) / (SELECT SUM(ilość * cena_sprzedaży) FROM v_sprzedaż) * 100, 2) AS proc_udział_w_całej_sprzedaży
              FROM
                  v_sprzedaż;




              <table class="dataframe styled-table">
                <thead>
                  <tr>
                    <th></th>
                    <th>produkt</th>
                    <th>wartość_produktów</th>
                    <th>proc_udział_w_całej_sprzedaży</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <th>0</th>
                    <td>bokserki L biały</td>
                    <td>893.0</td>
                    <td>0.18</td>
                  </tr>
                  <tr>
                    <th>1</th>
                    <td>bokserki L brązowy</td>
                    <td>1128.0</td>
                    <td>0.23</td>
                  </tr>
                  <tr>
                    <th>2</th>
                    <td>bokserki L czarny</td>
                    <td>423.0</td>
                    <td>0.09</td>
                  </tr>
                  <tr>
                    <th>3</th>
                    <td>bokserki L granatowy</td>
                    <td>611.0</td>
                    <td>0.12</td>
                  </tr>
                  <tr>
                    <th>4</th>
                    <td>bokserki M biały</td>
                    <td>423.0</td>
                    <td>0.09</td>
                  </tr>
                  <tr>
                    <th>...</th>
                    <td>...</td>
                    <td>...</td>
                    <td>...</td>
                  </tr>
                  <tr>
                    <th>492</th>
                    <td>torba skórzana  M czarny</td>
                    <td>2136.0</td>
                    <td>0.43</td>
                  </tr>
                  <tr>
                    <th>493</th>
                    <td>torba skórzana  M granatowy</td>
                    <td>1246.0</td>
                    <td>0.25</td>
                  </tr>
                  <tr>
                    <th>494</th>
                    <td>torba skórzana  S brązowy</td>
                    <td>2136.0</td>
                    <td>0.43</td>
                  </tr>
                  <tr>
                    <th>495</th>
                    <td>torba skórzana  S czarny</td>
                    <td>890.0</td>
                    <td>0.18</td>
                  </tr>
                  <tr>
                    <th>496</th>
                    <td>torba skórzana  S granatowy</td>
                    <td>1246.0</td>
                    <td>0.25</td>
                  </tr>
                </tbody>
              </table>



              -------------------------------------------------------
              procentowy udział ilości kategorii:
              -------------------------------------------------------

              SELECT DISTINCT
                  kategoria,
                  SUM(ilość * cena_sprzedaży) OVER(PARTITION BY kategoria) AS wartość_produktów,
                  ROUND(SUM(ilość * cena_sprzedaży) OVER(PARTITION BY kategoria) / (SELECT SUM(ilość * cena_sprzedaży) FROM v_sprzedaż) * 100, 2) AS proc_udział_w_całości
              FROM
                  v_sprzedaż_zamówienia
              ORDER BY
                  proc_udział_w_całości DESC;



              <table class="dataframe styled-table">
                <thead>
                  <tr>
                    <th></th>
                    <th>kategoria</th>
                    <th>wartość_produktów</th>
                    <th>proc_udział_w_całości</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <th>0</th>
                    <td>buty</td>
                    <td>237063.0</td>
                    <td>47.90</td>
                  </tr>
                  <tr>
                    <th>1</th>
                    <td>odzież męska</td>
                    <td>138876.0</td>
                    <td>28.06</td>
                  </tr>
                  <tr>
                    <th>2</th>
                    <td>spodnie</td>
                    <td>60911.0</td>
                    <td>12.31</td>
                  </tr>
                  <tr>
                    <th>3</th>
                    <td>bielizna</td>
                    <td>34420.0</td>
                    <td>6.96</td>
                  </tr>
                  <tr>
                    <th>4</th>
                    <td>galanteria skórzana</td>
                    <td>23611.0</td>
                    <td>4.77</td>
                  </tr>
                </tbody>
              </table>


              -------------------------------------------------------
              procentowy udział ilości podkategorii:
              -------------------------------------------------------

              SELECT DISTINCT
                  podkategoria,
                  SUM(ilość * cena_sprzedaży) OVER(PARTITION BY podkategoria) AS wartość_produktów,
                  ROUND(SUM(ilość * cena_sprzedaży) OVER(PARTITION BY podkategoria) / (SELECT SUM(ilość * cena_sprzedaży) FROM v_sprzedaż) * 100, 2) AS proc_udział_w_całości
              FROM
                  v_sprzedaż_zamówienia
              ORDER BY
                  proc_udział_w_całości DESC;




              <table class="dataframe styled-table">
                <thead>
                  <tr>
                    <th></th>
                    <th>podkategoria</th>
                    <th>wartość_produktów</th>
                    <th>proc_udział_w_całości</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <th>0</th>
                    <td>koszula</td>
                    <td>111162.0</td>
                    <td>22.46</td>
                  </tr>
                  <tr>
                    <th>1</th>
                    <td>buty sportowe</td>
                    <td>59390.0</td>
                    <td>12.00</td>
                  </tr>
                  <tr>
                    <th>2</th>
                    <td>trzewiki</td>
                    <td>54796.0</td>
                    <td>11.07</td>
                  </tr>
                  <tr>
                    <th>3</th>
                    <td>buty wizytowe</td>
                    <td>46560.0</td>
                    <td>9.41</td>
                  </tr>
                  <tr>
                    <th>4</th>
                    <td>półbuty</td>
                    <td>39457.0</td>
                    <td>7.97</td>
                  </tr>
                  <tr>
                    <th>5</th>
                    <td>botki</td>
                    <td>36860.0</td>
                    <td>7.45</td>
                  </tr>
                  <tr>
                    <th>6</th>
                    <td>spodnie jeans</td>
                    <td>33677.0</td>
                    <td>6.81</td>
                  </tr>
                  <tr>
                    <th>7</th>
                    <td>T-shirt</td>
                    <td>27714.0</td>
                    <td>5.60</td>
                  </tr>
                  <tr>
                    <th>8</th>
                    <td>spodnie klasyczne</td>
                    <td>27234.0</td>
                    <td>5.50</td>
                  </tr>
                  <tr>
                    <th>9</th>
                    <td>torby</td>
                    <td>12816.0</td>
                    <td>2.59</td>
                  </tr>
                  <tr>
                    <th>10</th>
                    <td>paski</td>
                    <td>10795.0</td>
                    <td>2.18</td>
                  </tr>
                  <tr>
                    <th>11</th>
                    <td>bokserki</td>
                    <td>10575.0</td>
                    <td>2.14</td>
                  </tr>
                  <tr>
                    <th>12</th>
                    <td>slipy</td>
                    <td>7942.0</td>
                    <td>1.60</td>
                  </tr>
                  <tr>
                    <th>13</th>
                    <td>podkoszulki</td>
                    <td>7560.0</td>
                    <td>1.53</td>
                  </tr>
                  <tr>
                    <th>14</th>
                    <td>kąpielówki</td>
                    <td>5615.0</td>
                    <td>1.13</td>
                  </tr>
                  <tr>
                    <th>15</th>
                    <td>skarpetki</td>
                    <td>2728.0</td>
                    <td>0.55</td>
                  </tr>
                </tbody>
              </table>



              -------------------------------------------------------
              procentowy udział ilości produktów:
              -------------------------------------------------------

              SELECT DISTINCT
                  produkt,
                  SUM(ilość) OVER(PARTITION BY produkt) AS wartość_produktów,
                  SUM(ilość) OVER(PARTITION BY produkt) / (SELECT SUM(ilość) FROM v_sprzedaż_zamówienia) * 100 AS proc_udział_w_całości
              FROM
                  v_sprzedaż
              ORDER BY
                  proc_udział_w_całości DESC;





              <table class="dataframe styled-table">
                <thead>
                  <tr>
                    <th></th>
                    <th>produkt</th>
                    <th>wartość_produktów</th>
                    <th>proc_udział_w_całości</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <th>0</th>
                    <td>koszula długi rękaw w kratkę XXL czarna</td>
                    <td>27.0</td>
                    <td>0.5351</td>
                  </tr>
                  <tr>
                    <th>1</th>
                    <td>koszula długi rękaw w kratkę L biała</td>
                    <td>26.0</td>
                    <td>0.5153</td>
                  </tr>
                  <tr>
                    <th>2</th>
                    <td>buty półbuty 41 czarny</td>
                    <td>25.0</td>
                    <td>0.4954</td>
                  </tr>
                  <tr>
                    <th>3</th>
                    <td>spodnie jeans XL czarny</td>
                    <td>25.0</td>
                    <td>0.4954</td>
                  </tr>
                  <tr>
                    <th>4</th>
                    <td>bokserki L brązowy</td>
                    <td>24.0</td>
                    <td>0.4756</td>
                  </tr>
                  <tr>
                    <th>...</th>
                    <td>...</td>
                    <td>...</td>
                    <td>...</td>
                  </tr>
                  <tr>
                    <th>492</th>
                    <td>slipy L biały</td>
                    <td>1.0</td>
                    <td>0.0198</td>
                  </tr>
                  <tr>
                    <th>493</th>
                    <td>slipy S czarny</td>
                    <td>1.0</td>
                    <td>0.0198</td>
                  </tr>
                  <tr>
                    <th>494</th>
                    <td>spodnie jeans L brązowy</td>
                    <td>1.0</td>
                    <td>0.0198</td>
                  </tr>
                  <tr>
                    <th>495</th>
                    <td>T-shirt jeans M bordowa</td>
                    <td>1.0</td>
                    <td>0.0198</td>
                  </tr>
                  <tr>
                    <th>496</th>
                    <td>torba skórzana  L granatowy</td>
                    <td>1.0</td>
                    <td>0.0198</td>
                  </tr>
                </tbody>
              </table>


              -------------------------------------------------------
              procentowy udział ilości kategorii:
              -------------------------------------------------------

              SELECT DISTINCT
                  kategoria,
                  SUM(ilość) OVER(PARTITION BY kategoria) AS wartość_produktów,
                  ROUND(SUM(ilość) OVER(PARTITION BY kategoria) / (SELECT SUM(ilość) FROM v_sprzedaż_zamówienia) * 100, 2) AS proc_udział_w_całości
              FROM
                  v_sprzedaż_zamówienia
              ORDER BY
                  proc_udział_w_całości DESC;


              <table class="dataframe styled-table">
                <thead>
                  <tr>
                    <th></th>
                    <th>kategoria</th>
                    <th>wartość_produktów</th>
                    <th>proc_udział_w_całości</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <th>0</th>
                    <td>odzież męska</td>
                    <td>2225.0</td>
                    <td>44.09</td>
                  </tr>
                  <tr>
                    <th>1</th>
                    <td>buty</td>
                    <td>1027.0</td>
                    <td>20.35</td>
                  </tr>
                  <tr>
                    <th>2</th>
                    <td>bielizna</td>
                    <td>958.0</td>
                    <td>18.99</td>
                  </tr>
                  <tr>
                    <th>3</th>
                    <td>spodnie</td>
                    <td>589.0</td>
                    <td>11.67</td>
                  </tr>
                  <tr>
                    <th>4</th>
                    <td>galanteria skórzana</td>
                    <td>247.0</td>
                    <td>4.89</td>
                  </tr>
                </tbody>
              </table>


              -------------------------------------------------------
              procentowy udział ilości podkategorii:
              -------------------------------------------------------

              SELECT DISTINCT
                  podkategoria,
                  SUM(ilość) OVER(PARTITION BY podkategoria) AS wartość_produktów,
                  ROUND(SUM(ilość) OVER(PARTITION BY podkategoria) / (SELECT SUM(ilość) FROM v_sprzedaż_zamówienia) * 100, 2) AS proc_udział_w_całości
              FROM
                  v_sprzedaż_zamówienia
              ORDER BY
                  proc_udział_w_całości DESC;




              <table class="dataframe styled-table">
                <thead>
                  <tr>
                    <th></th>
                    <th>podkategoria</th>
                    <th>wartość_produktów</th>
                    <th>proc_udział_w_całości</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <th>0</th>
                    <td>koszula</td>
                    <td>1542.0</td>
                    <td>30.56</td>
                  </tr>
                  <tr>
                    <th>1</th>
                    <td>T-shirt</td>
                    <td>683.0</td>
                    <td>13.54</td>
                  </tr>
                  <tr>
                    <th>2</th>
                    <td>spodnie klasyczne</td>
                    <td>306.0</td>
                    <td>6.06</td>
                  </tr>
                  <tr>
                    <th>3</th>
                    <td>spodnie jeans</td>
                    <td>283.0</td>
                    <td>5.61</td>
                  </tr>
                  <tr>
                    <th>4</th>
                    <td>bokserki</td>
                    <td>225.0</td>
                    <td>4.46</td>
                  </tr>
                  <tr>
                    <th>5</th>
                    <td>buty sportowe</td>
                    <td>215.0</td>
                    <td>4.26</td>
                  </tr>
                  <tr>
                    <th>6</th>
                    <td>trzewiki</td>
                    <td>213.0</td>
                    <td>4.22</td>
                  </tr>
                  <tr>
                    <th>7</th>
                    <td>półbuty</td>
                    <td>211.0</td>
                    <td>4.18</td>
                  </tr>
                  <tr>
                    <th>8</th>
                    <td>podkoszulki</td>
                    <td>210.0</td>
                    <td>4.16</td>
                  </tr>
                  <tr>
                    <th>9</th>
                    <td>slipy</td>
                    <td>209.0</td>
                    <td>4.14</td>
                  </tr>
                  <tr>
                    <th>10</th>
                    <td>botki</td>
                    <td>194.0</td>
                    <td>3.84</td>
                  </tr>
                  <tr>
                    <th>11</th>
                    <td>buty wizytowe</td>
                    <td>194.0</td>
                    <td>3.84</td>
                  </tr>
                  <tr>
                    <th>12</th>
                    <td>kąpielówki</td>
                    <td>190.0</td>
                    <td>3.77</td>
                  </tr>
                  <tr>
                    <th>13</th>
                    <td>paski</td>
                    <td>175.0</td>
                    <td>3.47</td>
                  </tr>
                  <tr>
                    <th>14</th>
                    <td>skarpetki</td>
                    <td>124.0</td>
                    <td>2.46</td>
                  </tr>
                  <tr>
                    <th>15</th>
                    <td>torby</td>
                    <td>72.0</td>
                    <td>1.43</td>
                  </tr>
                </tbody>
              </table>


              -------------------------------------------------------
              sprzedaż wg kwartałów ogółem:
              -------------------------------------------------------

              SELECT DISTINCT
                  QUARTER(data_wysyłki) AS kwartał,
                  SUM(ilość) OVER (PARTITION BY QUARTER(data_wysyłki)) AS liczba_produktów,
                  SUM(ilość * cena_sprzedaży) OVER (PARTITION BY QUARTER(data_wysyłki)) AS wartość_produktów
              FROM
                  v_sprzedaż_zamówienia
              ORDER BY
                  kwartał;




              <table class="dataframe styled-table">
                <thead>
                  <tr>
                    <th></th>
                    <th>kwartał</th>
                    <th>liczba_produktów</th>
                    <th>wartość_produktów</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <th>0</th>
                    <td>1</td>
                    <td>1218.0</td>
                    <td>116628.0</td>
                  </tr>
                  <tr>
                    <th>1</th>
                    <td>2</td>
                    <td>1272.0</td>
                    <td>125949.0</td>
                  </tr>
                  <tr>
                    <th>2</th>
                    <td>3</td>
                    <td>1435.0</td>
                    <td>140495.0</td>
                  </tr>
                  <tr>
                    <th>3</th>
                    <td>4</td>
                    <td>1121.0</td>
                    <td>111809.0</td>
                  </tr>
                </tbody>
              </table>



              -------------------------------------------------------
              sprzedaż wg produktów i kwartałów:
              -------------------------------------------------------

              SELECT DISTINCT
                  QUARTER(data_wysyłki) AS kwartał,
                  produkt,
                  SUM(ilość) OVER (PARTITION BY QUARTER(data_wysyłki), produkt) AS liczba_produktów,
                  SUM(ilość * cena_sprzedaży) OVER (PARTITION BY QUARTER(data_wysyłki), produkt) AS wartość_produktów
              FROM
                  v_sprzedaż_zamówienia
              ORDER BY
                  kwartał, produkt;



              <table class="dataframe styled-table">
                <thead>
                  <tr>
                    <th></th>
                    <th>kwartał</th>
                    <th>produkt</th>
                    <th>liczba_produktów</th>
                    <th>wartość_produktów</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <th>0</th>
                    <td>1</td>
                    <td>bokserki L biały</td>
                    <td>2.0</td>
                    <td>94.0</td>
                  </tr>
                  <tr>
                    <th>1</th>
                    <td>1</td>
                    <td>bokserki L granatowy</td>
                    <td>4.0</td>
                    <td>188.0</td>
                  </tr>
                  <tr>
                    <th>2</th>
                    <td>1</td>
                    <td>bokserki M biały</td>
                    <td>2.0</td>
                    <td>94.0</td>
                  </tr>
                  <tr>
                    <th>3</th>
                    <td>1</td>
                    <td>bokserki M brązowy</td>
                    <td>8.0</td>
                    <td>376.0</td>
                  </tr>
                  <tr>
                    <th>4</th>
                    <td>1</td>
                    <td>bokserki M czarny</td>
                    <td>4.0</td>
                    <td>188.0</td>
                  </tr>
                  <tr>
                    <th>...</th>
                    <td>...</td>
                    <td>...</td>
                    <td>...</td>
                    <td>...</td>
                  </tr>
                  <tr>
                    <th>1438</th>
                    <td>4</td>
                    <td>torba skórzana  L brązowy</td>
                    <td>3.0</td>
                    <td>534.0</td>
                  </tr>
                  <tr>
                    <th>1439</th>
                    <td>4</td>
                    <td>torba skórzana  L czarny</td>
                    <td>1.0</td>
                    <td>178.0</td>
                  </tr>
                  <tr>
                    <th>1440</th>
                    <td>4</td>
                    <td>torba skórzana  L granatowy</td>
                    <td>1.0</td>
                    <td>178.0</td>
                  </tr>
                  <tr>
                    <th>1441</th>
                    <td>4</td>
                    <td>torba skórzana  M czarny</td>
                    <td>4.0</td>
                    <td>712.0</td>
                  </tr>
                  <tr>
                    <th>1442</th>
                    <td>4</td>
                    <td>torba skórzana  S brązowy</td>
                    <td>4.0</td>
                    <td>712.0</td>
                  </tr>
                </tbody>
              </table>



              -------------------------------------------------------
              sprzedaż wg podkategorii i kwartałów:
              -------------------------------------------------------


              SELECT DISTINCT
                  QUARTER(data_wysyłki) AS kwartał,
                  kategoria,
                  podkategoria,
                  SUM(ilość) OVER (PARTITION BY QUARTER(data_wysyłki), kategoria, podkategoria) AS liczba_produktów,
                  SUM(ilość * cena_sprzedaży) OVER (PARTITION BY QUARTER(data_wysyłki), kategoria, podkategoria) AS wartość_produktów
              FROM
                  v_sprzedaż_zamówienia
              ORDER BY
                  kwartał, kategoria, podkategoria;




              <table class="dataframe styled-table">
                <thead>
                  <tr>
                    <th></th>
                    <th>kwartał</th>
                    <th>kategoria</th>
                    <th>podkategoria</th>
                    <th>liczba_produktów</th>
                    <th>wartość_produktów</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <th>0</th>
                    <td>1</td>
                    <td>bielizna</td>
                    <td>bokserki</td>
                    <td>62.0</td>
                    <td>2914.0</td>
                  </tr>
                  <tr>
                    <th>1</th>
                    <td>1</td>
                    <td>bielizna</td>
                    <td>kąpielówki</td>
                    <td>42.0</td>
                    <td>1239.0</td>
                  </tr>
                  <tr>
                    <th>2</th>
                    <td>1</td>
                    <td>bielizna</td>
                    <td>podkoszulki</td>
                    <td>55.0</td>
                    <td>1980.0</td>
                  </tr>
                  <tr>
                    <th>3</th>
                    <td>1</td>
                    <td>bielizna</td>
                    <td>skarpetki</td>
                    <td>24.0</td>
                    <td>528.0</td>
                  </tr>
                  <tr>
                    <th>4</th>
                    <td>1</td>
                    <td>bielizna</td>
                    <td>slipy</td>
                    <td>58.0</td>
                    <td>2204.0</td>
                  </tr>
                  <tr>
                    <th>...</th>
                    <td>...</td>
                    <td>...</td>
                    <td>...</td>
                    <td>...</td>
                    <td>...</td>
                  </tr>
                  <tr>
                    <th>59</th>
                    <td>4</td>
                    <td>galanteria skórzana</td>
                    <td>torby</td>
                    <td>13.0</td>
                    <td>2314.0</td>
                  </tr>
                  <tr>
                    <th>60</th>
                    <td>4</td>
                    <td>odzież męska</td>
                    <td>koszula</td>
                    <td>361.0</td>
                    <td>26115.0</td>
                  </tr>
                  <tr>
                    <th>61</th>
                    <td>4</td>
                    <td>odzież męska</td>
                    <td>T-shirt</td>
                    <td>137.0</td>
                    <td>5598.0</td>
                  </tr>
                  <tr>
                    <th>62</th>
                    <td>4</td>
                    <td>spodnie</td>
                    <td>spodnie jeans</td>
                    <td>84.0</td>
                    <td>9996.0</td>
                  </tr>
                  <tr>
                    <th>63</th>
                    <td>4</td>
                    <td>spodnie</td>
                    <td>spodnie klasyczne</td>
                    <td>57.0</td>
                    <td>5073.0</td>
                  </tr>
                </tbody>
              </table>


              -------------------------------------------------------
              sprzedaż wg kategorii i kwartałów:
              -------------------------------------------------------


              SELECT DISTINCT
                  QUARTER(data_wysyłki) AS kwartał,
                  kategoria,
                  SUM(ilość) OVER (PARTITION BY QUARTER(data_wysyłki), kategoria) AS liczba_produktów,
                  SUM(ilość * cena_sprzedaży) OVER (PARTITION BY QUARTER(data_wysyłki), kategoria) AS wartość_produktów
              FROM
                  v_sprzedaż_zamówienia
              ORDER BY
                  kwartał;




              <table class="dataframe styled-table">
                <thead>
                  <tr>
                    <th></th>
                    <th>kwartał</th>
                    <th>kategoria</th>
                    <th>liczba_produktów</th>
                    <th>wartość_produktów</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <th>0</th>
                    <td>1</td>
                    <td>bielizna</td>
                    <td>241.0</td>
                    <td>8865.0</td>
                  </tr>
                  <tr>
                    <th>1</th>
                    <td>1</td>
                    <td>buty</td>
                    <td>245.0</td>
                    <td>54195.0</td>
                  </tr>
                  <tr>
                    <th>2</th>
                    <td>1</td>
                    <td>galanteria skórzana</td>
                    <td>68.0</td>
                    <td>6450.0</td>
                  </tr>
                  <tr>
                    <th>3</th>
                    <td>1</td>
                    <td>odzież męska</td>
                    <td>520.0</td>
                    <td>32202.0</td>
                  </tr>
                  <tr>
                    <th>4</th>
                    <td>1</td>
                    <td>spodnie</td>
                    <td>144.0</td>
                    <td>14916.0</td>
                  </tr>
                  <tr>
                    <th>5</th>
                    <td>2</td>
                    <td>bielizna</td>
                    <td>233.0</td>
                    <td>8486.0</td>
                  </tr>
                  <tr>
                    <th>6</th>
                    <td>2</td>
                    <td>buty</td>
                    <td>265.0</td>
                    <td>61169.0</td>
                  </tr>
                  <tr>
                    <th>7</th>
                    <td>2</td>
                    <td>galanteria skórzana</td>
                    <td>72.0</td>
                    <td>6993.0</td>
                  </tr>
                  <tr>
                    <th>8</th>
                    <td>2</td>
                    <td>odzież męska</td>
                    <td>573.0</td>
                    <td>35750.0</td>
                  </tr>
                  <tr>
                    <th>9</th>
                    <td>2</td>
                    <td>spodnie</td>
                    <td>129.0</td>
                    <td>13551.0</td>
                  </tr>
                  <tr>
                    <th>10</th>
                    <td>3</td>
                    <td>bielizna</td>
                    <td>280.0</td>
                    <td>9940.0</td>
                  </tr>
                  <tr>
                    <th>11</th>
                    <td>3</td>
                    <td>buty</td>
                    <td>290.0</td>
                    <td>68377.0</td>
                  </tr>
                  <tr>
                    <th>12</th>
                    <td>3</td>
                    <td>galanteria skórzana</td>
                    <td>56.0</td>
                    <td>5592.0</td>
                  </tr>
                  <tr>
                    <th>13</th>
                    <td>3</td>
                    <td>odzież męska</td>
                    <td>634.0</td>
                    <td>39211.0</td>
                  </tr>
                  <tr>
                    <th>14</th>
                    <td>3</td>
                    <td>spodnie</td>
                    <td>175.0</td>
                    <td>17375.0</td>
                  </tr>
                  <tr>
                    <th>15</th>
                    <td>4</td>
                    <td>bielizna</td>
                    <td>204.0</td>
                    <td>7129.0</td>
                  </tr>
                  <tr>
                    <th>16</th>
                    <td>4</td>
                    <td>buty</td>
                    <td>227.0</td>
                    <td>53322.0</td>
                  </tr>
                  <tr>
                    <th>17</th>
                    <td>4</td>
                    <td>galanteria skórzana</td>
                    <td>51.0</td>
                    <td>4576.0</td>
                  </tr>
                  <tr>
                    <th>18</th>
                    <td>4</td>
                    <td>odzież męska</td>
                    <td>498.0</td>
                    <td>31713.0</td>
                  </tr>
                  <tr>
                    <th>19</th>
                    <td>4</td>
                    <td>spodnie</td>
                    <td>141.0</td>
                    <td>15069.0</td>
                  </tr>
                </tbody>
              </table>


              -------------------------------------------------------
              wartośc sprzedaży wg formy dostawy:
              -------------------------------------------------------

              SELECT DISTINCT
                  forma_dostawy,
                  SUM(ilość * cena_sprzedaży) OVER (PARTITION BY forma_dostawy) AS wartość_sprzedaży
              FROM
                  v_sprzedaż_zamówienia
              ORDER BY
                  wartość_sprzedaży DESC;





              <table class="dataframe styled-table">
                <thead>
                  <tr>
                    <th></th>
                    <th>forma_dostawy</th>
                    <th>wartość_sprzedaży</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <th>0</th>
                    <td>paczkomat</td>
                    <td>404661.0</td>
                  </tr>
                  <tr>
                    <th>1</th>
                    <td>poczta</td>
                    <td>32396.0</td>
                  </tr>
                  <tr>
                    <th>2</th>
                    <td>odbiór osobisty</td>
                    <td>30879.0</td>
                  </tr>
                  <tr>
                    <th>3</th>
                    <td>kurier</td>
                    <td>26945.0</td>
                  </tr>
                </tbody>
              </table>


              -------------------------------------------------------
              wartośc sprzedaży wg kanału sprzedaży:
              -------------------------------------------------------


              SELECT DISTINCT
                  kanał_sprzedaz,
                  SUM(ilość * cena_sprzedaży) OVER (PARTITION BY kanał_sprzedaz) AS wartość_sprzedaży
              FROM
                  v_sprzedaż_zamówienia
              ORDER BY
                  wartość_sprzedaży DESC;




              <table class="dataframe styled-table">
                <thead>
                  <tr>
                    <th></th>
                    <th>kanał_sprzedaz</th>
                    <th>wartość_sprzedaży</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <th>0</th>
                    <td>portal aukcyjny</td>
                    <td>250436.0</td>
                  </tr>
                  <tr>
                    <th>1</th>
                    <td>sklep on-line</td>
                    <td>244445.0</td>
                  </tr>
                </tbody>
              </table>



              -------------------------------------------------------
              wartośc sprzedaży wg formy płatności:
              -------------------------------------------------------

              SELECT DISTINCT
                  forma_płatności,
                  SUM(ilość * cena_sprzedaży) OVER (PARTITION BY forma_płatności) AS wartość_sprzedaży
              FROM
                  v_sprzedaż_zamówienia
              ORDER BY
                  wartość_sprzedaży DESC;




              <table class="dataframe styled-table">
                <thead>
                  <tr>
                    <th></th>
                    <th>forma_płatności</th>
                    <th>wartość_sprzedaży</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <th>0</th>
                    <td>e-przelew</td>
                    <td>132356.0</td>
                  </tr>
                  <tr>
                    <th>1</th>
                    <td>karta</td>
                    <td>130284.0</td>
                  </tr>
                  <tr>
                    <th>2</th>
                    <td>gotówka</td>
                    <td>121051.0</td>
                  </tr>
                  <tr>
                    <th>3</th>
                    <td>przelew</td>
                    <td>111190.0</td>
                  </tr>
                </tbody>
              </table>


              -------------------------------------------------------
              wartośc sprzedaży wg miasta dostawy:
              -------------------------------------------------------

              SELECT DISTINCT
                  miasto_dostawy,
                  SUM(ilość * cena_sprzedaży) OVER (PARTITION BY miasto_dostawy) AS wartość_sprzedaży
              FROM
                  v_sprzedaż_zamówienia
              ORDER BY
                  wartość_sprzedaży DESC;




              <table class="dataframe styled-table">
                <thead>
                  <tr>
                    <th></th>
                    <th>miasto_dostawy</th>
                    <th>wartość_sprzedaży</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <th>0</th>
                    <td>Wrocław</td>
                    <td>63743.0</td>
                  </tr>
                  <tr>
                    <th>1</th>
                    <td>Warszawa</td>
                    <td>45776.0</td>
                  </tr>
                  <tr>
                    <th>2</th>
                    <td>Kraków</td>
                    <td>44948.0</td>
                  </tr>
                  <tr>
                    <th>3</th>
                    <td>Gdańsk</td>
                    <td>39644.0</td>
                  </tr>
                  <tr>
                    <th>4</th>
                    <td>Poznań</td>
                    <td>36915.0</td>
                  </tr>
                  <tr>
                    <th>5</th>
                    <td>Bydgoszcz</td>
                    <td>35374.0</td>
                  </tr>
                  <tr>
                    <th>6</th>
                    <td>Kielce</td>
                    <td>33644.0</td>
                  </tr>
                  <tr>
                    <th>7</th>
                    <td>Łódź</td>
                    <td>32550.0</td>
                  </tr>
                  <tr>
                    <th>8</th>
                    <td>Rzeszów</td>
                    <td>28209.0</td>
                  </tr>
                  <tr>
                    <th>9</th>
                    <td>Gorzów Wielkopolski</td>
                    <td>27895.0</td>
                  </tr>
                  <tr>
                    <th>10</th>
                    <td>Białystok</td>
                    <td>27438.0</td>
                  </tr>
                  <tr>
                    <th>11</th>
                    <td>Szczecin</td>
                    <td>22050.0</td>
                  </tr>
                  <tr>
                    <th>12</th>
                    <td>Katowice</td>
                    <td>20697.0</td>
                  </tr>
                  <tr>
                    <th>13</th>
                    <td>Lublin</td>
                    <td>16007.0</td>
                  </tr>
                  <tr>
                    <th>14</th>
                    <td>Opole</td>
                    <td>10882.0</td>
                  </tr>
                  <tr>
                    <th>15</th>
                    <td>Olsztyn</td>
                    <td>9109.0</td>
                  </tr>
                </tbody>
              </table>



              -------------------------------------------------------
              wartośc sprzedaży wg typu klienta:
              -------------------------------------------------------


              SELECT DISTINCT
                  typ_klienta,
                  SUM(ilość) OVER (PARTITION BY typ_klienta) AS wartość_sprzedaży
              FROM
                  v_sprzedaż_zamówienia
              ORDER BY
                  wartość_sprzedaży DESC;



              <table class="dataframe styled-table">
                <thead>
                  <tr>
                    <th></th>
                    <th>typ_klienta</th>
                    <th>wartość_sprzedaży</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <th>0</th>
                    <td>osoba</td>
                    <td>3789.0</td>
                  </tr>
                  <tr>
                    <th>1</th>
                    <td>firma</td>
                    <td>1257.0</td>
                  </tr>
                </tbody>
              </table>



              -------------------------------------------------------
              sprzedaż wg formy dostawy:
              -------------------------------------------------------


              SELECT DISTINCT
                  forma_dostawy,
                  SUM(ilość) OVER (PARTITION BY forma_dostawy) AS liczba_sprzedaży
              FROM
                  v_sprzedaż_zamówienia
              ORDER BY
                  liczba_sprzedaży DESC;




              <table class="dataframe styled-table">
                <thead>
                  <tr>
                    <th></th>
                    <th>forma_dostawy</th>
                    <th>liczba_sprzedaży</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <th>0</th>
                    <td>paczkomat</td>
                    <td>4087.0</td>
                  </tr>
                  <tr>
                    <th>1</th>
                    <td>odbiór osobisty</td>
                    <td>347.0</td>
                  </tr>
                  <tr>
                    <th>2</th>
                    <td>poczta</td>
                    <td>307.0</td>
                  </tr>
                  <tr>
                    <th>3</th>
                    <td>kurier</td>
                    <td>305.0</td>
                  </tr>
                </tbody>
              </table>


              -------------------------------------------------------
              sprzedaż wg kanału sprzedazy:
              -------------------------------------------------------

              SELECT DISTINCT
                  kanał_sprzedaz,
                  SUM(ilość * cena_sprzedaży) OVER (PARTITION BY kanał_sprzedaz) AS wartość_sprzedaży
              FROM
                  v_sprzedaż_zamówienia
              ORDER BY
                  wartość_sprzedaży DESC;




              <table class="dataframe styled-table">
                <thead>
                  <tr>
                    <th></th>
                    <th>kanał_sprzedaz</th>
                    <th>wartość_sprzedaży</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <th>0</th>
                    <td>portal aukcyjny</td>
                    <td>250436.0</td>
                  </tr>
                  <tr>
                    <th>1</th>
                    <td>sklep on-line</td>
                    <td>244445.0</td>
                  </tr>
                </tbody>
              </table>


              -------------------------------------------------------
              sprzedaż wg formy płatności:
              -------------------------------------------------------


              SELECT DISTINCT
                  forma_płatności,
                  SUM(ilość) OVER (PARTITION BY forma_płatności) AS liczba_sprzedaży
              FROM
                  v_sprzedaż_zamówienia
              ORDER BY
                  liczba_sprzedaży DESC;




              <table class="dataframe styled-table">
                <thead>
                  <tr>
                    <th></th>
                    <th>forma_płatności</th>
                    <th>liczba_sprzedaży</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <th>0</th>
                    <td>karta</td>
                    <td>1327.0</td>
                  </tr>
                  <tr>
                    <th>1</th>
                    <td>gotówka</td>
                    <td>1307.0</td>
                  </tr>
                  <tr>
                    <th>2</th>
                    <td>e-przelew</td>
                    <td>1299.0</td>
                  </tr>
                  <tr>
                    <th>3</th>
                    <td>przelew</td>
                    <td>1113.0</td>
                  </tr>
                </tbody>
              </table>



              -------------------------------------------------------
              sprzedaż wg miasta dostawy:
              -------------------------------------------------------

              SELECT DISTINCT
                  miasto_dostawy,
                  SUM(ilość) OVER (PARTITION BY miasto_dostawy) AS liczba_sprzedaży
              FROM
                  v_sprzedaż_zamówienia
              ORDER BY
                  liczba_sprzedaży DESC;


              <table class="dataframe styled-table">
                <thead>
                  <tr>
                    <th></th>
                    <th>miasto_dostawy</th>
                    <th>liczba_sprzedaży</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <th>0</th>
                    <td>Wrocław</td>
                    <td>675.0</td>
                  </tr>
                  <tr>
                    <th>1</th>
                    <td>Warszawa</td>
                    <td>450.0</td>
                  </tr>
                  <tr>
                    <th>2</th>
                    <td>Kraków</td>
                    <td>448.0</td>
                  </tr>
                  <tr>
                    <th>3</th>
                    <td>Bydgoszcz</td>
                    <td>382.0</td>
                  </tr>
                  <tr>
                    <th>4</th>
                    <td>Gdańsk</td>
                    <td>382.0</td>
                  </tr>
                  <tr>
                    <th>5</th>
                    <td>Łódź</td>
                    <td>351.0</td>
                  </tr>
                  <tr>
                    <th>6</th>
                    <td>Poznań</td>
                    <td>350.0</td>
                  </tr>
                  <tr>
                    <th>7</th>
                    <td>Kielce</td>
                    <td>316.0</td>
                  </tr>
                  <tr>
                    <th>8</th>
                    <td>Gorzów Wielkopolski</td>
                    <td>308.0</td>
                  </tr>
                  <tr>
                    <th>9</th>
                    <td>Białystok</td>
                    <td>303.0</td>
                  </tr>
                  <tr>
                    <th>10</th>
                    <td>Rzeszów</td>
                    <td>285.0</td>
                  </tr>
                  <tr>
                    <th>11</th>
                    <td>Szczecin</td>
                    <td>208.0</td>
                  </tr>
                  <tr>
                    <th>12</th>
                    <td>Katowice</td>
                    <td>190.0</td>
                  </tr>
                  <tr>
                    <th>13</th>
                    <td>Lublin</td>
                    <td>177.0</td>
                  </tr>
                  <tr>
                    <th>14</th>
                    <td>Opole</td>
                    <td>143.0</td>
                  </tr>
                  <tr>
                    <th>15</th>
                    <td>Olsztyn</td>
                    <td>78.0</td>
                  </tr>
                </tbody>
              </table>



              -------------------------------------------------------
              sprzedaż wg typu klienta:
              -------------------------------------------------------

              SELECT DISTINCT
                  typ_klienta,
                  SUM(ilość) OVER (PARTITION BY typ_klienta) AS liczba_sprzedaży
              FROM
                  v_sprzedaż_zamówienia
              ORDER BY
                  liczba_sprzedaży DESC;



              <table class="dataframe styled-table">
                <thead>
                  <tr>
                    <th></th>
                    <th>typ_klienta</th>
                    <th>liczba_sprzedaży</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <th>0</th>
                    <td>osoba</td>
                    <td>3789.0</td>
                  </tr>
                  <tr>
                    <th>1</th>
                    <td>firma</td>
                    <td>1257.0</td>
                  </tr>
                </tbody>
              </table>




              -------------------------------------------------------
              kategorie wg koloru - ilosci - tabela przestawna:
              -------------------------------------------------------

              SELECT
                  kategoria,
                  SUM(CASE WHEN kolor = &#39;biały&#39; THEN ilość ELSE 0 END) AS &#39;biały&#39;,
                  SUM(CASE WHEN kolor = &#39;bordowy&#39; THEN ilość ELSE 0 END) AS &#39;bordowy&#39;,
                  SUM(CASE WHEN kolor = &#39;brązowy&#39; THEN ilość ELSE 0 END) AS &#39;brązowy&#39;,
                  SUM(CASE WHEN kolor = &#39;czarny&#39; THEN ilość ELSE 0 END) AS &#39;czarny&#39;,
                  SUM(CASE WHEN kolor = &#39;granatowy&#39; THEN ilość ELSE 0 END) AS &#39;granatowy&#39;,
                  SUM(CASE WHEN kolor = &#39;niebieski&#39; THEN ilość ELSE 0 END) AS &#39;niebieski&#39;,
                  SUM(CASE WHEN kolor = &#39;popiel&#39; THEN ilość ELSE 0 END) AS &#39;popielaty&#39;,
                  SUM(CASE WHEN kolor = &#39;zielony&#39; THEN ilość ELSE 0 END) AS &#39;zielony&#39;
              FROM
                  v_sprzedaż_zamówienia
              GROUP BY
                  kategoria;




              <table class="dataframe styled-table">
                <thead>
                  <tr>
                    <th></th>
                    <th>kategoria</th>
                    <th>biały</th>
                    <th>bordowy</th>
                    <th>brązowy</th>
                    <th>czarny</th>
                    <th>granatowy</th>
                    <th>niebieski</th>
                    <th>popielaty</th>
                    <th>zielony</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <th>0</th>
                    <td>odzież męska</td>
                    <td>417.0</td>
                    <td>429.0</td>
                    <td>0.0</td>
                    <td>469.0</td>
                    <td>483.0</td>
                    <td>0.0</td>
                    <td>0.0</td>
                    <td>427.0</td>
                  </tr>
                  <tr>
                    <th>1</th>
                    <td>buty</td>
                    <td>44.0</td>
                    <td>0.0</td>
                    <td>297.0</td>
                    <td>381.0</td>
                    <td>305.0</td>
                    <td>0.0</td>
                    <td>0.0</td>
                    <td>0.0</td>
                  </tr>
                  <tr>
                    <th>2</th>
                    <td>bielizna</td>
                    <td>246.0</td>
                    <td>0.0</td>
                    <td>248.0</td>
                    <td>239.0</td>
                    <td>225.0</td>
                    <td>0.0</td>
                    <td>0.0</td>
                    <td>0.0</td>
                  </tr>
                  <tr>
                    <th>3</th>
                    <td>spodnie</td>
                    <td>0.0</td>
                    <td>0.0</td>
                    <td>99.0</td>
                    <td>135.0</td>
                    <td>113.0</td>
                    <td>104.0</td>
                    <td>138.0</td>
                    <td>0.0</td>
                  </tr>
                  <tr>
                    <th>4</th>
                    <td>galanteria skórzana</td>
                    <td>0.0</td>
                    <td>0.0</td>
                    <td>95.0</td>
                    <td>82.0</td>
                    <td>70.0</td>
                    <td>0.0</td>
                    <td>0.0</td>
                    <td>0.0</td>
                  </tr>
                </tbody>
              </table>


              -------------------------------------------------------
              wartośc sprzedaży wg podkategori i kwartałów:
              -------------------------------------------------------

              -- Suma wartości sprzedaży produktów wg podkategorii i kwartału
              SELECT
                  podkategoria,
                  SUM(CASE WHEN QUARTER(data_wysyłki) = 1 THEN ilość * cena_sprzedaży ELSE 0 END) AS &#34;Q1&#34;,
                  SUM(CASE WHEN QUARTER(data_wysyłki) = 2 THEN ilość * cena_sprzedaży ELSE 0 END) AS &#34;Q2&#34;,
                  SUM(CASE WHEN QUARTER(data_wysyłki) = 3 THEN ilość * cena_sprzedaży ELSE 0 END) AS &#34;Q3&#34;,
                  SUM(CASE WHEN QUARTER(data_wysyłki) = 4 THEN ilość * cena_sprzedaży ELSE 0 END) AS &#34;Q4&#34;
              FROM
                  v_sprzedaż_zamówienia
              GROUP BY
                  podkategoria;




              <table class="dataframe styled-table">
                <thead>
                  <tr>
                    <th></th>
                    <th>podkategoria</th>
                    <th>Q1</th>
                    <th>Q2</th>
                    <th>Q3</th>
                    <th>Q4</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <th>0</th>
                    <td>koszula</td>
                    <td>25656.0</td>
                    <td>28962.0</td>
                    <td>30429.0</td>
                    <td>26115.0</td>
                  </tr>
                  <tr>
                    <th>1</th>
                    <td>buty wizytowe</td>
                    <td>9120.0</td>
                    <td>12000.0</td>
                    <td>16560.0</td>
                    <td>8880.0</td>
                  </tr>
                  <tr>
                    <th>2</th>
                    <td>botki</td>
                    <td>9880.0</td>
                    <td>9500.0</td>
                    <td>8740.0</td>
                    <td>8740.0</td>
                  </tr>
                  <tr>
                    <th>3</th>
                    <td>trzewiki</td>
                    <td>11075.0</td>
                    <td>12854.0</td>
                    <td>15527.0</td>
                    <td>15340.0</td>
                  </tr>
                  <tr>
                    <th>4</th>
                    <td>slipy</td>
                    <td>2204.0</td>
                    <td>2356.0</td>
                    <td>2052.0</td>
                    <td>1330.0</td>
                  </tr>
                  <tr>
                    <th>5</th>
                    <td>spodnie klasyczne</td>
                    <td>6586.0</td>
                    <td>5340.0</td>
                    <td>10235.0</td>
                    <td>5073.0</td>
                  </tr>
                  <tr>
                    <th>6</th>
                    <td>spodnie jeans</td>
                    <td>8330.0</td>
                    <td>8211.0</td>
                    <td>7140.0</td>
                    <td>9996.0</td>
                  </tr>
                  <tr>
                    <th>7</th>
                    <td>kąpielówki</td>
                    <td>1239.0</td>
                    <td>1477.0</td>
                    <td>1768.0</td>
                    <td>1131.0</td>
                  </tr>
                  <tr>
                    <th>8</th>
                    <td>bokserki</td>
                    <td>2914.0</td>
                    <td>2491.0</td>
                    <td>3008.0</td>
                    <td>2162.0</td>
                  </tr>
                  <tr>
                    <th>9</th>
                    <td>podkoszulki</td>
                    <td>1980.0</td>
                    <td>1656.0</td>
                    <td>2232.0</td>
                    <td>1692.0</td>
                  </tr>
                  <tr>
                    <th>10</th>
                    <td>paski</td>
                    <td>3246.0</td>
                    <td>2899.0</td>
                    <td>2388.0</td>
                    <td>2262.0</td>
                  </tr>
                  <tr>
                    <th>11</th>
                    <td>buty sportowe</td>
                    <td>11030.0</td>
                    <td>16530.0</td>
                    <td>18200.0</td>
                    <td>13630.0</td>
                  </tr>
                  <tr>
                    <th>12</th>
                    <td>T-shirt</td>
                    <td>6546.0</td>
                    <td>6788.0</td>
                    <td>8782.0</td>
                    <td>5598.0</td>
                  </tr>
                  <tr>
                    <th>13</th>
                    <td>półbuty</td>
                    <td>13090.0</td>
                    <td>10285.0</td>
                    <td>9350.0</td>
                    <td>6732.0</td>
                  </tr>
                  <tr>
                    <th>14</th>
                    <td>skarpetki</td>
                    <td>528.0</td>
                    <td>506.0</td>
                    <td>880.0</td>
                    <td>814.0</td>
                  </tr>
                  <tr>
                    <th>15</th>
                    <td>torby</td>
                    <td>3204.0</td>
                    <td>4094.0</td>
                    <td>3204.0</td>
                    <td>2314.0</td>
                  </tr>
                </tbody>
              </table>


              -------------------------------------------------------
              Suma wartości sprzedaży produktów wg podkategorii i koloru:
              -------------------------------------------------------


              SELECT
                  podkategoria,
                  SUM(CASE WHEN kolor = &#39;biały&#39; THEN ilość * cena_sprzedaży ELSE 0 END) AS &#34;biały&#34;,
                  SUM(CASE WHEN kolor = &#39;bordowy&#39; THEN ilość * cena_sprzedaży ELSE 0 END) AS &#34;bordowy&#34;,
                  SUM(CASE WHEN kolor = &#39;brązowy&#39; THEN ilość * cena_sprzedaży ELSE 0 END) AS &#34;brązowy&#34;,
                  SUM(CASE WHEN kolor = &#39;czarny&#39; THEN ilość * cena_sprzedaży ELSE 0 END) AS &#34;czarny&#34;,
                  SUM(CASE WHEN kolor = &#39;granatowy&#39; THEN ilość * cena_sprzedaży ELSE 0 END) AS &#34;granatowy&#34;,
                  SUM(CASE WHEN kolor = &#39;niebieski&#39; THEN ilość * cena_sprzedaży ELSE 0 END) AS &#34;niebieski&#34;,
                  SUM(CASE WHEN kolor = &#39;popiel&#39; THEN ilość * cena_sprzedaży ELSE 0 END) AS &#34;popielaty&#34;,
                  SUM(CASE WHEN kolor = &#39;zielony&#39; THEN ilość * cena_sprzedaży ELSE 0 END) AS &#34;zielony&#34;
              FROM
                  v_sprzedaż_zamówienia
              GROUP BY
                  podkategoria;



              <table class="dataframe styled-table">
                <thead>
                  <tr>
                    <th></th>
                    <th>podkategoria</th>
                    <th>biały</th>
                    <th>bordowy</th>
                    <th>brązowy</th>
                    <th>czarny</th>
                    <th>granatowy</th>
                    <th>niebieski</th>
                    <th>popielaty</th>
                    <th>zielony</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <th>0</th>
                    <td>koszula</td>
                    <td>19980.0</td>
                    <td>22539.0</td>
                    <td>0.0</td>
                    <td>24834.0</td>
                    <td>23892.0</td>
                    <td>0.0</td>
                    <td>0.0</td>
                    <td>19917.0</td>
                  </tr>
                  <tr>
                    <th>1</th>
                    <td>buty wizytowe</td>
                    <td>0.0</td>
                    <td>0.0</td>
                    <td>16080.0</td>
                    <td>16320.0</td>
                    <td>14160.0</td>
                    <td>0.0</td>
                    <td>0.0</td>
                    <td>0.0</td>
                  </tr>
                  <tr>
                    <th>2</th>
                    <td>botki</td>
                    <td>0.0</td>
                    <td>0.0</td>
                    <td>13300.0</td>
                    <td>10450.0</td>
                    <td>13110.0</td>
                    <td>0.0</td>
                    <td>0.0</td>
                    <td>0.0</td>
                  </tr>
                  <tr>
                    <th>3</th>
                    <td>trzewiki</td>
                    <td>0.0</td>
                    <td>0.0</td>
                    <td>16900.0</td>
                    <td>21776.0</td>
                    <td>16120.0</td>
                    <td>0.0</td>
                    <td>0.0</td>
                    <td>0.0</td>
                  </tr>
                  <tr>
                    <th>4</th>
                    <td>slipy</td>
                    <td>1216.0</td>
                    <td>0.0</td>
                    <td>1786.0</td>
                    <td>2546.0</td>
                    <td>2394.0</td>
                    <td>0.0</td>
                    <td>0.0</td>
                    <td>0.0</td>
                  </tr>
                  <tr>
                    <th>5</th>
                    <td>spodnie klasyczne</td>
                    <td>0.0</td>
                    <td>0.0</td>
                    <td>4806.0</td>
                    <td>5696.0</td>
                    <td>5251.0</td>
                    <td>5785.0</td>
                    <td>5696.0</td>
                    <td>0.0</td>
                  </tr>
                  <tr>
                    <th>6</th>
                    <td>spodnie jeans</td>
                    <td>0.0</td>
                    <td>0.0</td>
                    <td>5355.0</td>
                    <td>8449.0</td>
                    <td>6426.0</td>
                    <td>4641.0</td>
                    <td>8806.0</td>
                    <td>0.0</td>
                  </tr>
                  <tr>
                    <th>7</th>
                    <td>kąpielówki</td>
                    <td>1642.0</td>
                    <td>0.0</td>
                    <td>1189.0</td>
                    <td>1508.0</td>
                    <td>1276.0</td>
                    <td>0.0</td>
                    <td>0.0</td>
                    <td>0.0</td>
                  </tr>
                  <tr>
                    <th>8</th>
                    <td>bokserki</td>
                    <td>3478.0</td>
                    <td>0.0</td>
                    <td>3196.0</td>
                    <td>2115.0</td>
                    <td>1786.0</td>
                    <td>0.0</td>
                    <td>0.0</td>
                    <td>0.0</td>
                  </tr>
                  <tr>
                    <th>9</th>
                    <td>podkoszulki</td>
                    <td>1728.0</td>
                    <td>0.0</td>
                    <td>2196.0</td>
                    <td>1656.0</td>
                    <td>1980.0</td>
                    <td>0.0</td>
                    <td>0.0</td>
                    <td>0.0</td>
                  </tr>
                  <tr>
                    <th>10</th>
                    <td>paski</td>
                    <td>0.0</td>
                    <td>0.0</td>
                    <td>3681.0</td>
                    <td>3913.0</td>
                    <td>3201.0</td>
                    <td>0.0</td>
                    <td>0.0</td>
                    <td>0.0</td>
                  </tr>
                  <tr>
                    <th>11</th>
                    <td>buty sportowe</td>
                    <td>12320.0</td>
                    <td>0.0</td>
                    <td>3920.0</td>
                    <td>28310.0</td>
                    <td>14840.0</td>
                    <td>0.0</td>
                    <td>0.0</td>
                    <td>0.0</td>
                  </tr>
                  <tr>
                    <th>12</th>
                    <td>T-shirt</td>
                    <td>5762.0</td>
                    <td>4646.0</td>
                    <td>0.0</td>
                    <td>5072.0</td>
                    <td>6060.0</td>
                    <td>0.0</td>
                    <td>0.0</td>
                    <td>6174.0</td>
                  </tr>
                  <tr>
                    <th>13</th>
                    <td>półbuty</td>
                    <td>0.0</td>
                    <td>0.0</td>
                    <td>15147.0</td>
                    <td>12716.0</td>
                    <td>11594.0</td>
                    <td>0.0</td>
                    <td>0.0</td>
                    <td>0.0</td>
                  </tr>
                  <tr>
                    <th>14</th>
                    <td>skarpetki</td>
                    <td>858.0</td>
                    <td>0.0</td>
                    <td>682.0</td>
                    <td>638.0</td>
                    <td>550.0</td>
                    <td>0.0</td>
                    <td>0.0</td>
                    <td>0.0</td>
                  </tr>
                  <tr>
                    <th>15</th>
                    <td>torby</td>
                    <td>0.0</td>
                    <td>0.0</td>
                    <td>6408.0</td>
                    <td>3738.0</td>
                    <td>2670.0</td>
                    <td>0.0</td>
                    <td>0.0</td>
                    <td>0.0</td>
                  </tr>
                </tbody>
              </table>



              -------------------------------------------------------
              sumy częsciowe wg kategorii i podkategorii - ilosci i wartości:
              -------------------------------------------------------

              SELECT
                  IF(GROUPING(kategoria) = 1, &#39;RAZEM KATEGORIE&#39;, kategoria) AS Kategoria,
                  IF(GROUPING(podkategoria) = 1, &#39;suma podkategorii&#39;, podkategoria) AS podkategoria,
                  SUM(ilość) AS ILOŚĆ,
                  SUM(ilość * cena_sprzedaży) AS WARTOŚĆ
              FROM
                  v_sprzedaż_zamówienia
              GROUP BY
                  kategoria, podkategoria WITH ROLLUP;



              <table class="dataframe styled-table">
                <thead>
                  <tr>
                    <th></th>
                    <th>Kategoria</th>
                    <th>podkategoria</th>
                    <th>ILOŚĆ</th>
                    <th>WARTOŚĆ</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <th>0</th>
                    <td>bielizna</td>
                    <td>bokserki</td>
                    <td>225.0</td>
                    <td>10575.0</td>
                  </tr>
                  <tr>
                    <th>1</th>
                    <td>bielizna</td>
                    <td>kąpielówki</td>
                    <td>190.0</td>
                    <td>5615.0</td>
                  </tr>
                  <tr>
                    <th>2</th>
                    <td>bielizna</td>
                    <td>podkoszulki</td>
                    <td>210.0</td>
                    <td>7560.0</td>
                  </tr>
                  <tr>
                    <th>3</th>
                    <td>bielizna</td>
                    <td>skarpetki</td>
                    <td>124.0</td>
                    <td>2728.0</td>
                  </tr>
                  <tr>
                    <th>4</th>
                    <td>bielizna</td>
                    <td>slipy</td>
                    <td>209.0</td>
                    <td>7942.0</td>
                  </tr>
                  <tr>
                    <th>5</th>
                    <td>bielizna</td>
                    <td>suma podkategorii</td>
                    <td>958.0</td>
                    <td>34420.0</td>
                  </tr>
                  <tr>
                    <th>6</th>
                    <td>buty</td>
                    <td>botki</td>
                    <td>194.0</td>
                    <td>36860.0</td>
                  </tr>
                  <tr>
                    <th>7</th>
                    <td>buty</td>
                    <td>buty sportowe</td>
                    <td>215.0</td>
                    <td>59390.0</td>
                  </tr>
                  <tr>
                    <th>8</th>
                    <td>buty</td>
                    <td>buty wizytowe</td>
                    <td>194.0</td>
                    <td>46560.0</td>
                  </tr>
                  <tr>
                    <th>9</th>
                    <td>buty</td>
                    <td>półbuty</td>
                    <td>211.0</td>
                    <td>39457.0</td>
                  </tr>
                  <tr>
                    <th>10</th>
                    <td>buty</td>
                    <td>trzewiki</td>
                    <td>213.0</td>
                    <td>54796.0</td>
                  </tr>
                  <tr>
                    <th>11</th>
                    <td>buty</td>
                    <td>suma podkategorii</td>
                    <td>1027.0</td>
                    <td>237063.0</td>
                  </tr>
                  <tr>
                    <th>12</th>
                    <td>galanteria skórzana</td>
                    <td>paski</td>
                    <td>175.0</td>
                    <td>10795.0</td>
                  </tr>
                  <tr>
                    <th>13</th>
                    <td>galanteria skórzana</td>
                    <td>torby</td>
                    <td>72.0</td>
                    <td>12816.0</td>
                  </tr>
                  <tr>
                    <th>14</th>
                    <td>galanteria skórzana</td>
                    <td>suma podkategorii</td>
                    <td>247.0</td>
                    <td>23611.0</td>
                  </tr>
                  <tr>
                    <th>15</th>
                    <td>odzież męska</td>
                    <td>koszula</td>
                    <td>1542.0</td>
                    <td>111162.0</td>
                  </tr>
                  <tr>
                    <th>16</th>
                    <td>odzież męska</td>
                    <td>T-shirt</td>
                    <td>683.0</td>
                    <td>27714.0</td>
                  </tr>
                  <tr>
                    <th>17</th>
                    <td>odzież męska</td>
                    <td>suma podkategorii</td>
                    <td>2225.0</td>
                    <td>138876.0</td>
                  </tr>
                  <tr>
                    <th>18</th>
                    <td>spodnie</td>
                    <td>spodnie jeans</td>
                    <td>283.0</td>
                    <td>33677.0</td>
                  </tr>
                  <tr>
                    <th>19</th>
                    <td>spodnie</td>
                    <td>spodnie klasyczne</td>
                    <td>306.0</td>
                    <td>27234.0</td>
                  </tr>
                  <tr>
                    <th>20</th>
                    <td>spodnie</td>
                    <td>suma podkategorii</td>
                    <td>589.0</td>
                    <td>60911.0</td>
                  </tr>
                  <tr>
                    <th>21</th>
                    <td>RAZEM KATEGORIE</td>
                    <td>suma podkategorii</td>
                    <td>5046.0</td>
                    <td>494881.0</td>
                  </tr>
                </tbody>
              </table>


              -------------------------------------------------------
              sprzedaż wg koloru i rozmiaru - ilosci - tabela przestawna:
              -------------------------------------------------------

              SELECT
                  kategoria,
                  podkategoria,
                  rozmiar,
                  SUM(CASE WHEN kolor = &#39;biały&#39; THEN ilość ELSE 0 END) AS &#39;biały&#39;,
                  SUM(CASE WHEN kolor = &#39;bordowy&#39; THEN ilość ELSE 0 END) AS &#39;bordowy&#39;,
                  SUM(CASE WHEN kolor = &#39;brązowy&#39; THEN ilość ELSE 0 END) AS &#39;brązowy&#39;,
                  SUM(CASE WHEN kolor = &#39;czarny&#39; THEN ilość ELSE 0 END) AS &#39;czarny&#39;,
                  SUM(CASE WHEN kolor = &#39;granatowy&#39; THEN ilość ELSE 0 END) AS &#39;granatowy&#39;,
                  SUM(CASE WHEN kolor = &#39;niebieski&#39; THEN ilość ELSE 0 END) AS &#39;niebieski&#39;,
                  SUM(CASE WHEN kolor = &#39;popiel&#39; THEN ilość ELSE 0 END) AS &#39;popielaty&#39;,
                  SUM(CASE WHEN kolor = &#39;zielony&#39; THEN ilość ELSE 0 END) AS &#39;zielony&#39;
              FROM
                  v_sprzedaż_zamówienia
              WHERE
                  kategoria = &#39;spodnie&#39;
              GROUP BY
                  rozmiar, podkategoria;




                <table class="dataframe styled-table">
                  <thead>
                    <tr>
                      <th></th>
                      <th>kategoria</th>
                      <th>podkategoria</th>
                      <th>rozmiar</th>
                      <th>biały</th>
                      <th>bordowy</th>
                      <th>brązowy</th>
                      <th>czarny</th>
                      <th>granatowy</th>
                      <th>niebieski</th>
                      <th>popielaty</th>
                      <th>zielony</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <th>0</th>
                      <td>spodnie</td>
                      <td>spodnie klasyczne</td>
                      <td>M</td>
                      <td>0.0</td>
                      <td>0.0</td>
                      <td>13.0</td>
                      <td>8.0</td>
                      <td>9.0</td>
                      <td>12.0</td>
                      <td>12.0</td>
                      <td>0.0</td>
                    </tr>
                    <tr>
                      <th>1</th>
                      <td>spodnie</td>
                      <td>spodnie jeans</td>
                      <td>XL</td>
                      <td>0.0</td>
                      <td>0.0</td>
                      <td>5.0</td>
                      <td>25.0</td>
                      <td>4.0</td>
                      <td>4.0</td>
                      <td>16.0</td>
                      <td>0.0</td>
                    </tr>
                    <tr>
                      <th>2</th>
                      <td>spodnie</td>
                      <td>spodnie jeans</td>
                      <td>XXL</td>
                      <td>0.0</td>
                      <td>0.0</td>
                      <td>16.0</td>
                      <td>12.0</td>
                      <td>17.0</td>
                      <td>10.0</td>
                      <td>23.0</td>
                      <td>0.0</td>
                    </tr>
                    <tr>
                      <th>3</th>
                      <td>spodnie</td>
                      <td>spodnie klasyczne</td>
                      <td>XL</td>
                      <td>0.0</td>
                      <td>0.0</td>
                      <td>16.0</td>
                      <td>12.0</td>
                      <td>11.0</td>
                      <td>17.0</td>
                      <td>9.0</td>
                      <td>0.0</td>
                    </tr>
                    <tr>
                      <th>4</th>
                      <td>spodnie</td>
                      <td>spodnie jeans</td>
                      <td>M</td>
                      <td>0.0</td>
                      <td>0.0</td>
                      <td>8.0</td>
                      <td>12.0</td>
                      <td>15.0</td>
                      <td>9.0</td>
                      <td>16.0</td>
                      <td>0.0</td>
                    </tr>
                    <tr>
                      <th>5</th>
                      <td>spodnie</td>
                      <td>spodnie klasyczne</td>
                      <td>XXL</td>
                      <td>0.0</td>
                      <td>0.0</td>
                      <td>13.0</td>
                      <td>11.0</td>
                      <td>7.0</td>
                      <td>8.0</td>
                      <td>13.0</td>
                      <td>0.0</td>
                    </tr>
                    <tr>
                      <th>6</th>
                      <td>spodnie</td>
                      <td>spodnie jeans</td>
                      <td>S</td>
                      <td>0.0</td>
                      <td>0.0</td>
                      <td>15.0</td>
                      <td>20.0</td>
                      <td>6.0</td>
                      <td>10.0</td>
                      <td>11.0</td>
                      <td>0.0</td>
                    </tr>
                    <tr>
                      <th>7</th>
                      <td>spodnie</td>
                      <td>spodnie jeans</td>
                      <td>L</td>
                      <td>0.0</td>
                      <td>0.0</td>
                      <td>1.0</td>
                      <td>2.0</td>
                      <td>12.0</td>
                      <td>6.0</td>
                      <td>8.0</td>
                      <td>0.0</td>
                    </tr>
                    <tr>
                      <th>8</th>
                      <td>spodnie</td>
                      <td>spodnie klasyczne</td>
                      <td>S</td>
                      <td>0.0</td>
                      <td>0.0</td>
                      <td>9.0</td>
                      <td>16.0</td>
                      <td>11.0</td>
                      <td>16.0</td>
                      <td>23.0</td>
                      <td>0.0</td>
                    </tr>
                    <tr>
                      <th>9</th>
                      <td>spodnie</td>
                      <td>spodnie klasyczne</td>
                      <td>L</td>
                      <td>0.0</td>
                      <td>0.0</td>
                      <td>3.0</td>
                      <td>17.0</td>
                      <td>21.0</td>
                      <td>12.0</td>
                      <td>7.0</td>
                      <td>0.0</td>
                    </tr>
                  </tbody>
                </table>


                -------------------------------------------------------
                sumy częsciowe wg kategorii - ilości i wartości:
                -------------------------------------------------------

                SELECT
                    IF(GROUPING(kategoria) = 1, &#39;RAZEM KATEGORIE&#39;, kategoria) AS Kategoria,
                    SUM(ilość) AS ILOŚĆ,
                    SUM(ilość * cena_sprzedaży) AS WARTOŚĆ
                FROM
                    v_sprzedaż_zamówienia
                GROUP BY kategoria WITH ROLLUP;



                <table class="dataframe styled-table">
                  <thead>
                    <tr>
                      <th></th>
                      <th>Kategoria</th>
                      <th>ILOŚĆ</th>
                      <th>WARTOŚĆ</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <th>0</th>
                      <td>bielizna</td>
                      <td>958.0</td>
                      <td>34420.0</td>
                    </tr>
                    <tr>
                      <th>1</th>
                      <td>buty</td>
                      <td>1027.0</td>
                      <td>237063.0</td>
                    </tr>
                    <tr>
                      <th>2</th>
                      <td>galanteria skórzana</td>
                      <td>247.0</td>
                      <td>23611.0</td>
                    </tr>
                    <tr>
                      <th>3</th>
                      <td>odzież męska</td>
                      <td>2225.0</td>
                      <td>138876.0</td>
                    </tr>
                    <tr>
                      <th>4</th>
                      <td>spodnie</td>
                      <td>589.0</td>
                      <td>60911.0</td>
                    </tr>
                    <tr>
                      <th>5</th>
                      <td>RAZEM KATEGORIE</td>
                      <td>5046.0</td>
                      <td>494881.0</td>
                    </tr>
                  </tbody>
                </table>



                -------------------------------------------------------
                Analiza Wartości Produktów i Udziału Procentowego w Całkowitej Sprzedaży:
                -------------------------------------------------------


                SELECT DISTINCT
                    produkt,
                    SUM(ilość * cena_sprzedaży) OVER(PARTITION BY produkt) AS wartosc_produktow,
                    (SUM(ilość * cena_sprzedaży) OVER(PARTITION BY produkt) / (SELECT SUM(ilość * cena_sprzedaży) FROM v_sprzedaż)) * 100 AS proc_udzial_w_calej_sprzedazy
                FROM
                    v_sprzedaż;




                <table class="dataframe styled-table">
                  <thead>
                    <tr>
                      <th></th>
                      <th>produkt</th>
                      <th>wartosc_produktow</th>
                      <th>proc_udzial_w_calej_sprzedazy</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <th>0</th>
                      <td>bokserki L biały</td>
                      <td>893.0</td>
                      <td>0.180447</td>
                    </tr>
                    <tr>
                      <th>1</th>
                      <td>bokserki L brązowy</td>
                      <td>1128.0</td>
                      <td>0.227934</td>
                    </tr>
                    <tr>
                      <th>2</th>
                      <td>bokserki L czarny</td>
                      <td>423.0</td>
                      <td>0.085475</td>
                    </tr>
                    <tr>
                      <th>3</th>
                      <td>bokserki L granatowy</td>
                      <td>611.0</td>
                      <td>0.123464</td>
                    </tr>
                    <tr>
                      <th>4</th>
                      <td>bokserki M biały</td>
                      <td>423.0</td>
                      <td>0.085475</td>
                    </tr>
                    <tr>
                      <th>...</th>
                      <td>...</td>
                      <td>...</td>
                      <td>...</td>
                    </tr>
                    <tr>
                      <th>492</th>
                      <td>torba skórzana  M czarny</td>
                      <td>2136.0</td>
                      <td>0.431619</td>
                    </tr>
                    <tr>
                      <th>493</th>
                      <td>torba skórzana  M granatowy</td>
                      <td>1246.0</td>
                      <td>0.251778</td>
                    </tr>
                    <tr>
                      <th>494</th>
                      <td>torba skórzana  S brązowy</td>
                      <td>2136.0</td>
                      <td>0.431619</td>
                    </tr>
                    <tr>
                      <th>495</th>
                      <td>torba skórzana  S czarny</td>
                      <td>890.0</td>
                      <td>0.179841</td>
                    </tr>
                    <tr>
                      <th>496</th>
                      <td>torba skórzana  S granatowy</td>
                      <td>1246.0</td>
                      <td>0.251778</td>
                    </tr>
                  </tbody>
                </table>
                    
                  </pre>


                  <h3>
                      Analiza zakupów
                  </h3>

                  <pre class = "kod">
                  
                      -------------------------------------------------------
                      produkty wg koloru i rozmiaru:
                      -------------------------------------------------------
              
              
                      SELECT 
                          p.id_produkt AS id_produkt,
                          p.produkt AS produkt,
                          p.kolor AS kolor,
                          p.rozmiar AS rozmiar,
                          p.cena_sprzedaży AS cena_sprzedaży,
                          pod.podkategoria AS podkategoria,
                          k.kategoria AS kategoria
                      FROM
                          sklep.produkty p
                          LEFT JOIN sklep.podkategorie pod ON p.id_podkategoria = pod.id_podkategoria
                          LEFT JOIN sklep.kategorie k ON pod.id_kategoria = k.id_kategoria
                      WHERE 
                          kolor = &#39;biały&#39; AND rozmiar = &#39;xl&#39;;
              
              
              
              
                      <table class="dataframe styled-table">
                        <thead>
                          <tr>
                            <th></th>
                            <th>id_produkt</th>
                            <th>produkt</th>
                            <th>kolor</th>
                            <th>rozmiar</th>
                            <th>cena_sprzedaży</th>
                            <th>podkategoria</th>
                            <th>kategoria</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr>
                            <th>0</th>
                            <td>16</td>
                            <td>koszula długi rękaw gładka XL biała</td>
                            <td>biały</td>
                            <td>XL</td>
                            <td>75.0</td>
                            <td>koszula</td>
                            <td>odzież męska</td>
                          </tr>
                          <tr>
                            <th>1</th>
                            <td>41</td>
                            <td>koszula długi rękaw w paski XL biała</td>
                            <td>biały</td>
                            <td>XL</td>
                            <td>75.0</td>
                            <td>koszula</td>
                            <td>odzież męska</td>
                          </tr>
                          <tr>
                            <th>2</th>
                            <td>66</td>
                            <td>koszula długi rękaw w kratkę XL biała</td>
                            <td>biały</td>
                            <td>XL</td>
                            <td>75.0</td>
                            <td>koszula</td>
                            <td>odzież męska</td>
                          </tr>
                          <tr>
                            <th>3</th>
                            <td>91</td>
                            <td>koszula krótki rękaw gładka XL biała</td>
                            <td>biały</td>
                            <td>XL</td>
                          <td>69.0</td>
                          <td>koszula</td>
                          <td>odzież męska</td>
                        </tr>
                        <tr>
                          <th>4</th>
                          <td>116</td>
                          <td>koszula krótki rękaw w paski XL biała</td>
                          <td>biały</td>
                          <td>XL</td>
                          <td>69.0</td>
                          <td>koszula</td>
                          <td>odzież męska</td>
                        </tr>
                        <tr>
                          <th>5</th>
                          <td>141</td>
                          <td>koszula krótki rękaw w kratkę XL biała</td>
                          <td>biały</td>
                          <td>XL</td>
                          <td>69.0</td>
                          <td>koszula</td>
                          <td>odzież męska</td>
                        </tr>
                        <tr>
                          <th>6</th>
                          <td>170</td>
                          <td>T-shirt polo XL biała</td>
                          <td>biały</td>
                          <td>XL</td>
                          <td>36.0</td>
                          <td>T-shirt</td>
                          <td>odzież męska</td>
                        </tr>
                        <tr>
                          <th>7</th>
                          <td>195</td>
                          <td>T-shirt jeans XL biała</td>
                          <td>biały</td>
                          <td>XL</td>
                          <td>46.0</td>
                          <td>T-shirt</td>
                          <td>odzież męska</td>
                        </tr>
                        <tr>
                          <th>8</th>
                          <td>220</td>
                          <td>T-shirt bawełna XL biała</td>
                          <td>biały</td>
                          <td>XL</td>
                          <td>40.0</td>
                          <td>T-shirt</td>
                          <td>odzież męska</td>
                        </tr>
                        <tr>
                          <th>9</th>
                          <td>346</td>
                          <td>slipy XL biały</td>
                          <td>biały</td>
                          <td>XL</td>
                          <td>38.0</td>
                          <td>slipy</td>
                          <td>bielizna</td>
                        </tr>
                        <tr>
                          <th>10</th>
                          <td>366</td>
                          <td>bokserki XL biały</td>
                          <td>biały</td>
                          <td>XL</td>
                          <td>47.0</td>
                          <td>bokserki</td>
                          <td>bielizna</td>
                        </tr>
                        <tr>
                          <th>11</th>
                          <td>386</td>
                          <td>kąpielówki XL biały</td>
                          <td>biały</td>
                          <td>XL</td>
                          <td>29.0</td>
                          <td>kąpielówki</td>
                          <td>bielizna</td>
                        </tr>
                        <tr>
                          <th>12</th>
                          <td>406</td>
                          <td>podkoszulki XL biały</td>
                          <td>biały</td>
                          <td>XL</td>
                          <td>36.0</td>
                          <td>podkoszulki</td>
                          <td>bielizna</td>
                        </tr>
                      </tbody>
                    </table>
           
            
            
                    -------------------------------------------------------
                    ilość zakupów ogółem:
                    -------------------------------------------------------
            
                    SELECT sum(ilość) as ilosć 
                    FROM zakupy; 
          
            
            
                    <table class="dataframe styled-table">
                      <thead>
                        <tr>
                          <th></th>
                          <th>ilosć</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <th>0</th>
                          <td>39722.0</td>
                        </tr>
                      </tbody>
                    </table>
            
            
            
            
            
                    -------------------------------------------------------
                    wartosc zakupów ogółem:
                    -------------------------------------------------------
            
            
                    SELECT sum(ilość*cena_zakupu) as wartość
                    FROM zakupy;
            
            
            
                    <table class="dataframe styled-table">
                      <thead>
                        <tr>
                          <th></th>
                          <th>wartość</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <th>0</th>
                          <td>3527318.55</td>
                        </tr>
                      </tbody>
                    </table>
                
            
            
            
                    -------------------------------------------------------
                    ilośc i wartość zakupów wg kategorii i podkategorii:
                    -------------------------------------------------------
            
                    SELECT distinct
                      kategoria,podkategoria,
                      SUM(ilość) OVER(PARTITION BY kategoria, podkategoria) AS liczba_produktów_wg_kategorii,
                        SUM(ilość*cena_zakupu) OVER(PARTITION BY kategoria, podkategoria) AS wartosć_produktów_wg_kategorii
                    FROM v_zakupy
                    ORDER BY kategoria, podkategoria;
            
            
            
            
                    <table class="dataframe styled-table">
                      <thead>
                        <tr>
                          <th></th>
                          <th>kategoria</th>
                          <th>podkategoria</th>
                          <th>liczba_produktów_wg_kategorii</th>
                          <th>wartosć_produktów_wg_kategorii</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <th>0</th>
                          <td>bielizna</td>
                          <td>bokserki</td>
                          <td>1358.0</td>
                          <td>54740.98</td>
                        </tr>
                        <tr>
                          <th>1</th>
                          <td>bielizna</td>
                          <td>kąpielówki</td>
                          <td>1469.0</td>
                          <td>41344.81</td>
                        </tr>
                        <tr>
                          <th>2</th>
                          <td>bielizna</td>
                          <td>podkoszulki</td>
                          <td>1803.0</td>
                          <td>58723.71</td>
                        </tr>
                        <tr>
                          <th>3</th>
                          <td>bielizna</td>
                          <td>skarpetki</td>
                          <td>1092.0</td>
                          <td>23849.28</td>
                        </tr>
                        <tr>
                          <th>4</th>
                          <td>bielizna</td>
                          <td>slipy</td>
                          <td>1550.0</td>
                          <td>48344.50</td>
                        </tr>
                        <tr>
                          <th>5</th>
                          <td>buty</td>
                          <td>botki</td>
                          <td>1532.0</td>
                          <td>253974.96</td>
                        </tr>
                        <tr>
                          <th>6</th>
                          <td>buty</td>
                          <td>buty sportowe</td>
                          <td>1968.0</td>
                          <td>512336.07</td>
                        </tr>
                        <tr>
                          <th>7</th>
                          <td>buty</td>
                          <td>buty wizytowe</td>
                          <td>1875.0</td>
                          <td>429262.50</td>
                        </tr>
                        <tr>
                          <th>8</th>
                          <td>buty</td>
                          <td>półbuty</td>
                          <td>1709.0</td>
                          <td>307705.45</td>
                        </tr>
                        <tr>
                          <th>9</th>
                          <td>buty</td>
                          <td>trzewiki</td>
                          <td>1654.0</td>
                          <td>350580.95</td>
                        </tr>
                        <tr>
                          <th>10</th>
                          <td>galanteria skórzana</td>
                          <td>paski</td>
                          <td>1563.0</td>
                          <td>87686.92</td>
                        </tr>
                        <tr>
                          <th>11</th>
                          <td>galanteria skórzana</td>
                          <td>torby</td>
                          <td>737.0</td>
                          <td>101072.18</td>
                        </tr>
                        <tr>
                          <th>12</th>
                          <td>odzież męska</td>
                          <td>koszula</td>
                          <td>11245.0</td>
                          <td>653871.84</td>
                        </tr>
                        <tr>
                          <th>13</th>
                          <td>odzież męska</td>
                          <td>T-shirt</td>
                          <td>5899.0</td>
                          <td>217274.74</td>
                        </tr>
                        <tr>
                          <th>14</th>
                          <td>spodnie</td>
                          <td>spodnie jeans</td>
                          <td>2126.0</td>
                          <td>201502.28</td>
                        </tr>
                        <tr>
                          <th>15</th>
                          <td>spodnie</td>
                          <td>spodnie klasyczne</td>
                          <td>2142.0</td>
                          <td>185047.38</td>
                        </tr>
                      </tbody>
                    </table>

            
            
                    -------------------------------------------------------
                    ilośc i wartość zakupów wg produktu :
                    -------------------------------------------------------
            
                    SELECT distinct
                      produkt,
                      SUM(ilość) OVER(PARTITION BY produkt) AS liczba_produktów,
                      SUM(ilość*cena_zakupu) OVER(PARTITION BY produkt) AS wartosć_produktów
                    FROM v_zakupy;
            

            
            
                    <table class="dataframe styled-table">
                      <thead>
                        <tr>
                          <th></th>
                          <th>produkt</th>
                          <th>liczba_produktów</th>
                          <th>wartosć_produktów</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <th>0</th>
                          <td>bokserki L biały</td>
                          <td>33.0</td>
                          <td>1330.23</td>
                        </tr>
                        <tr>
                          <th>1</th>
                          <td>bokserki L brązowy</td>
                          <td>25.0</td>
                          <td>1007.75</td>
                        </tr>
                        <tr>
                          <th>2</th>
                          <td>bokserki L czarny</td>
                          <td>65.0</td>
                          <td>2620.15</td>
                        </tr>
                        <tr>
                          <th>3</th>
                          <td>bokserki L granatowy</td>
                          <td>118.0</td>
                          <td>4756.58</td>
                        </tr>
                        <tr>
                          <th>4</th>
                          <td>bokserki M biały</td>
                          <td>50.0</td>
                          <td>2015.50</td>
                        </tr>
                        <tr>
                          <th>...</th>
                          <td>...</td>
                          <td>...</td>
                          <td>...</td>
                        </tr>
                        <tr>
                          <th>494</th>
                          <td>torba skórzana  M czarny</td>
                          <td>87.0</td>
                          <td>11931.18</td>
                        </tr>
                        <tr>
                          <th>495</th>
                          <td>torba skórzana  M granatowy</td>
                          <td>113.0</td>
                          <td>15496.82</td>
                        </tr>
                        <tr>
                          <th>496</th>
                          <td>torba skórzana  S brązowy</td>
                          <td>65.0</td>
                          <td>8914.10</td>
                        </tr>
                        <tr>
                          <th>497</th>
                          <td>torba skórzana  S czarny</td>
                          <td>98.0</td>
                          <td>13439.72</td>
                        </tr>
                        <tr>
                          <th>498</th>
                          <td>torba skórzana  S granatowy</td>
                          <td>119.0</td>
                          <td>16319.66</td>
                        </tr>
                      </tbody>
                    </table>
                 
            
            
                    -------------------------------------------------------
                    top N produktów w kategorii -  ilości:
                    -------------------------------------------------------
                      
                    WITH cte1 AS (
                        SELECT DISTINCT
                            kategoria, podkategoria, produkt, ilość,
                            DENSE_RANK() OVER (PARTITION BY kategoria ORDER BY ilość DESC) AS ranking
                        FROM v_zakupy  
                        ORDER BY kategoria, ranking
                    )
                    SELECT kategoria, produkt, ilość, ranking 
                    FROM cte1 
                    WHERE ranking &lt;= 2 AND kategoria = &#39;odzież męska&#39;;
            
            
            
            
            
                    <table class="dataframe styled-table">
                      <thead>
                        <tr>
                          <th></th>
                          <th>kategoria</th>
                          <th>produkt</th>
                          <th>ilość</th>
                          <th>ranking</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <th>0</th>
                          <td>odzież męska</td>
                          <td>koszula krótki rękaw gładka S zielona</td>
                          <td>145</td>
                          <td>1</td>
                        </tr>
                        <tr>
                          <th>1</th>
                          <td>odzież męska</td>
                          <td>koszula długi rękaw gładka S czarna</td>
                          <td>144</td>
                          <td>2</td>
                        </tr>
                        <tr>
                          <th>2</th>
                          <td>odzież męska</td>
                          <td>koszula krótki rękaw w paski XL zielona</td>
                          <td>144</td>
                          <td>2</td>
                        </tr>
                      </tbody>
                    </table>

            
                    -------------------------------------------------------
                    top N produktów w podkategorii -  ilości:
                    -------------------------------------------------------
                        
            
                    WITH cte1 AS (
                        SELECT DISTINCT
                            kategoria, podkategoria, produkt, ilość,
                            DENSE_RANK() OVER (PARTITION BY podkategoria ORDER BY ilość DESC) AS ranking
                        FROM v_zakupy  
                        ORDER BY podkategoria, ranking
                    )
                    SELECT podkategoria, produkt, ilość, ranking 
                    FROM cte1 
                    WHERE ranking &lt;= 3 AND podkategoria = &#39;T-shirt&#39;;
            
            
            
            
                    <table class="dataframe styled-table">
                      <thead>
                        <tr>
                          <th></th>
                          <th>podkategoria</th>
                          <th>produkt</th>
                          <th>ilość</th>
                          <th>ranking</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <th>0</th>
                          <td>T-shirt</td>
                          <td>T-shirt jeans S biała</td>
                          <td>143</td>
                          <td>1</td>
                        </tr>
                        <tr>
                          <th>1</th>
                          <td>T-shirt</td>
                          <td>T-shirt polo M granatowa</td>
                          <td>142</td>
                          <td>2</td>
                        </tr>
                        <tr>
                          <th>2</th>
                          <td>T-shirt</td>
                          <td>T-shirt jeans S czarna</td>
                          <td>139</td>
                          <td>3</td>
                        </tr>
                      </tbody>
                    </table>
               
            
            
                    -------------------------------------------------------
                    top N produktów w kategorii -  wartość:
                    -------------------------------------------------------
                        
            
                    WITH cte1 AS (
                        SELECT DISTINCT
                            kategoria, podkategoria, produkt, (ilość * cena_zakupu) as wartosc,
                            DENSE_RANK() OVER (PARTITION BY kategoria ORDER BY (ilość * cena_zakupu) DESC) AS ranking
                        FROM v_zakupy  
                        ORDER BY kategoria, ranking
                    )
            
                    SELECT kategoria, produkt, wartosc, ranking 
                    FROM cte1 
                    WHERE ranking &lt;= 3 AND kategoria = &#39;odzież męska&#39;;
            
            

            
                    <table class="dataframe styled-table">
                      <thead>
                        <tr>
                          <th></th>
                          <th>kategoria</th>
                          <th>produkt</th>
                          <th>wartosc</th>
                          <th>ranking</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <th>0</th>
                          <td>odzież męska</td>
                          <td>koszula długi rękaw gładka S czarna</td>
                          <td>8665.92</td>
                          <td>1</td>
                        </tr>
                        <tr>
                          <th>1</th>
                          <td>odzież męska</td>
                          <td>koszula długi rękaw w paski M zielona</td>
                          <td>8304.84</td>
                          <td>2</td>
                        </tr>
                        <tr>
                          <th>2</th>
                          <td>odzież męska</td>
                          <td>koszula długi rękaw w kratkę M zielona</td>
                          <td>8244.66</td>
                          <td>3</td>
                        </tr>
                      </tbody>
                    </table>
                   
            
            
                    -------------------------------------------------------
                    top N produktów w podkategorii -  wartości:
                    -------------------------------------------------------
                      
            
                    WITH cte1 AS (
                        SELECT DISTINCT
                            podkategoria, produkt, (ilość * cena_zakupu) as wartosc,
                            DENSE_RANK() OVER (PARTITION BY podkategoria ORDER BY (ilość * cena_zakupu) DESC) AS ranking
                        FROM v_zakupy  
                        ORDER BY podkategoria, ranking
                    )
                    SELECT podkategoria, produkt, wartosc, ranking 
                    FROM cte1 
                    WHERE ranking &lt;= 3 AND podkategoria = &#39;bokserki&#39;;
            
       
            
            
                    <table class="dataframe styled-table">
                      <thead>
                        <tr>
                          <th></th>
                          <th>podkategoria</th>
                          <th>produkt</th>
                          <th>wartosc</th>
                          <th>ranking</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <th>0</th>
                          <td>bokserki</td>
                          <td>bokserki S granatowy</td>
                          <td>5844.95</td>
                          <td>1</td>
                        </tr>
                        <tr>
                          <th>1</th>
                          <td>bokserki</td>
                          <td>bokserki XXL czarny</td>
                          <td>5804.64</td>
                          <td>2</td>
                        </tr>
                        <tr>
                          <th>2</th>
                          <td>bokserki</td>
                          <td>bokserki XL biały</td>
                          <td>5079.06</td>
                          <td>3</td>
                        </tr>
                      </tbody>
                    </table>

            
            
                    -------------------------------------------------------
                    top  3 kategorii wg liczby produktów:
                    -------------------------------------------------------
            
                    SELECT DISTINCT
                        kategoria,
                        SUM(ilość) OVER (PARTITION BY kategoria) AS liczba_produktów
                    FROM v_zakupy
                    ORDER BY liczba_produktów DESC
                    LIMIT 3;
            
            
                    <table class="dataframe styled-table">
                      <thead>
                        <tr>
                          <th></th>
                          <th>kategoria</th>
                          <th>liczba_produktów</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <th>0</th>
                          <td>odzież męska</td>
                          <td>17144.0</td>
                        </tr>
                        <tr>
                          <th>1</th>
                          <td>buty</td>
                          <td>8738.0</td>
                        </tr>
                        <tr>
                          <th>2</th>
                          <td>bielizna</td>
                          <td>7272.0</td>
                        </tr>
                      </tbody>
                    </table>
       
            
        
            
                    -------------------------------------------------------
                    top  3 podkategorii wg liczby produktów:
                    -------------------------------------------------------
            
                    SELECT DISTINCT
                        podkategoria,
                        SUM(ilość) OVER (PARTITION BY podkategoria) AS liczba_produktów
                    FROM v_zakupy
                    ORDER BY liczba_produktów DESC
                    LIMIT 3;
            
          
            
            
            
                    <table class="dataframe styled-table">
                      <thead>
                        <tr>
                          <th></th>
                          <th>podkategoria</th>
                          <th>liczba_produktów</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <th>0</th>
                          <td>koszula</td>
                          <td>11245.0</td>
                        </tr>
                        <tr>
                          <th>1</th>
                          <td>T-shirt</td>
                          <td>5899.0</td>
                        </tr>
                        <tr>
                          <th>2</th>
                          <td>spodnie klasyczne</td>
                          <td>2142.0</td>
                        </tr>
                      </tbody>
                    </table>

            
            
            
                    -------------------------------------------------------
                      top 10 produktów  wg liczby produktów:
                    -------------------------------------------------------
            
                    SELECT DISTINCT
                        produkt,
                        SUM(ilość) OVER (PARTITION BY produkt) AS liczba_produktów
                    FROM v_zakupy
                    ORDER BY liczba_produktów DESC
                    LIMIT 10;
            

            
            
                    <table class="dataframe styled-table">
                      <thead>
                        <tr>
                          <th></th>
                          <th>produkt</th>
                          <th>liczba_produktów</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <th>0</th>
                          <td>bokserki S granatowy</td>
                          <td>145.0</td>
                        </tr>
                        <tr>
                          <th>1</th>
                          <td>buty botki 42 czarny</td>
                          <td>145.0</td>
                        </tr>
                        <tr>
                          <th>2</th>
                          <td>koszula krótki rękaw gładka S zielona</td>
                          <td>145.0</td>
                        </tr>
                        <tr>
                          <th>3</th>
                          <td>bokserki XXL czarny</td>
                          <td>144.0</td>
                        </tr>
                        <tr>
                          <th>4</th>
                          <td>buty trzewiki 41 granatowy</td>
                          <td>144.0</td>
                        </tr>
                        <tr>
                          <th>5</th>
                          <td>koszula długi rękaw gładka S czarna</td>
                          <td>144.0</td>
                        </tr>
                        <tr>
                          <th>6</th>
                          <td>koszula krótki rękaw w paski XL zielona</td>
                          <td>144.0</td>
                        </tr>
                        <tr>
                          <th>7</th>
                          <td>buty wizytowe 45 granatowy</td>
                          <td>143.0</td>
                        </tr>
                        <tr>
                          <th>8</th>
                          <td>T-shirt jeans S biała</td>
                          <td>143.0</td>
                        </tr>
                        <tr>
                          <th>9</th>
                          <td>spodnie jeans M czarny</td>
                          <td>142.0</td>
                        </tr>
                      </tbody>
                    </table>
    
            
            
                    -------------------------------------------------------
                    procentowy udział wartosci produktów :
                    -------------------------------------------------------
            
                    SELECT DISTINCT
                        produkt,
                        SUM(ilość * cena_zakupu) OVER (PARTITION BY produkt) AS wartosc_produktow,
                        SUM(ilość * cena_zakupu) OVER (PARTITION BY produkt) / SUM(ilość * cena_zakupu) OVER () * 100 AS proc_udzial_w_calkowitej
                    FROM v_zakupy
                    ORDER BY proc_udzial_w_calkowitej DESC;
            

            
                    <table class="dataframe styled-table">
                      <thead>
                        <tr>
                          <th></th>
                          <th>produkt</th>
                          <th>wartosc_produktow</th>
                          <th>proc_udzial_w_calkowitej</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <th>0</th>
                          <td>buty sportowe 40 brązowy</td>
                          <td>37549.71</td>
                          <td>1.064540</td>
                        </tr>
                        <tr>
                          <th>1</th>
                          <td>buty sportowe 40 czarny</td>
                          <td>33022.44</td>
                          <td>0.936191</td>
                        </tr>
                        <tr>
                          <th>2</th>
                          <td>buty sportowe 45 biały</td>
                          <td>33022.44</td>
                          <td>0.936191</td>
                        </tr>
                        <tr>
                          <th>3</th>
                          <td>buty wizytowe 45 granatowy</td>
                          <td>32738.42</td>
                          <td>0.928139</td>
                        </tr>
                        <tr>
                          <th>4</th>
                          <td>buty sportowe 40 granatowy</td>
                          <td>31957.20</td>
                          <td>0.905991</td>
                        </tr>
                        <tr>
                          <th>...</th>
                          <td>...</td>
                          <td>...</td>
                          <td>...</td>
                        </tr>
                        <tr>
                          <th>494</th>
                          <td>T-shirt polo XXL zielona</td>
                          <td>722.70</td>
                          <td>0.020489</td>
                        </tr>
                        <tr>
                          <th>495</th>
                          <td>T-shirt polo XXL granatowa</td>
                          <td>657.00</td>
                          <td>0.018626</td>
                        </tr>
                        <tr>
                          <th>496</th>
                          <td>skarpetki 41-43 biały</td>
                          <td>655.20</td>
                          <td>0.018575</td>
                        </tr>
                        <tr>
                          <th>497</th>
                          <td>slipy L brązowy</td>
                          <td>654.99</td>
                          <td>0.018569</td>
                        </tr>
                        <tr>
                          <th>498</th>
                          <td>podkoszulki XXL granatowy</td>
                          <td>651.40</td>
                          <td>0.018467</td>
                        </tr>
                      </tbody>
                    </table>
      
            
        
            
                    -------------------------------------------------------
                    procentowy udział wartosci kategorii :
                    -------------------------------------------------------
            
                    SELECT DISTINCT
                        kategoria,
                        SUM(ilość * cena_zakupu) OVER (PARTITION BY kategoria) AS wartosc_produktow,
                        ROUND(SUM(ilość * cena_zakupu) OVER (PARTITION BY kategoria) / SUM(ilość * cena_zakupu) OVER () * 100, 2) AS proc_udzial_w_calkowitej
                    FROM v_zakupy
                    ORDER BY proc_udzial_w_calkowitej DESC;
            
            
            
                    <table class="dataframe styled-table">
                      <thead>
                        <tr>
                          <th></th>
                          <th>kategoria</th>
                          <th>wartosc_produktow</th>
                          <th>proc_udzial_w_calkowitej</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <th>0</th>
                          <td>buty</td>
                          <td>1853859.93</td>
                          <td>52.56</td>
                        </tr>
                        <tr>
                          <th>1</th>
                          <td>odzież męska</td>
                          <td>871146.58</td>
                          <td>24.70</td>
                        </tr>
                        <tr>
                          <th>2</th>
                          <td>spodnie</td>
                          <td>386549.66</td>
                          <td>10.96</td>
                        </tr>
                        <tr>
                          <th>3</th>
                          <td>bielizna</td>
                          <td>227003.28</td>
                          <td>6.44</td>
                        </tr>
                        <tr>
                          <th>4</th>
                          <td>galanteria skórzana</td>
                          <td>188759.10</td>
                          <td>5.35</td>
                        </tr>
                      </tbody>
                    </table>

            
            
                    -------------------------------------------------------
                    procentowy udział wartosci podkategorii:
                    -------------------------------------------------------
            
                    SELECT DISTINCT
                        podkategoria,
                        SUM(ilość * cena_zakupu) OVER (PARTITION BY podkategoria) AS wartosc_produktow,
                        ROUND(SUM(ilość * cena_zakupu) OVER (PARTITION BY podkategoria) / SUM(ilość * cena_zakupu) OVER () * 100, 2) AS proc_udzial_w_calkowitej
                    FROM v_zakupy
                    ORDER BY proc_udzial_w_calkowitej DESC;
            
            
            
                    <table class="dataframe styled-table">
                      <thead>
                        <tr>
                          <th></th>
                          <th>podkategoria</th>
                          <th>wartosc_produktow</th>
                          <th>proc_udzial_w_calkowitej</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <th>0</th>
                          <td>koszula</td>
                          <td>653871.84</td>
                          <td>18.54</td>
                        </tr>
                        <tr>
                          <th>1</th>
                          <td>buty sportowe</td>
                          <td>512336.07</td>
                          <td>14.52</td>
                        </tr>
                        <tr>
                          <th>2</th>
                          <td>buty wizytowe</td>
                          <td>429262.50</td>
                          <td>12.17</td>
                        </tr>
                        <tr>
                          <th>3</th>
                          <td>trzewiki</td>
                          <td>350580.95</td>
                          <td>9.94</td>
                        </tr>
                        <tr>
                          <th>4</th>
                          <td>półbuty</td>
                          <td>307705.45</td>
                          <td>8.72</td>
                        </tr>
                        <tr>
                          <th>5</th>
                          <td>botki</td>
                          <td>253974.96</td>
                          <td>7.20</td>
                        </tr>
                        <tr>
                          <th>6</th>
                          <td>T-shirt</td>
                          <td>217274.74</td>
                          <td>6.16</td>
                        </tr>
                        <tr>
                          <th>7</th>
                          <td>spodnie jeans</td>
                          <td>201502.28</td>
                          <td>5.71</td>
                        </tr>
                        <tr>
                          <th>8</th>
                          <td>spodnie klasyczne</td>
                          <td>185047.38</td>
                          <td>5.25</td>
                        </tr>
                        <tr>
                          <th>9</th>
                          <td>torby</td>
                          <td>101072.18</td>
                          <td>2.87</td>
                        </tr>
                        <tr>
                          <th>10</th>
                          <td>paski</td>
                          <td>87686.92</td>
                          <td>2.49</td>
                        </tr>
                        <tr>
                          <th>11</th>
                          <td>podkoszulki</td>
                          <td>58723.71</td>
                          <td>1.66</td>
                        </tr>
                        <tr>
                          <th>12</th>
                          <td>bokserki</td>
                          <td>54740.98</td>
                          <td>1.55</td>
                        </tr>
                        <tr>
                          <th>13</th>
                          <td>slipy</td>
                          <td>48344.50</td>
                          <td>1.37</td>
                        </tr>
                        <tr>
                          <th>14</th>
                          <td>kąpielówki</td>
                          <td>41344.81</td>
                          <td>1.17</td>
                        </tr>
                        <tr>
                          <th>15</th>
                          <td>skarpetki</td>
                          <td>23849.28</td>
                          <td>0.68</td>
                        </tr>
                      </tbody>
                    </table>

            
                    -------------------------------------------------------
                    procentowy udział ilości produktów:
                    -------------------------------------------------------
            
                    SELECT DISTINCT
                        produkt,
                        SUM(ilość) OVER (PARTITION BY produkt) AS wartosc_produktow,
                        ROUND(SUM(ilość) OVER (PARTITION BY produkt) / SUM(ilość) OVER () * 100, 2) AS proc_udzial_w_calkowitej
                    FROM v_zakupy
                    ORDER BY proc_udzial_w_calkowitej DESC;
            

            
                    <table class="dataframe styled-table">
                      <thead>
                        <tr>
                          <th></th>
                          <th>produkt</th>
                          <th>wartosc_produktow</th>
                          <th>proc_udzial_w_calkowitej</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <th>0</th>
                          <td>bokserki S granatowy</td>
                          <td>145.0</td>
                          <td>0.37</td>
                        </tr>
                        <tr>
                          <th>1</th>
                          <td>buty botki 42 czarny</td>
                          <td>145.0</td>
                          <td>0.37</td>
                        </tr>
                        <tr>
                          <th>2</th>
                          <td>koszula krótki rękaw gładka S zielona</td>
                          <td>145.0</td>
                          <td>0.37</td>
                        </tr>
                        <tr>
                          <th>3</th>
                          <td>bokserki XXL czarny</td>
                          <td>144.0</td>
                          <td>0.36</td>
                        </tr>
                        <tr>
                          <th>4</th>
                          <td>buty trzewiki 41 granatowy</td>
                          <td>144.0</td>
                          <td>0.36</td>
                        </tr>
                        <tr>
                          <th>...</th>
                          <td>...</td>
                          <td>...</td>
                          <td>...</td>
                        </tr>
                        <tr>
                          <th>494</th>
                          <td>slipy L brązowy</td>
                          <td>21.0</td>
                          <td>0.05</td>
                        </tr>
                        <tr>
                          <th>495</th>
                          <td>spodnie jeans M popiel</td>
                          <td>21.0</td>
                          <td>0.05</td>
                        </tr>
                        <tr>
                          <th>496</th>
                          <td>T-shirt bawełna XL czarna</td>
                          <td>20.0</td>
                          <td>0.05</td>
                        </tr>
                        <tr>
                          <th>497</th>
                          <td>T-shirt jeans XXL biała</td>
                          <td>20.0</td>
                          <td>0.05</td>
                        </tr>
                        <tr>
                          <th>498</th>
                          <td>T-shirt polo XXL granatowa</td>
                          <td>20.0</td>
                          <td>0.05</td>
                        </tr>
                      </tbody>
                    </table>

            
            
                    -------------------------------------------------------
                    procentowy udział ilości kategorii:
                    -------------------------------------------------------
            
                    SELECT DISTINCT
                        kategoria,
                        SUM(ilość) OVER (PARTITION BY kategoria) AS wartosc_produktow,
                        ROUND(SUM(ilość) OVER (PARTITION BY kategoria) / SUM(ilość) OVER () * 100, 2) AS proc_udzial_w_calkowitej
                    FROM v_zakupy
                    ORDER BY proc_udzial_w_calkowitej DESC;

            
            
                    <table class="dataframe styled-table">
                      <thead>
                        <tr>
                          <th></th>
                          <th>kategoria</th>
                          <th>wartosc_produktow</th>
                          <th>proc_udzial_w_calkowitej</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <th>0</th>
                          <td>odzież męska</td>
                          <td>17144.0</td>
                          <td>43.16</td>
                        </tr>
                        <tr>
                          <th>1</th>
                          <td>buty</td>
                          <td>8738.0</td>
                          <td>22.00</td>
                        </tr>
                        <tr>
                          <th>2</th>
                          <td>bielizna</td>
                          <td>7272.0</td>
                          <td>18.31</td>
                        </tr>
                        <tr>
                          <th>3</th>
                          <td>spodnie</td>
                          <td>4268.0</td>
                          <td>10.74</td>
                        </tr>
                        <tr>
                          <th>4</th>
                          <td>galanteria skórzana</td>
                          <td>2300.0</td>
                          <td>5.79</td>
                        </tr>
                      </tbody>
                    </table>

            
            
                    -------------------------------------------------------
                    procentowy udział ilości  podkategorii :
                    -------------------------------------------------------
            
                    SELECT DISTINCT
                        podkategoria,
                        SUM(ilość) OVER (PARTITION BY podkategoria) AS wartosc_produktow,
                        ROUND(SUM(ilość) OVER (PARTITION BY podkategoria) / SUM(ilość) OVER () * 100, 2) AS proc_udzial_w_calkowitej
                    FROM v_zakupy
                    ORDER BY proc_udzial_w_calkowitej DESC;
            

            
            
                    <table class="dataframe styled-table">
                      <thead>
                        <tr>
                          <th></th>
                          <th>podkategoria</th>
                          <th>wartosc_produktow</th>
                          <th>proc_udzial_w_calkowitej</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <th>0</th>
                          <td>koszula</td>
                          <td>11245.0</td>
                          <td>28.31</td>
                        </tr>
                        <tr>
                          <th>1</th>
                          <td>T-shirt</td>
                          <td>5899.0</td>
                          <td>14.85</td>
                        </tr>
                        <tr>
                          <th>2</th>
                          <td>spodnie klasyczne</td>
                          <td>2142.0</td>
                          <td>5.39</td>
                        </tr>
                        <tr>
                          <th>3</th>
                          <td>spodnie jeans</td>
                          <td>2126.0</td>
                          <td>5.35</td>
                        </tr>
                        <tr>
                          <th>4</th>
                          <td>buty sportowe</td>
                          <td>1968.0</td>
                          <td>4.95</td>
                        </tr>
                        <tr>
                          <th>5</th>
                          <td>buty wizytowe</td>
                          <td>1875.0</td>
                          <td>4.72</td>
                        </tr>
                        <tr>
                          <th>6</th>
                          <td>podkoszulki</td>
                          <td>1803.0</td>
                          <td>4.54</td>
                        </tr>
                        <tr>
                          <th>7</th>
                          <td>półbuty</td>
                          <td>1709.0</td>
                          <td>4.30</td>
                        </tr>
                        <tr>
                          <th>8</th>
                          <td>trzewiki</td>
                          <td>1654.0</td>
                          <td>4.16</td>
                        </tr>
                        <tr>
                          <th>9</th>
                          <td>paski</td>
                          <td>1563.0</td>
                          <td>3.93</td>
                        </tr>
                        <tr>
                          <th>10</th>
                          <td>slipy</td>
                          <td>1550.0</td>
                          <td>3.90</td>
                        </tr>
                        <tr>
                          <th>11</th>
                          <td>botki</td>
                          <td>1532.0</td>
                          <td>3.86</td>
                        </tr>
                        <tr>
                          <th>12</th>
                          <td>kąpielówki</td>
                          <td>1469.0</td>
                          <td>3.70</td>
                        </tr>
                        <tr>
                          <th>13</th>
                          <td>bokserki</td>
                          <td>1358.0</td>
                          <td>3.42</td>
                        </tr>
                        <tr>
                          <th>14</th>
                          <td>skarpetki</td>
                          <td>1092.0</td>
                          <td>2.75</td>
                        </tr>
                        <tr>
                          <th>15</th>
                          <td>torby</td>
                          <td>737.0</td>
                          <td>1.86</td>
                        </tr>
                      </tbody>
                    </table>
 
            
            
                    -------------------------------------------------------
                    kategorie wg koloru - ilości - tabela przestawna:
                    -------------------------------------------------------
            
                    SELECT 
                        kategoria,
                        SUM(CASE WHEN kolor=&#39;biały&#39; THEN ilość ELSE 0 END) AS biały,
                        SUM(CASE WHEN kolor=&#39;bordowy&#39; THEN ilość ELSE 0 END) AS bordowy,
                        SUM(CASE WHEN kolor=&#39;brązowy&#39; THEN ilość ELSE 0 END) AS brązowy,
                        SUM(CASE WHEN kolor=&#39;czarny&#39; THEN ilość ELSE 0 END) AS czarny,
                        SUM(CASE WHEN kolor=&#39;granatowy&#39; THEN ilość ELSE 0 END) AS granatowy,
                        SUM(CASE WHEN kolor=&#39;niebieski&#39; THEN ilość ELSE 0 END) AS niebieski,
                        SUM(CASE WHEN kolor=&#39;popiel&#39; THEN ilość ELSE 0 END) AS popielaty,
                        SUM(CASE WHEN kolor=&#39;zielony&#39; THEN ilość ELSE 0 END) AS zielony
                    FROM v_zakupy
                    GROUP BY kategoria;
            
            
            
            
                    <table class="dataframe styled-table">
                      <thead>
                        <tr>
                          <th></th>
                          <th>kategoria</th>
                          <th>biały</th>
                          <th>bordowy</th>
                          <th>brązowy</th>
                          <th>czarny</th>
                          <th>granatowy</th>
                          <th>niebieski</th>
                          <th>popielaty</th>
                          <th>zielony</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <th>0</th>
                          <td>odzież męska</td>
                          <td>3686.0</td>
                          <td>3752.0</td>
                          <td>0.0</td>
                          <td>3388.0</td>
                          <td>2842.0</td>
                          <td>0.0</td>
                          <td>0.0</td>
                          <td>3476.0</td>
                        </tr>
                        <tr>
                          <th>1</th>
                          <td>buty</td>
                          <td>478.0</td>
                          <td>0.0</td>
                          <td>2569.0</td>
                          <td>2688.0</td>
                          <td>3003.0</td>
                          <td>0.0</td>
                          <td>0.0</td>
                          <td>0.0</td>
                        </tr>
                        <tr>
                          <th>2</th>
                          <td>bielizna</td>
                          <td>1742.0</td>
                          <td>0.0</td>
                          <td>1745.0</td>
                          <td>1900.0</td>
                          <td>1885.0</td>
                          <td>0.0</td>
                          <td>0.0</td>
                          <td>0.0</td>
                        </tr>
                        <tr>
                          <th>3</th>
                          <td>galanteria skórzana</td>
                          <td>0.0</td>
                          <td>0.0</td>
                          <td>627.0</td>
                          <td>945.0</td>
                          <td>728.0</td>
                          <td>0.0</td>
                          <td>0.0</td>
                          <td>0.0</td>
                        </tr>
                        <tr>
                          <th>4</th>
                          <td>spodnie</td>
                          <td>0.0</td>
                          <td>0.0</td>
                          <td>844.0</td>
                          <td>951.0</td>
                          <td>779.0</td>
                          <td>898.0</td>
                          <td>796.0</td>
                          <td>0.0</td>
                        </tr>
                      </tbody>
                    </table>

            
                    -------------------------------------------------------
                    podkategorie wg koloru - wartości - tabela przestawna:
                    -------------------------------------------------------
            
                    SELECT 
                        podkategoria,
                        SUM(CASE WHEN kolor=&#39;biały&#39; THEN ilość * cena_zakupu ELSE 0 END) AS biały,
                        SUM(CASE WHEN kolor=&#39;bordowy&#39; THEN ilość * cena_zakupu ELSE 0 END) AS bordowy,
                        SUM(CASE WHEN kolor=&#39;brązowy&#39; THEN ilość * cena_zakupu ELSE 0 END) AS brązowy,
                        SUM(CASE WHEN kolor=&#39;czarny&#39; THEN ilość * cena_zakupu ELSE 0 END) AS czarny,
                        SUM(CASE WHEN kolor=&#39;granatowy&#39; THEN ilość * cena_zakupu ELSE 0 END) AS granatowy,
                        SUM(CASE WHEN kolor=&#39;niebieski&#39; THEN ilość * cena_zakupu ELSE 0 END) AS niebieski,
                        SUM(CASE WHEN kolor=&#39;popiel&#39; THEN ilość * cena_zakupu ELSE 0 END) AS popielaty,
                        SUM(CASE WHEN kolor=&#39;zielony&#39; THEN ilość * cena_zakupu ELSE 0 END) AS zielony
                    FROM v_zakupy
                    GROUP BY podkategoria;
            

            
            
                    <table class="dataframe styled-table">
                      <thead>
                        <tr>
                          <th></th>
                          <th>podkategoria</th>
                          <th>biały</th>
                          <th>bordowy</th>
                          <th>brązowy</th>
                          <th>czarny</th>
                          <th>granatowy</th>
                          <th>niebieski</th>
                          <th>popielaty</th>
                          <th>zielony</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <th>0</th>
                          <td>koszula</td>
                          <td>127388.21</td>
                          <td>147123.43</td>
                          <td>0.00</td>
                          <td>131078.99</td>
                          <td>109567.00</td>
                          <td>0.00</td>
                          <td>0.00</td>
                          <td>138714.21</td>
                        </tr>
                        <tr>
                          <th>1</th>
                          <td>T-shirt</td>
                          <td>54663.10</td>
                          <td>44854.86</td>
                          <td>0.00</td>
                          <td>42046.85</td>
                          <td>35735.40</td>
                          <td>0.00</td>
                          <td>0.00</td>
                          <td>39974.53</td>
                        </tr>
                        <tr>
                          <th>2</th>
                          <td>buty wizytowe</td>
                          <td>0.00</td>
                          <td>0.00</td>
                          <td>136448.24</td>
                          <td>135074.60</td>
                          <td>157739.66</td>
                          <td>0.00</td>
                          <td>0.00</td>
                          <td>0.00</td>
                        </tr>
                        <tr>
                          <th>3</th>
                          <td>trzewiki</td>
                          <td>0.00</td>
                          <td>0.00</td>
                          <td>96956.24</td>
                          <td>133390.43</td>
                          <td>120234.28</td>
                          <td>0.00</td>
                          <td>0.00</td>
                          <td>0.00</td>
                        </tr>
                        <tr>
                          <th>4</th>
                          <td>półbuty</td>
                          <td>0.00</td>
                          <td>0.00</td>
                          <td>132336.75</td>
                          <td>70219.50</td>
                          <td>105149.20</td>
                          <td>0.00</td>
                          <td>0.00</td>
                          <td>0.00</td>
                        </tr>
                        <tr>
                          <th>5</th>
                          <td>buty sportowe</td>
                          <td>127296.18</td>
                          <td>0.00</td>
                          <td>56990.34</td>
                          <td>158676.39</td>
                          <td>169373.16</td>
                          <td>0.00</td>
                          <td>0.00</td>
                          <td>0.00</td>
                        </tr>
                        <tr>
                          <th>6</th>
                          <td>botki</td>
                          <td>0.00</td>
                          <td>0.00</td>
                          <td>94494.60</td>
                          <td>71451.18</td>
                          <td>88029.18</td>
                          <td>0.00</td>
                          <td>0.00</td>
                          <td>0.00</td>
                        </tr>
                        <tr>
                          <th>7</th>
                          <td>slipy</td>
                          <td>14690.49</td>
                          <td>0.00</td>
                          <td>11945.77</td>
                          <td>10822.93</td>
                          <td>10885.31</td>
                          <td>0.00</td>
                          <td>0.00</td>
                          <td>0.00</td>
                        </tr>
                        <tr>
                          <th>8</th>
                          <td>bokserki</td>
                          <td>11044.94</td>
                          <td>0.00</td>
                          <td>11286.80</td>
                          <td>15358.11</td>
                          <td>17051.13</td>
                          <td>0.00</td>
                          <td>0.00</td>
                          <td>0.00</td>
                        </tr>
                        <tr>
                          <th>9</th>
                          <td>kąpielówki</td>
                          <td>9187.64</td>
                          <td>0.00</td>
                          <td>9371.04</td>
                          <td>12160.04</td>
                          <td>10626.09</td>
                          <td>0.00</td>
                          <td>0.00</td>
                          <td>0.00</td>
                        </tr>
                        <tr>
                          <th>10</th>
                          <td>podkoszulki</td>
                          <td>14754.21</td>
                          <td>0.00</td>
                          <td>17294.67</td>
                          <td>14623.93</td>
                          <td>12050.90</td>
                          <td>0.00</td>
                          <td>0.00</td>
                          <td>0.00</td>
                        </tr>
                        <tr>
                          <th>11</th>
                          <td>skarpetki</td>
                          <td>4979.52</td>
                          <td>0.00</td>
                          <td>4695.60</td>
                          <td>6268.08</td>
                          <td>7906.08</td>
                          <td>0.00</td>
                          <td>0.00</td>
                          <td>0.00</td>
                        </tr>
                        <tr>
                          <th>12</th>
                          <td>torby</td>
                          <td>0.00</td>
                          <td>0.00</td>
                          <td>24548.06</td>
                          <td>40044.88</td>
                          <td>36479.24</td>
                          <td>0.00</td>
                          <td>0.00</td>
                          <td>0.00</td>
                        </tr>
                        <tr>
                          <th>13</th>
                          <td>paski</td>
                          <td>0.00</td>
                          <td>0.00</td>
                          <td>23990.31</td>
                          <td>37808.47</td>
                          <td>25888.14</td>
                          <td>0.00</td>
                          <td>0.00</td>
                          <td>0.00</td>
                        </tr>
                        <tr>
                          <th>14</th>
                          <td>spodnie jeans</td>
                          <td>0.00</td>
                          <td>0.00</td>
                          <td>36679.86</td>
                          <td>51370.76</td>
                          <td>33078.22</td>
                          <td>45304.84</td>
                          <td>35068.60</td>
                          <td>0.00</td>
                        </tr>
                        <tr>
                          <th>15</th>
                          <td>spodnie klasyczne</td>
                          <td>0.00</td>
                          <td>0.00</td>
                          <td>39480.23</td>
                          <td>35333.51</td>
                          <td>37147.70</td>
                          <td>36283.80</td>
                          <td>36802.14</td>
                          <td>0.00</td>
                        </tr>
                      </tbody>
                    </table>
     
            
            
                    -------------------------------------------------------
                    kategorie wg koloru i rozmiaru - ilosci - tabela przestawna:
                    -------------------------------------------------------
            
                    SELECT 
                        kategoria, podkategoria, rozmiar,
                        SUM(CASE WHEN kolor=&#39;biały&#39; THEN ilość ELSE 0 END) AS biały,
                        SUM(CASE WHEN kolor=&#39;bordowy&#39; THEN ilość ELSE 0 END) AS bordowy,
                        SUM(CASE WHEN kolor=&#39;brązowy&#39; THEN ilość ELSE 0 END) AS brązowy,
                        SUM(CASE WHEN kolor=&#39;czarny&#39; THEN ilość ELSE 0 END) AS czarny,
                        SUM(CASE WHEN kolor=&#39;granatowy&#39; THEN ilość ELSE 0 END) AS granatowy,
                        SUM(CASE WHEN kolor=&#39;niebieski&#39; THEN ilość ELSE 0 END) AS niebieski,
                        SUM(CASE WHEN kolor=&#39;popiel&#39; THEN ilość ELSE 0 END) AS popielaty,
                        SUM(CASE WHEN kolor=&#39;zielony&#39; THEN ilość ELSE 0 END) AS zielony
                    FROM v_zakupy
                    WHERE kategoria = &#39;spodnie&#39;
                    GROUP BY kategoria, podkategoria, rozmiar;
            

            
            
            
                    <table class="dataframe styled-table">
                      <thead>
                        <tr>
                          <th></th>
                          <th>kategoria</th>
                          <th>podkategoria</th>
                          <th>rozmiar</th>
                          <th>biały</th>
                          <th>bordowy</th>
                          <th>brązowy</th>
                          <th>czarny</th>
                          <th>granatowy</th>
                          <th>niebieski</th>
                          <th>popielaty</th>
                          <th>zielony</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <th>0</th>
                          <td>spodnie</td>
                          <td>spodnie jeans</td>
                          <td>S</td>
                          <td>0.0</td>
                          <td>0.0</td>
                          <td>77.0</td>
                          <td>138.0</td>
                          <td>54.0</td>
                          <td>111.0</td>
                          <td>73.0</td>
                          <td>0.0</td>
                        </tr>
                        <tr>
                          <th>1</th>
                          <td>spodnie</td>
                          <td>spodnie jeans</td>
                          <td>M</td>
                          <td>0.0</td>
                          <td>0.0</td>
                          <td>101.0</td>
                          <td>142.0</td>
                          <td>90.0</td>
                          <td>142.0</td>
                          <td>21.0</td>
                          <td>0.0</td>
                        </tr>
                        <tr>
                          <th>2</th>
                          <td>spodnie</td>
                          <td>spodnie jeans</td>
                          <td>L</td>
                          <td>0.0</td>
                          <td>0.0</td>
                          <td>127.0</td>
                          <td>72.0</td>
                          <td>25.0</td>
                          <td>76.0</td>
                          <td>43.0</td>
                          <td>0.0</td>
                        </tr>
                        <tr>
                          <th>3</th>
                          <td>spodnie</td>
                          <td>spodnie jeans</td>
                          <td>XL</td>
                          <td>0.0</td>
                          <td>0.0</td>
                          <td>45.0</td>
                          <td>70.0</td>
                          <td>51.0</td>
                          <td>95.0</td>
                          <td>137.0</td>
                          <td>0.0</td>
                        </tr>
                        <tr>
                          <th>4</th>
                          <td>spodnie</td>
                          <td>spodnie jeans</td>
                          <td>XXL</td>
                          <td>0.0</td>
                          <td>0.0</td>
                          <td>37.0</td>
                          <td>120.0</td>
                          <td>129.0</td>
                          <td>54.0</td>
                          <td>96.0</td>
                          <td>0.0</td>
                        </tr>
                        <tr>
                          <th>5</th>
                          <td>spodnie</td>
                          <td>spodnie klasyczne</td>
                          <td>S</td>
                          <td>0.0</td>
                          <td>0.0</td>
                          <td>120.0</td>
                          <td>125.0</td>
                          <td>29.0</td>
                          <td>95.0</td>
                          <td>120.0</td>
                          <td>0.0</td>
                        </tr>
                        <tr>
                          <th>6</th>
                          <td>spodnie</td>
                          <td>spodnie klasyczne</td>
                          <td>M</td>
                          <td>0.0</td>
                          <td>0.0</td>
                          <td>95.0</td>
                          <td>63.0</td>
                          <td>107.0</td>
                          <td>109.0</td>
                          <td>86.0</td>
                          <td>0.0</td>
                        </tr>
                        <tr>
                          <th>7</th>
                          <td>spodnie</td>
                          <td>spodnie klasyczne</td>
                          <td>L</td>
                          <td>0.0</td>
                          <td>0.0</td>
                          <td>99.0</td>
                          <td>79.0</td>
                          <td>25.0</td>
                          <td>69.0</td>
                          <td>125.0</td>
                          <td>0.0</td>
                        </tr>
                        <tr>
                          <th>8</th>
                          <td>spodnie</td>
                          <td>spodnie klasyczne</td>
                          <td>XL</td>
                          <td>0.0</td>
                          <td>0.0</td>
                          <td>93.0</td>
                          <td>71.0</td>
                          <td>142.0</td>
                          <td>77.0</td>
                          <td>23.0</td>
                          <td>0.0</td>
                        </tr>
                        <tr>
                          <th>9</th>
                          <td>spodnie</td>
                          <td>spodnie klasyczne</td>
                          <td>XXL</td>
                          <td>0.0</td>
                          <td>0.0</td>
                          <td>50.0</td>
                          <td>71.0</td>
                          <td>127.0</td>
                          <td>70.0</td>
                          <td>72.0</td>
                          <td>0.0</td>
                        </tr>
                      </tbody>
                    </table>
           
            
                    -------------------------------------------------------
                    sumy częsciowe wg kategorii i podkategorii - ilosci i wartości:
                    -------------------------------------------------------
            
                    SELECT 
                        IF(GROUPING(kategoria) = 1, &#39;RAZEM KATEGORIE&#39;, kategoria) AS Kategoria, 
                        IF(GROUPING(podkategoria) = 1, &#39;suma podkategorii&#39;, podkategoria) AS podkategoria, 
                        SUM(ilość) AS ILOŚĆ,
                        SUM(ilość * cena_zakupu) AS WARTOŚĆ
                    FROM v_zakupy
                    GROUP BY kategoria, podkategoria
                    WITH ROLLUP;
            
                    
          
            
            
                    <table class="dataframe styled-table">
                      <thead>
                        <tr>
                          <th></th>
                          <th>Kategoria</th>
                          <th>podkategoria</th>
                          <th>ILOŚĆ</th>
                          <th>WARTOŚĆ</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <th>0</th>
                          <td>bielizna</td>
                          <td>bokserki</td>
                          <td>1358.0</td>
                          <td>54740.98</td>
                        </tr>
                        <tr>
                          <th>1</th>
                          <td>bielizna</td>
                          <td>kąpielówki</td>
                          <td>1469.0</td>
                          <td>41344.81</td>
                        </tr>
                        <tr>
                          <th>2</th>
                          <td>bielizna</td>
                          <td>podkoszulki</td>
                          <td>1803.0</td>
                          <td>58723.71</td>
                        </tr>
                        <tr>
                          <th>3</th>
                          <td>bielizna</td>
                          <td>skarpetki</td>
                          <td>1092.0</td>
                          <td>23849.28</td>
                        </tr>
                        <tr>
                          <th>4</th>
                          <td>bielizna</td>
                          <td>slipy</td>
                          <td>1550.0</td>
                          <td>48344.50</td>
                        </tr>
                        <tr>
                          <th>5</th>
                          <td>bielizna</td>
                          <td>suma podkategorii</td>
                          <td>7272.0</td>
                          <td>227003.28</td>
                        </tr>
                        <tr>
                          <th>6</th>
                          <td>buty</td>
                          <td>botki</td>
                          <td>1532.0</td>
                          <td>253974.96</td>
                        </tr>
                        <tr>
                          <th>7</th>
                          <td>buty</td>
                          <td>buty sportowe</td>
                          <td>1968.0</td>
                          <td>512336.07</td>
                        </tr>
                        <tr>
                          <th>8</th>
                          <td>buty</td>
                          <td>buty wizytowe</td>
                          <td>1875.0</td>
                          <td>429262.50</td>
                        </tr>
                        <tr>
                          <th>9</th>
                          <td>buty</td>
                          <td>półbuty</td>
                          <td>1709.0</td>
                          <td>307705.45</td>
                        </tr>
                        <tr>
                          <th>10</th>
                          <td>buty</td>
                          <td>trzewiki</td>
                          <td>1654.0</td>
                          <td>350580.95</td>
                        </tr>
                        <tr>
                          <th>11</th>
                          <td>buty</td>
                          <td>suma podkategorii</td>
                          <td>8738.0</td>
                          <td>1853859.93</td>
                        </tr>
                        <tr>
                          <th>12</th>
                          <td>galanteria skórzana</td>
                          <td>paski</td>
                          <td>1563.0</td>
                          <td>87686.92</td>
                        </tr>
                        <tr>
                          <th>13</th>
                          <td>galanteria skórzana</td>
                          <td>torby</td>
                          <td>737.0</td>
                          <td>101072.18</td>
                        </tr>
                        <tr>
                          <th>14</th>
                          <td>galanteria skórzana</td>
                          <td>suma podkategorii</td>
                          <td>2300.0</td>
                          <td>188759.10</td>
                        </tr>
                        <tr>
                          <th>15</th>
                          <td>odzież męska</td>
                          <td>koszula</td>
                          <td>11245.0</td>
                          <td>653871.84</td>
                        </tr>
                        <tr>
                          <th>16</th>
                          <td>odzież męska</td>
                          <td>T-shirt</td>
                          <td>5899.0</td>
                          <td>217274.74</td>
                        </tr>
                        <tr>
                          <th>17</th>
                          <td>odzież męska</td>
                          <td>suma podkategorii</td>
                          <td>17144.0</td>
                          <td>871146.58</td>
                        </tr>
                        <tr>
                          <th>18</th>
                          <td>spodnie</td>
                          <td>spodnie jeans</td>
                          <td>2126.0</td>
                          <td>201502.28</td>
                        </tr>
                        <tr>
                          <th>19</th>
                          <td>spodnie</td>
                          <td>spodnie klasyczne</td>
                          <td>2142.0</td>
                          <td>185047.38</td>
                        </tr>
                        <tr>
                          <th>20</th>
                          <td>spodnie</td>
                          <td>suma podkategorii</td>
                          <td>4268.0</td>
                          <td>386549.66</td>
                        </tr>
                        <tr>
                          <th>21</th>
                          <td>RAZEM KATEGORIE</td>
                          <td>suma podkategorii</td>
                          <td>39722.0</td>
                          <td>3527318.55</td>
                        </tr>
                      </tbody>
                    </table>

            
            
                    -------------------------------------------------------
                    sumy częsciowe wg kategorii - ilości i wartości:
                    -------------------------------------------------------
            
                    SELECT 
                        IF(GROUPING(kategoria) = 1, &#39;RAZEM KATEGORIE&#39;, kategoria) AS Kategoria, 
                        SUM(ilość) AS ILOŚĆ,
                        SUM(ilość * cena_zakupu) AS WARTOŚĆ
                    FROM v_zakupy
                    GROUP BY kategoria
                    WITH ROLLUP;
            

        
            
                    <table class="dataframe styled-table">
                      <thead>
                        <tr>
                          <th></th>
                          <th>Kategoria</th>
                          <th>ILOŚĆ</th>
                          <th>WARTOŚĆ</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <th>0</th>
                          <td>bielizna</td>
                          <td>7272.0</td>
                          <td>227003.28</td>
                        </tr>
                        <tr>
                          <th>1</th>
                          <td>buty</td>
                          <td>8738.0</td>
                          <td>1853859.93</td>
                        </tr>
                        <tr>
                          <th>2</th>
                          <td>galanteria skórzana</td>
                          <td>2300.0</td>
                          <td>188759.10</td>
                        </tr>
                        <tr>
                          <th>3</th>
                          <td>odzież męska</td>
                          <td>17144.0</td>
                          <td>871146.58</td>
                        </tr>
                        <tr>
                          <th>4</th>
                          <td>spodnie</td>
                          <td>4268.0</td>
                          <td>386549.66</td>
                        </tr>
                        <tr>
                          <th>5</th>
                          <td>RAZEM KATEGORIE</td>
                          <td>39722.0</td>
                          <td>3527318.55</td>
                        </tr>
                      </tbody>
                    </table>



                
                </pre>
                <h3>
                    Analiza zamówień
                </h3>

                <pre class = "kod">
                

                -------------------------------------------------------
                liczba zamówień:
                -------------------------------------------------------

                SELECT distinct  count(id_zamówienie) as liczba_zamowień
                FROM zamówienia;
                    


                <table class="dataframe styled-table">
                  <thead>
                    <tr>
                      <th></th>
                      <th>liczba_zamowień</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <th>0</th>
                      <td>823</td>
                    </tr>
                  </tbody>
                </table>




                -------------------------------------------------------
                liczba zamóweień wg kwartałów:
                -------------------------------------------------------

                SELECT DISTINCT 
                    QUARTER(data_zamówienia) AS kwartał,
                    COUNT(id_zamówienie) OVER(PARTITION BY QUARTER(data_zamówienia)) AS liczba_zamowień
                FROM zamówienia;



                <table class="dataframe styled-table">
                  <thead>
                    <tr>
                      <th></th>
                      <th>kwartał</th>
                      <th>liczba_zamowień</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <th>0</th>
                      <td>1</td>
                      <td>230</td>
                    </tr>
                    <tr>
                      <th>1</th>
                      <td>2</td>
                      <td>196</td>
                    </tr>
                    <tr>
                      <th>2</th>
                      <td>3</td>
                      <td>227</td>
                    </tr>
                    <tr>
                      <th>3</th>
                      <td>4</td>
                      <td>170</td>
                    </tr>
                  </tbody>
                </table>


                -------------------------------------------------------
                zamówienia wg formy dostawy:
                -------------------------------------------------------

                SELECT DISTINCT 
                    forma_dostawy,
                    COUNT(id_zamówienie) OVER (PARTITION BY forma_dostawy) AS liczba_zamówień
                FROM v_zamówienia
                ORDER BY liczba_zamówień DESC;

                <table class="dataframe styled-table">
                  <thead>
                    <tr>
                      <th></th>
                      <th>forma_dostawy</th>
                      <th>liczba_zamówień</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <th>0</th>
                      <td>paczkomat</td>
                      <td>662</td>
                    </tr>
                    <tr>
                      <th>1</th>
                      <td>kurier</td>
                      <td>61</td>
                    </tr>
                    <tr>
                      <th>2</th>
                      <td>odbiór osobisty</td>
                      <td>54</td>
                    </tr>
                    <tr>
                      <th>3</th>
                      <td>poczta</td>
                      <td>46</td>
                    </tr>
                  </tbody>
                </table>



                -------------------------------------------------------
                zamówienia wg kanału sprzedazy:
                -------------------------------------------------------

                SELECT DISTINCT 
                    kanał_sprzedaz,
                    COUNT(id_zamówienie) OVER (PARTITION BY kanał_sprzedaz) AS liczba_zamówień
                FROM v_zamówienia
                ORDER BY liczba_zamówień DESC;



                <table class="dataframe styled-table">
                  <thead>
                    <tr>
                      <th></th>
                      <th>kanał_sprzedaz</th>
                      <th>liczba_zamówień</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <th>0</th>
                      <td>portal aukcyjny</td>
                      <td>426</td>
                    </tr>
                    <tr>
                      <th>1</th>
                      <td>sklep on-line</td>
                      <td>397</td>
                    </tr>
                  </tbody>
                </table>



                -------------------------------------------------------
                zamówienia wg płatności:
                -------------------------------------------------------

                SELECT DISTINCT 
                    forma_płatności,
                    COUNT(id_zamówienie) OVER (PARTITION BY forma_płatności) AS liczba_zamówień
                FROM v_zamówienia
                ORDER BY liczba_zamówień DESC;




                <table class="dataframe styled-table">
                  <thead>
                    <tr>
                      <th></th>
                      <th>forma_płatności</th>
                      <th>liczba_zamówień</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <th>0</th>
                      <td>karta</td>
                      <td>219</td>
                    </tr>
                    <tr>
                      <th>1</th>
                      <td>e-przelew</td>
                      <td>213</td>
                    </tr>
                    <tr>
                      <th>2</th>
                      <td>gotówka</td>
                      <td>206</td>
                    </tr>
                    <tr>
                      <th>3</th>
                      <td>przelew</td>
                      <td>185</td>
                    </tr>
                  </tbody>
                </table>





                -------------------------------------------------------
                zamówienia wg  miasta dostawy:
                -------------------------------------------------------

                SELECT DISTINCT 
                    miasto_dostawy,
                    COUNT(id_zamówienie) OVER (PARTITION BY miasto_dostawy) AS liczba_zamówień
                FROM v_zamówienia
                ORDER BY liczba_zamówień DESC;

                


                <table class="dataframe styled-table">
                  <thead>
                    <tr>
                      <th></th>
                      <th>miasto_dostawy</th>
                      <th>liczba_zamówień</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <th>0</th>
                      <td>Wrocław</td>
                      <td>108</td>
                    </tr>
                    <tr>
                      <th>1</th>
                      <td>Warszawa</td>
                      <td>79</td>
                    </tr>
                    <tr>
                      <th>2</th>
                      <td>Gdańsk</td>
                      <td>71</td>
                    </tr>
                    <tr>
                      <th>3</th>
                      <td>Kraków</td>
                      <td>68</td>
                    </tr>
                    <tr>
                      <th>4</th>
                      <td>Łódź</td>
                      <td>64</td>
                    </tr>
                    <tr>
                      <th>5</th>
                      <td>Poznań</td>
                      <td>59</td>
                    </tr>
                    <tr>
                      <th>6</th>
                      <td>Bydgoszcz</td>
                      <td>56</td>
                    </tr>
                    <tr>
                      <th>7</th>
                      <td>Rzeszów</td>
                      <td>50</td>
                    </tr>
                    <tr>
                      <th>8</th>
                      <td>Białystok</td>
                      <td>48</td>
                    </tr>
                    <tr>
                      <th>9</th>
                      <td>Kielce</td>
                      <td>48</td>
                    </tr>
                    <tr>
                      <th>10</th>
                      <td>Gorzów Wielkopolski</td>
                      <td>46</td>
                    </tr>
                    <tr>
                      <th>11</th>
                      <td>Szczecin</td>
                      <td>32</td>
                    </tr>
                    <tr>
                      <th>12</th>
                      <td>Opole</td>
                      <td>28</td>
                    </tr>
                    <tr>
                      <th>13</th>
                      <td>Katowice</td>
                      <td>27</td>
                    </tr>
                    <tr>
                      <th>14</th>
                      <td>Lublin</td>
                      <td>25</td>
                    </tr>
                    <tr>
                      <th>15</th>
                      <td>Olsztyn</td>
                      <td>14</td>
                    </tr>
                  </tbody>
                </table>



                -------------------------------------------------------
                czas oczekiwania na realizację zamówienia (wysyłka) i dostarczenia towaru:
                -------------------------------------------------------

                SELECT 
                    id_zamówienie,
                    DATEDIFF(data_wysyłki, data_zamówienia) AS liczba_dni_oczekiwania_na_wysyłkę_od_zamówienia,
                    DATEDIFF(data_odbioru, data_zamówienia) AS liczba_dni_oczekiwania_na_odbiór_od_zamówienia,
                    DATEDIFF(data_odbioru, data_wysyłki) AS liczba_dni_oczekiwania_na_odbiór_od_wysyłki
                FROM v_zamówienia;



                <table class="dataframe styled-table">
                  <thead>
                    <tr>
                      <th></th>
                      <th>id_zamówienie</th>
                      <th>liczba_dni_oczekiwania_na_wysyłkę_od_zamówienia</th>
                      <th>liczba_dni_oczekiwania_na_odbiór_od_zamówienia</th>
                      <th>liczba_dni_oczekiwania_na_odbiór_od_wysyłki</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <th>0</th>
                      <td>1</td>
                      <td>12</td>
                      <td>14</td>
                      <td>2</td>
                    </tr>
                    <tr>
                      <th>1</th>
                      <td>2</td>
                      <td>12</td>
                      <td>17</td>
                      <td>5</td>
                    </tr>
                    <tr>
                      <th>2</th>
                      <td>3</td>
                      <td>4</td>
                      <td>6</td>
                      <td>2</td>
                    </tr>
                    <tr>
                      <th>3</th>
                      <td>4</td>
                      <td>2</td>
                      <td>4</td>
                      <td>2</td>
                    </tr>
                    <tr>
                      <th>4</th>
                      <td>5</td>
                      <td>11</td>
                      <td>15</td>
                      <td>4</td>
                    </tr>
                    <tr>
                      <th>...</th>
                      <td>...</td>
                      <td>...</td>
                      <td>...</td>
                      <td>...</td>
                    </tr>
                    <tr>
                      <th>818</th>
                      <td>819</td>
                      <td>4</td>
                      <td>8</td>
                      <td>4</td>
                    </tr>
                    <tr>
                      <th>819</th>
                      <td>820</td>
                      <td>11</td>
                      <td>13</td>
                      <td>2</td>
                    </tr>
                    <tr>
                      <th>820</th>
                      <td>821</td>
                      <td>7</td>
                      <td>11</td>
                      <td>4</td>
                    </tr>
                    <tr>
                      <th>821</th>
                      <td>822</td>
                      <td>7</td>
                      <td>9</td>
                      <td>2</td>
                    </tr>
                    <tr>
                      <th>822</th>
                      <td>823</td>
                      <td>13</td>
                      <td>15</td>
                      <td>2</td>
                    </tr>
                  </tbody>
                </table>


                -------------------------------------------------------
                max, min średnia liczba_dni_oczekiwania_na_wysyłkę_od_zamówienia:
                -------------------------------------------------------

                WITH cte1 AS (
                    SELECT DISTINCT
                        DATEDIFF(data_wysyłki, data_zamówienia) AS liczba_dni_oczekiwania_na_wysyłkę_od_zamówienia
                    FROM v_zamówienia
                )
                SELECT 
                    MAX(liczba_dni_oczekiwania_na_wysyłkę_od_zamówienia) AS max_liczba_dni_oczekiwania_na_wysyłkę_od_zamówienia,
                    MIN(liczba_dni_oczekiwania_na_wysyłkę_od_zamówienia) AS min_liczba_dni_oczekiwania_na_wysyłkę_od_zamówienia,
                    ROUND(AVG(liczba_dni_oczekiwania_na_wysyłkę_od_zamówienia), 1) AS średnia_liczba_dni_oczekiwania_na_wysyłkę_od_zamówienia
                FROM cte1;




                <table class="dataframe styled-table">
                  <thead>
                    <tr>
                      <th></th>
                      <th>max_liczba_dni_oczekiwania_na_wysyłkę_od_zamówienia</th>
                      <th>min_liczba_dni_oczekiwania_na_wysyłkę_od_zamówienia</th>
                      <th>średnia_liczba_dni_oczekiwania_na_wysyłkę_od_zamówienia</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <th>0</th>
                      <td>14</td>
                      <td>1</td>
                      <td>7.5</td>
                    </tr>
                  </tbody>
                </table>




                -------------------------------------------------------
                max, min średnia liczba_dni_oczekiwania_na_odtrzymanie_od_zamówienia:
                -------------------------------------------------------

                WITH cte1 AS (
                    SELECT DISTINCT
                        DATEDIFF(data_odbioru, data_zamówienia) AS liczba_dni_oczekiwania_na_odbiór_od_zamówienia
                    FROM v_zamówienia
                )
                SELECT 
                    MAX(liczba_dni_oczekiwania_na_odbiór_od_zamówienia) AS max_liczba_dni_oczekiwania_na_odbiór_od_zamówienia,
                    MIN(liczba_dni_oczekiwania_na_odbiór_od_zamówienia) AS min_liczba_dni_oczekiwania_na_odbiór_od_zamówienia,
                    ROUND(AVG(liczba_dni_oczekiwania_na_odbiór_od_zamówienia), 1) AS średnia_liczba_dni_oczekiwania_na_odbiór_od_zamówienia
                FROM cte1;




                <table class="dataframe styled-table">
                  <thead>
                    <tr>
                      <th></th>
                      <th>max_liczba_dni_oczekiwania_na_odbiór_od_zamówienia</th>
                      <th>min_liczba_dni_oczekiwania_na_odbiór_od_zamówienia</th>
                      <th>średnia_liczba_dni_oczekiwania_na_odbiór_od_zamówienia</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <th>0</th>
                      <td>19</td>
                      <td>3</td>
                      <td>11.0</td>
                    </tr>
                  </tbody>
                </table>




                -------------------------------------------------------
                wartosć sprzedaży narastająco:
                -------------------------------------------------------

                SELECT DISTINCT
                    MONTH(data_wysyłki) AS m_c,
                    SUM(ilość * cena_sprzedaży) AS suma,
                    SUM(SUM(ilość * cena_sprzedaży)) OVER (ORDER BY MONTH(data_wysyłki) ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS sprzedaż_skumulowana
                FROM v_sprzedaż_zamówienia
                GROUP BY MONTH(data_wysyłki)
                ORDER BY MONTH(data_wysyłki);



                <table class="dataframe styled-table">
                  <thead>
                    <tr>
                      <th></th>
                      <th>m_c</th>
                      <th>suma</th>
                      <th>sprzedaż_skumulowana</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <th>0</th>
                      <td>1</td>
                      <td>39425.0</td>
                      <td>39425.0</td>
                    </tr>
                    <tr>
                      <th>1</th>
                      <td>2</td>
                      <td>39098.0</td>
                      <td>78523.0</td>
                    </tr>
                    <tr>
                      <th>2</th>
                      <td>3</td>
                      <td>38105.0</td>
                      <td>116628.0</td>
                    </tr>
                    <tr>
                      <th>3</th>
                      <td>4</td>
                      <td>44731.0</td>
                      <td>161359.0</td>
                    </tr>
                    <tr>
                      <th>4</th>
                      <td>5</td>
                      <td>46374.0</td>
                      <td>207733.0</td>
                    </tr>
                    <tr>
                      <th>5</th>
                      <td>6</td>
                      <td>34844.0</td>
                      <td>242577.0</td>
                    </tr>
                    <tr>
                      <th>6</th>
                      <td>7</td>
                      <td>41032.0</td>
                      <td>283609.0</td>
                    </tr>
                    <tr>
                      <th>7</th>
                      <td>8</td>
                      <td>45673.0</td>
                      <td>329282.0</td>
                    </tr>
                    <tr>
                      <th>8</th>
                      <td>9</td>
                      <td>53790.0</td>
                      <td>383072.0</td>
                    </tr>
                    <tr>
                      <th>9</th>
                      <td>10</td>
                      <td>37802.0</td>
                      <td>420874.0</td>
                    </tr>
                    <tr>
                      <th>10</th>
                      <td>11</td>
                      <td>46763.0</td>
                      <td>467637.0</td>
                    </tr>
                    <tr>
                      <th>11</th>
                      <td>12</td>
                      <td>27244.0</td>
                      <td>494881.0</td>
                    </tr>
                  </tbody>
                </table>



                -------------------------------------------------------
                zmiany wartości sprzedaży w czasie :
                -------------------------------------------------------

                SELECT DISTINCT
                    MONTH(data_wysyłki) AS m_c,
                    SUM(ilość * cena_sprzedaży) AS suma,
                    LAG(SUM(ilość * cena_sprzedaży)) OVER (ORDER BY MONTH(data_wysyłki)) AS suma_poprzednia,
                    ROUND((SUM(ilość * cena_sprzedaży) / LAG(SUM(ilość * cena_sprzedaży)) OVER (ORDER BY MONTH(data_wysyłki)) - 1) * 100, 2) AS procent_zmiany,
                    CASE 
                        WHEN ROUND((SUM(ilość * cena_sprzedaży) / LAG(SUM(ilość * cena_sprzedaży)) OVER (ORDER BY MONTH(data_wysyłki)) - 1) * 100, 2) &gt; 0 THEN &#39;wzrost&#39;
                        WHEN ROUND((SUM(ilość * cena_sprzedaży) / LAG(SUM(ilość * cena_sprzedaży)) OVER (ORDER BY MONTH(data_wysyłki)) - 1) * 100, 2) &lt; 0 THEN &#39;spadek&#39;
                        WHEN ROUND((SUM(ilość * cena_sprzedaży) / LAG(SUM(ilość * cena_sprzedaży)) OVER (ORDER BY MONTH(data_wysyłki)) - 1) * 100, 2) = 0 THEN &#39;b/z&#39;
                        ELSE NULL
                    END AS zmiana
                FROM v_sprzedaż_zamówienia
                GROUP BY MONTH(data_wysyłki)
                ORDER BY MONTH(data_wysyłki);




                <table class="dataframe styled-table">
                  <thead>
                    <tr>
                      <th></th>
                      <th>m_c</th>
                      <th>suma</th>
                      <th>suma_poprzednia</th>
                      <th>procent_zmiany</th>
                      <th>zmiana</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <th>0</th>
                      <td>1</td>
                      <td>39425.0</td>
                      <td>NaN</td>
                      <td>NaN</td>
                      <td>None</td>
                    </tr>
                    <tr>
                      <th>1</th>
                      <td>2</td>
                      <td>39098.0</td>
                      <td>39425.0</td>
                      <td>-0.83</td>
                      <td>spadek</td>
                    </tr>
                    <tr>
                      <th>2</th>
                      <td>3</td>
                      <td>38105.0</td>
                      <td>39098.0</td>
                      <td>-2.54</td>
                      <td>spadek</td>
                    </tr>
                    <tr>
                      <th>3</th>
                      <td>4</td>
                      <td>44731.0</td>
                      <td>38105.0</td>
                      <td>17.39</td>
                      <td>wzrost</td>
                    </tr>
                    <tr>
                      <th>4</th>
                      <td>5</td>
                      <td>46374.0</td>
                      <td>44731.0</td>
                      <td>3.67</td>
                      <td>wzrost</td>
                    </tr>
                    <tr>
                      <th>5</th>
                      <td>6</td>
                      <td>34844.0</td>
                      <td>46374.0</td>
                      <td>-24.86</td>
                      <td>spadek</td>
                    </tr>
                    <tr>
                      <th>6</th>
                      <td>7</td>
                      <td>41032.0</td>
                      <td>34844.0</td>
                      <td>17.76</td>
                      <td>wzrost</td>
                    </tr>
                    <tr>
                      <th>7</th>
                      <td>8</td>
                      <td>45673.0</td>
                      <td>41032.0</td>
                      <td>11.31</td>
                      <td>wzrost</td>
                    </tr>
                    <tr>
                      <th>8</th>
                      <td>9</td>
                      <td>53790.0</td>
                      <td>45673.0</td>
                      <td>17.77</td>
                      <td>wzrost</td>
                    </tr>
                    <tr>
                      <th>9</th>
                      <td>10</td>
                      <td>37802.0</td>
                      <td>53790.0</td>
                      <td>-29.72</td>
                      <td>spadek</td>
                    </tr>
                    <tr>
                      <th>10</th>
                      <td>11</td>
                      <td>46763.0</td>
                      <td>37802.0</td>
                      <td>23.71</td>
                      <td>wzrost</td>
                    </tr>
                    <tr>
                      <th>11</th>
                      <td>12</td>
                      <td>27244.0</td>
                      <td>46763.0</td>
                      <td>-41.74</td>
                      <td>spadek</td>
                    </tr>
                  </tbody>
                </table>

                                
                                </pre>

                            </article> 



                          </section>


                    </div>




    <footer>
        &copy; 2023 Piotr Dłubak
    </footer>
</body>
</html>
